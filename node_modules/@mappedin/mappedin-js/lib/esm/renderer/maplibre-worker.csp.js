(()=>{var e,t,r=Object.create,i=Object.defineProperty,n=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,s=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,l=(e,t)=>i(e,"name",{value:t,configurable:!0}),u=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),c=(e,t)=>{for(var r in t)i(e,r,{get:t[r],enumerable:!0})},h=(e,t,l)=>(l=null!=e?r(s(e)):{},((e,t,r,s)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of a(t))!o.call(e,l)&&l!==r&&i(e,l,{get:()=>t[l],enumerable:!(s=n(t,l))||s.enumerable});return e})(!t&&e&&e.__esModule?l:i(l,"default",{value:e,enumerable:!0}),e)),p=(e=()=>{},()=>(e&&(t=e(e=0)),t)),f=u(((e,t)=>{"use strict";function r(e,t){this.x=e,this.y=t}p(),t.exports=r,l(r,"Point"),r.prototype={clone:function(){return new r(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),i=t*this.x-r*this.y,n=r*this.x+t*this.y;return this.x=i,this.y=n,this},_rotateAround:function(e,t){var r=Math.cos(e),i=Math.sin(e),n=t.x+r*(this.x-t.x)-i*(this.y-t.y),a=t.y+i*(this.x-t.x)+r*(this.y-t.y);return this.x=n,this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},r.convert=function(e){return e instanceof r?e:Array.isArray(e)?new r(e[0],e[1]):e}})),d=u(((e,t)=>{"use strict";function r(e,t,r,i){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(i-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=i}p(),t.exports=r,l(r,"UnitBezier"),r.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,i=0;i<8;i++){var n=this.sampleCurveX(r)-e;if(Math.abs(n)<t)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=n/a}var s=0,o=1;for(r=e,i=0;i<20&&(n=this.sampleCurveX(r),!(Math.abs(n-e)<t));i++)e>n?s=r:o=r,r=.5*(o-s)+s;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}}})),y=u(((e,t)=>{function r(e,t){var r,i,n,a,s,o,l,u;for(r=3&e.length,i=e.length-r,n=t,s=3432918353,o=461845907,u=0;u<i;)l=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<16|(255&e.charCodeAt(++u))<<24,++u,n=27492+(65535&(a=5*(65535&(n=(n^=l=(65535&(l=(l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<13|n>>>19))+((5*(n>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(l=0,r){case 3:l^=(255&e.charCodeAt(u+2))<<16;case 2:l^=(255&e.charCodeAt(u+1))<<8;case 1:n^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(u)))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*o+(((l>>>16)*o&65535)<<16)&4294967295}return n^=e.length,n=2246822507*(65535&(n^=n>>>16))+((2246822507*(n>>>16)&65535)<<16)&4294967295,n=3266489909*(65535&(n^=n>>>13))+((3266489909*(n>>>16)&65535)<<16)&4294967295,(n^=n>>>16)>>>0}p(),l(r,"murmurhash3_32_gc"),typeof t<"u"&&(t.exports=r)})),m=u(((e,t)=>{function r(e,t){for(var r,i=e.length,n=t^i,a=0;i>=4;)r=1540483477*(65535&(r=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+((1540483477*(r>>>16)&65535)<<16),n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),i-=4,++a;switch(i){case 3:n^=(255&e.charCodeAt(a+2))<<16;case 2:n^=(255&e.charCodeAt(a+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(a)))+((1540483477*(n>>>16)&65535)<<16)}return n=1540483477*(65535&(n^=n>>>13))+((1540483477*(n>>>16)&65535)<<16),(n^=n>>>15)>>>0}p(),l(r,"murmurhash2_32_gc"),void 0!==typeof t&&(t.exports=r)})),g=u(((e,t)=>{p();var r=y(),i=m();t.exports=r,t.exports.murmur3=r,t.exports.murmur2=i})),x=u(((e,t)=>{"use strict";function r(e,t,r){r=r||2;var n,s,o,l,u,c,p,f=t&&t.length,d=f?t[0]*r:e.length,y=i(e,0,d,r,!0),m=[];if(!y||y.next===y.prev)return m;if(f&&(y=h(e,t,y,r)),e.length>80*r){n=o=e[0],s=l=e[1];for(var g=r;g<d;g+=r)(u=e[g])<n&&(n=u),(c=e[g+1])<s&&(s=c),u>o&&(o=u),c>l&&(l=c);p=0!==(p=Math.max(o-n,l-s))?32767/p:0}return a(y,m,r,n,s,p,0),m}function i(e,t,r,i,n){var a,s;if(n===L(e,t,r,i)>0)for(a=t;a<r;a+=i)s=V(a,e[a],e[a+1],s);else for(a=r-i;a>=t;a-=i)s=V(a,e[a],e[a+1],s);return s&&k(s,s.next)&&(T(s),s=s.next),s}function n(e,t){if(!e)return e;t||(t=e);var r,i=e;do{if(r=!1,i.steiner||!k(i,i.next)&&0!==S(i.prev,i,i.next))i=i.next;else{if(T(i),(i=t=i.prev)===i.next)break;r=!0}}while(r||i!==t);return t}function a(e,t,r,i,l,h,p){if(e){!p&&h&&g(e,i,l,h);for(var f,d,y=e;e.prev!==e.next;)if(f=e.prev,d=e.next,h?o(e,i,l,h):s(e))t.push(f.i/r|0),t.push(e.i/r|0),t.push(d.i/r|0),T(e),e=d.next,y=d.next;else if((e=d)===y){p?1===p?a(e=u(n(e),t,r),t,r,i,l,h,2):2===p&&c(e,t,r,i,l,h):a(n(e),t,r,i,l,h,1);break}}}function s(e){var t=e.prev,r=e,i=e.next;if(S(t,r,i)>=0)return!1;for(var n=t.x,a=r.x,s=i.x,o=t.y,l=r.y,u=i.y,c=n<a?n<s?n:s:a<s?a:s,h=o<l?o<u?o:u:l<u?l:u,p=n>a?n>s?n:s:a>s?a:s,f=o>l?o>u?o:u:l>u?l:u,d=i.next;d!==t;){if(d.x>=c&&d.x<=p&&d.y>=h&&d.y<=f&&w(n,o,a,l,s,u,d.x,d.y)&&S(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function o(e,t,r,i){var n=e.prev,a=e,s=e.next;if(S(n,a,s)>=0)return!1;for(var o=n.x,l=a.x,u=s.x,c=n.y,h=a.y,p=s.y,f=o<l?o<u?o:u:l<u?l:u,d=c<h?c<p?c:p:h<p?h:p,y=o>l?o>u?o:u:l>u?l:u,m=c>h?c>p?c:p:h>p?h:p,g=v(f,d,t,r,i),x=v(y,m,t,r,i),b=e.prevZ,_=e.nextZ;b&&b.z>=g&&_&&_.z<=x;){if(b.x>=f&&b.x<=y&&b.y>=d&&b.y<=m&&b!==n&&b!==s&&w(o,c,l,h,u,p,b.x,b.y)&&S(b.prev,b,b.next)>=0||(b=b.prevZ,_.x>=f&&_.x<=y&&_.y>=d&&_.y<=m&&_!==n&&_!==s&&w(o,c,l,h,u,p,_.x,_.y)&&S(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;b&&b.z>=g;){if(b.x>=f&&b.x<=y&&b.y>=d&&b.y<=m&&b!==n&&b!==s&&w(o,c,l,h,u,p,b.x,b.y)&&S(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;_&&_.z<=x;){if(_.x>=f&&_.x<=y&&_.y>=d&&_.y<=m&&_!==n&&_!==s&&w(o,c,l,h,u,p,_.x,_.y)&&S(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function u(e,t,r){var i=e;do{var a=i.prev,s=i.next.next;!k(a,s)&&A(a,i,i.next,s)&&P(a,s)&&P(s,a)&&(t.push(a.i/r|0),t.push(i.i/r|0),t.push(s.i/r|0),T(i),T(i.next),i=e=s),i=i.next}while(i!==e);return n(i)}function c(e,t,r,i,s,o){var l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&_(l,u)){var c=B(l,u);return l=n(l,l.next),c=n(c,c.next),a(l,t,r,i,s,o,0),void a(c,t,r,i,s,o,0)}u=u.next}l=l.next}while(l!==e)}function h(e,t,r,n){var a,s,o,l=[];for(a=0,s=t.length;a<s;a++)(o=i(e,t[a]*n,a<s-1?t[a+1]*n:e.length,n,!1))===o.next&&(o.steiner=!0),l.push(b(o));for(l.sort(f),a=0;a<l.length;a++)r=d(l[a],r);return r}function f(e,t){return e.x-t.x}function d(e,t){var r=y(e,t);if(!r)return t;var i=B(r,e);return n(i,i.next),n(r,r.next)}function y(e,t){var r,i=t,n=e.x,a=e.y,s=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var o=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(o<=n&&o>s&&(s=o,r=i.x<i.next.x?i:i.next,o===n))return r}i=i.next}while(i!==t);if(!r)return null;var l,u=r,c=r.x,h=r.y,p=1/0;i=r;do{n>=i.x&&i.x>=c&&n!==i.x&&w(a<h?n:s,a,c,h,a<h?s:n,a,i.x,i.y)&&(l=Math.abs(a-i.y)/(n-i.x),P(i,e)&&(l<p||l===p&&(i.x>r.x||i.x===r.x&&m(r,i)))&&(r=i,p=l)),i=i.next}while(i!==u);return r}function m(e,t){return S(e.prev,e,t.prev)<0&&S(t.next,e,e.next)<0}function g(e,t,r,i){var n=e;do{0===n.z&&(n.z=v(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,x(n)}function x(e){var t,r,i,n,a,s,o,l,u=1;do{for(r=e,e=null,a=null,s=0;r;){for(s++,i=r,o=0,t=0;t<u&&(o++,i=i.nextZ);t++);for(l=u;o>0||l>0&&i;)0!==o&&(0===l||!i||r.z<=i.z)?(n=r,r=r.nextZ,o--):(n=i,i=i.nextZ,l--),a?a.nextZ=n:e=n,n.prevZ=a,a=n;r=i}a.nextZ=null,u*=2}while(s>1);return e}function v(e,t,r,i,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function b(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function w(e,t,r,i,n,a,s,o){return(n-s)*(t-o)>=(e-s)*(a-o)&&(e-s)*(i-o)>=(r-s)*(t-o)&&(r-s)*(a-o)>=(n-s)*(i-o)}function _(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!z(e,t)&&(P(e,t)&&P(t,e)&&C(e,t)&&(S(e.prev,e,t.prev)||S(e,t.prev,t))||k(e,t)&&S(e.prev,e,e.next)>0&&S(t.prev,t,t.next)>0)}function S(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function k(e,t){return e.x===t.x&&e.y===t.y}function A(e,t,r,i){var n=M(S(e,t,r)),a=M(S(e,t,i)),s=M(S(r,i,e)),o=M(S(r,i,t));return!!(n!==a&&s!==o||0===n&&I(e,r,t)||0===a&&I(e,i,t)||0===s&&I(r,e,i)||0===o&&I(r,t,i))}function I(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function M(e){return e>0?1:e<0?-1:0}function z(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&A(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function P(e,t){return S(e.prev,e,e.next)<0?S(e,t,e.next)>=0&&S(e,e.prev,t)>=0:S(e,t,e.prev)<0||S(e,e.next,t)<0}function C(e,t){var r=e,i=!1,n=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==e);return i}function B(e,t){var r=new E(e.i,e.x,e.y),i=new E(t.i,t.x,t.y),n=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,a.next=i,i.prev=a,i}function V(e,t,r,i){var n=new E(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function T(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function E(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function L(e,t,r,i){for(var n=0,a=t,s=r-i;a<r;a+=i)n+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return n}p(),t.exports=r,t.exports.default=r,l(r,"earcut"),l(i,"linkedList"),l(n,"filterPoints"),l(a,"earcutLinked"),l(s,"isEar"),l(o,"isEarHashed"),l(u,"cureLocalIntersections"),l(c,"splitEarcut"),l(h,"eliminateHoles"),l(f,"compareX"),l(d,"eliminateHole"),l(y,"findHoleBridge"),l(m,"sectorContainsSector"),l(g,"indexCurve"),l(x,"sortLinked"),l(v,"zOrder"),l(b,"getLeftmost"),l(w,"pointInTriangle"),l(_,"isValidDiagonal"),l(S,"area"),l(k,"equals"),l(A,"intersects"),l(I,"onSegment"),l(M,"sign"),l(z,"intersectsPolygon"),l(P,"locallyInside"),l(C,"middleInside"),l(B,"splitPolygon"),l(V,"insertNode"),l(T,"removeNode"),l(E,"Node"),r.deviation=function(e,t,r,i){var n=t&&t.length,a=n?t[0]*r:e.length,s=Math.abs(L(e,0,a,r));if(n)for(var o=0,l=t.length;o<l;o++){var u=t[o]*r,c=o<l-1?t[o+1]*r:e.length;s-=Math.abs(L(e,u,c,r))}var h=0;for(o=0;o<i.length;o+=3){var p=i[o]*r,f=i[o+1]*r,d=i[o+2]*r;h+=Math.abs((e[p]-e[d])*(e[f+1]-e[p+1])-(e[p]-e[f])*(e[d+1]-e[p+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},l(L,"signedArea"),r.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var a=0;a<e[n].length;a++)for(var s=0;s<t;s++)r.vertices.push(e[n][a][s]);n>0&&(i+=e[n-1].length,r.holes.push(i))}return r}})),v=u(((e,t)=>{"use strict";p();var r=f();function i(e,t,r,i,a){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=i,this._values=a,e.readFields(n,this,t)}function n(e,t,r){1==e?t.id=r.readVarint():2==e?a(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function a(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var i=t._keys[e.readVarint()],n=t._values[e.readVarint()];t.properties[i]=n}}function s(e){var t=e.length;if(t<=1)return[e];for(var r,i,n=[],a=0;a<t;a++){var s=o(e[a]);0!==s&&(void 0===i&&(i=s<0),i===s<0?(r&&n.push(r),r=[e[a]]):r.push(e[a]))}return r&&n.push(r),n}function o(e){for(var t,r,i=0,n=0,a=e.length,s=a-1;n<a;s=n++)t=e[n],i+=((r=e[s]).x-t.x)*(t.y+r.y);return i}t.exports=i,l(i,"VectorTileFeature"),l(n,"readFeature"),l(a,"readTag"),i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,n=1,a=0,s=0,o=0,l=[];e.pos<i;){if(a<=0){var u=e.readVarint();n=7&u,a=u>>3}if(a--,1===n||2===n)s+=e.readSVarint(),o+=e.readSVarint(),1===n&&(t&&l.push(t),t=[]),t.push(new r(s,o));else{if(7!==n)throw new Error("unknown command "+n);t&&t.push(t[0].clone())}}return t&&l.push(t),l},i.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,i=0,n=0,a=0,s=1/0,o=-1/0,l=1/0,u=-1/0;e.pos<t;){if(i<=0){var c=e.readVarint();r=7&c,i=c>>3}if(i--,1===r||2===r)(n+=e.readSVarint())<s&&(s=n),n>o&&(o=n),(a+=e.readSVarint())<l&&(l=a),a>u&&(u=a);else if(7!==r)throw new Error("unknown command "+r)}return[s,l,o,u]},i.prototype.toGeoJSON=function(e,t,r){var n,a,o=this.extent*Math.pow(2,r),u=this.extent*e,c=this.extent*t,h=this.loadGeometry(),p=i.types[this.type];function f(e){for(var t=0;t<e.length;t++){var r=e[t],i=180-360*(r.y+c)/o;e[t]=[360*(r.x+u)/o-180,360/Math.PI*Math.atan(Math.exp(i*Math.PI/180))-90]}}switch(l(f,"project"),this.type){case 1:var d=[];for(n=0;n<h.length;n++)d[n]=h[n][0];f(h=d);break;case 2:for(n=0;n<h.length;n++)f(h[n]);break;case 3:for(h=s(h),n=0;n<h.length;n++)for(a=0;a<h[n].length;a++)f(h[n][a])}1===h.length?h=h[0]:p="Multi"+p;var y={type:"Feature",geometry:{type:p,coordinates:h},properties:this.properties};return"id"in this&&(y.id=this.id),y},l(s,"classifyRings"),l(o,"signedArea")})),b=u(((e,t)=>{"use strict";p();var r=v();function i(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(n,this,t),this.length=this._features.length}function n(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(a(r))}function a(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var i=e.readVarint()>>3;t=1===i?e.readString():2===i?e.readFloat():3===i?e.readDouble():4===i?e.readVarint64():5===i?e.readVarint():6===i?e.readSVarint():7===i?e.readBoolean():null}return t}t.exports=i,l(i,"VectorTileLayer"),l(n,"readLayer"),l(a,"readValueMessage"),i.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new r(this._pbf,t,this.extent,this._keys,this._values)}})),w=u(((e,t)=>{"use strict";p();var r=b();function i(e,t){this.layers=e.readFields(n,{},t)}function n(e,t,i){if(3===e){var n=new r(i,i.readVarint()+i.pos);n.length&&(t[n.name]=n)}}t.exports=i,l(i,"VectorTile"),l(n,"readTile")})),_=u(((e,t)=>{p(),t.exports.VectorTile=w(),t.exports.VectorTileFeature=v(),t.exports.VectorTileLayer=b()})),S=u((e=>{p(),e.read=function(e,t,r,i,n){var a,s,o=8*n-i-1,l=(1<<o)-1,u=l>>1,c=-7,h=r?n-1:0,p=r?-1:1,f=e[t+h];for(h+=p,a=f&(1<<-c)-1,f>>=-c,c+=o;c>0;a=256*a+e[t+h],h+=p,c-=8);for(s=a&(1<<-c)-1,a>>=-c,c+=i;c>0;s=256*s+e[t+h],h+=p,c-=8);if(0===a)a=1-u;else{if(a===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,i),a-=u}return(f?-1:1)*s*Math.pow(2,a-i)},e.write=function(e,t,r,i,n,a){var s,o,l,u=8*a-n-1,c=(1<<u)-1,h=c>>1,p=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:a-1,d=i?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=c?(o=0,s=c):s+h>=1?(o=(t*l-1)*Math.pow(2,n),s+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,n),s=0));n>=8;e[r+f]=255&o,f+=d,o/=256,n-=8);for(s=s<<n|o,u+=n;u>0;e[r+f]=255&s,f+=d,s/=256,u-=8);e[r+f-d]|=128*y}})),k=u(((e,t)=>{"use strict";p(),t.exports=i;var r=S();function i(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}l(i,"Pbf"),i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var n=4294967296,a=1/n,s=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function o(e,t,r){var i,n,a=r.buf;if(i=(112&(n=a[r.pos++]))>>4,n<128||(i|=(127&(n=a[r.pos++]))<<3,n<128)||(i|=(127&(n=a[r.pos++]))<<10,n<128)||(i|=(127&(n=a[r.pos++]))<<17,n<128)||(i|=(127&(n=a[r.pos++]))<<24,n<128)||(i|=(1&(n=a[r.pos++]))<<31,n<128))return c(e,i,t);throw new Error("Expected varint not more than 10 bytes")}function u(e){return e.type===i.Bytes?e.readVarint()+e.pos:e.pos+1}function c(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function h(e,t){var r,i;if(e>=0?(r=e%4294967296|0,i=e/4294967296|0):(i=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,i=i+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),f(r,i,t),d(i,t)}function f(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos]=127&e}function d(e,t){var r=(7&e)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}function y(e,t,r){var i=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(i);for(var n=r.pos-1;n>=e;n--)r.buf[n+i]=r.buf[n]}function m(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function g(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function x(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function v(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function b(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function w(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function _(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function k(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function A(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function I(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function M(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function z(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function P(e,t,r){for(var i="",n=t;n<r;){var a,s,o,l=e[n],u=null,c=l>239?4:l>223?3:l>191?2:1;if(n+c>r)break;1===c?l<128&&(u=l):2===c?128==(192&(a=e[n+1]))&&((u=(31&l)<<6|63&a)<=127&&(u=null)):3===c?(a=e[n+1],s=e[n+2],128==(192&a)&&128==(192&s)&&(((u=(15&l)<<12|(63&a)<<6|63&s)<=2047||u>=55296&&u<=57343)&&(u=null))):4===c&&(a=e[n+1],s=e[n+2],o=e[n+3],128==(192&a)&&128==(192&s)&&128==(192&o)&&(((u=(15&l)<<18|(63&a)<<12|(63&s)<<6|63&o)<=65535||u>=1114112)&&(u=null))),null===u?(u=65533,c=1):u>65535&&(u-=65536,i+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),i+=String.fromCharCode(u),n+=c}return i}function C(e,t,r){return s.decode(e.subarray(t,r))}function B(e,t,r){for(var i,n,a=0;a<t.length;a++){if((i=t.charCodeAt(a))>55295&&i<57344){if(!n){i>56319||a+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):n=i;continue}if(i<56320){e[r++]=239,e[r++]=191,e[r++]=189,n=i;continue}i=n-55296<<10|i-56320|65536,n=null}else n&&(e[r++]=239,e[r++]=191,e[r++]=189,n=null);i<128?e[r++]=i:(i<2048?e[r++]=i>>6|192:(i<65536?e[r++]=i>>12|224:(e[r++]=i>>18|240,e[r++]=i>>12&63|128),e[r++]=i>>6&63|128),e[r++]=63&i|128)}return r}i.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var i=this.readVarint(),n=i>>3,a=this.pos;this.type=7&i,e(n,t,this),this.pos===a&&this.skip(i)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=I(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=z(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=I(this.buf,this.pos)+I(this.buf,this.pos+4)*n;return this.pos+=8,e},readSFixed64:function(){var e=I(this.buf,this.pos)+z(this.buf,this.pos+4)*n;return this.pos+=8,e},readFloat:function(){var e=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,i=this.buf;return t=127&(r=i[this.pos++]),r<128||(t|=(127&(r=i[this.pos++]))<<7,r<128)||(t|=(127&(r=i[this.pos++]))<<14,r<128)||(t|=(127&(r=i[this.pos++]))<<21,r<128)?t:o(t|=(15&(r=i[this.pos]))<<28,e,this)},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&s?C(this.buf,t,e):P(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==i.Bytes)return e.push(this.readVarint(t));var r=u(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==i.Bytes)return e.push(this.readSVarint());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==i.Bytes)return e.push(this.readBoolean());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==i.Bytes)return e.push(this.readFloat());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==i.Bytes)return e.push(this.readDouble());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==i.Bytes)return e.push(this.readFixed32());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==i.Bytes)return e.push(this.readSFixed32());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==i.Bytes)return e.push(this.readFixed64());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==i.Bytes)return e.push(this.readSFixed64());var t=u(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===i.Varint)for(;this.buf[this.pos++]>127;);else if(t===i.Bytes)this.pos=this.readVarint()+this.pos;else if(t===i.Fixed32)this.pos+=4;else{if(t!==i.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),M(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),M(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),M(this.buf,-1&e,this.pos),M(this.buf,Math.floor(e*a),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),M(this.buf,-1&e,this.pos),M(this.buf,Math.floor(e*a),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?h(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=B(this.buf,e,this.pos);var r=this.pos-t;r>=128&&y(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),r.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),r.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var i=this.pos-r;i>=128&&y(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i},writeMessage:function(e,t,r){this.writeTag(e,i.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,m,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,g,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,b,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,x,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,v,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,w,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,_,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,k,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,A,t)},writeBytesField:function(e,t){this.writeTag(e,i.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,i.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,i.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,i.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,i.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,i.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,i.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,i.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,i.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,i.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}},l(o,"readVarintRemainder"),l(u,"readPackedEnd"),l(c,"toNum"),l(h,"writeBigVarint"),l(f,"writeBigVarintLow"),l(d,"writeBigVarintHigh"),l(y,"makeRoomForExtraLength"),l(m,"writePackedVarint"),l(g,"writePackedSVarint"),l(x,"writePackedFloat"),l(v,"writePackedDouble"),l(b,"writePackedBoolean"),l(w,"writePackedFixed32"),l(_,"writePackedSFixed32"),l(k,"writePackedFixed64"),l(A,"writePackedSFixed64"),l(I,"readUInt32"),l(M,"writeInt32"),l(z,"readInt32"),l(P,"readUtf8"),l(C,"readUtf8TextDecoder"),l(B,"writeUtf8")})),A=u(((e,t)=>{function r(e,t){var n,a=e&&e.type;if("FeatureCollection"===a)for(n=0;n<e.features.length;n++)r(e.features[n],t);else if("GeometryCollection"===a)for(n=0;n<e.geometries.length;n++)r(e.geometries[n],t);else if("Feature"===a)r(e.geometry,t);else if("Polygon"===a)i(e.coordinates,t);else if("MultiPolygon"===a)for(n=0;n<e.coordinates.length;n++)i(e.coordinates[n],t);return e}function i(e,t){if(0!==e.length){n(e[0],t);for(var r=1;r<e.length;r++)n(e[r],!t)}}function n(e,t){for(var r=0,i=0,n=0,a=e.length,s=a-1;n<a;s=n++){var o=(e[n][0]-e[s][0])*(e[s][1]+e[n][1]),l=r+o;i+=Math.abs(r)>=Math.abs(o)?r-l+o:o-l+r,r=l}r+i>=0!=!!t&&e.reverse()}p(),t.exports=r,l(r,"rewind"),l(i,"rewindRings"),l(n,"rewindRing")})),I=u(((e,t)=>{"use strict";p();var r=f(),i=_().VectorTileFeature;function n(e,t){this.options=t||{},this.features=e,this.length=e.length}function a(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}t.exports=n,l(n,"GeoJSONWrapper"),n.prototype.feature=function(e){return new a(this.features[e],this.options.extent)},l(a,"FeatureWrapper"),a.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var i=e[t],n=[],a=0;a<i.length;a++)n.push(new r(i[a][0],i[a][1]));this.geometry.push(n)}return this.geometry},a.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,i=1/0,n=-1/0,a=0;a<e.length;a++)for(var s=e[a],o=0;o<s.length;o++){var l=s[o];t=Math.min(t,l.x),r=Math.max(r,l.x),i=Math.min(i,l.y),n=Math.max(n,l.y)}return[t,i,r,n]},a.prototype.toGeoJSON=i.prototype.toGeoJSON})),M=u(((e,t)=>{p();var r=k(),i=I();function n(e){var t=new r;return s(e,t),t.finish()}function a(e,t){t=t||{};var r={};for(var a in e)r[a]=new i(e[a].features,t),r[a].name=a,r[a].version=t.version,r[a].extent=t.extent;return n({layers:r})}function s(e,t){for(var r in e.layers)t.writeMessage(3,o,e.layers[r])}function o(e,t){t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var r,i={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)i.feature=e.feature(r),t.writeMessage(2,u,i);var n=i.keys;for(r=0;r<n.length;r++)t.writeStringField(3,n[r]);var a=i.values;for(r=0;r<a.length;r++)t.writeMessage(4,y,a[r])}function u(e,t){var r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,c,e),t.writeVarintField(3,r.type),t.writeMessage(4,d,r)}function c(e,t){var r=e.feature,i=e.keys,n=e.values,a=e.keycache,s=e.valuecache;for(var o in r.properties){var l=r.properties[o],u=a[o];if(null!==l){typeof u>"u"&&(i.push(o),u=i.length-1,a[o]=u),t.writeVarint(u);var c=typeof l;"string"!==c&&"boolean"!==c&&"number"!==c&&(l=JSON.stringify(l));var h=c+":"+l,p=s[h];typeof p>"u"&&(n.push(l),p=n.length-1,s[h]=p),t.writeVarint(p)}}}function h(e,t){return(t<<3)+(7&e)}function f(e){return e<<1^e>>31}function d(e,t){for(var r=e.loadGeometry(),i=e.type,n=0,a=0,s=r.length,o=0;o<s;o++){var l=r[o],u=1;1===i&&(u=l.length),t.writeVarint(h(1,u));for(var c=3===i?l.length-1:l.length,p=0;p<c;p++){1===p&&1!==i&&t.writeVarint(h(2,c-1));var d=l[p].x-n,y=l[p].y-a;t.writeVarint(f(d)),t.writeVarint(f(y)),n+=d,a+=y}3===i&&t.writeVarint(h(7,1))}}function y(e,t){var r=typeof e;"string"===r?t.writeStringField(1,e):"boolean"===r?t.writeBooleanField(7,e):"number"===r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}t.exports=n,t.exports.fromVectorTileJs=n,t.exports.fromGeojsonVt=a,t.exports.GeoJSONWrapper=i,l(n,"fromVectorTileJs"),l(a,"fromGeojsonVt"),l(s,"writeTile"),l(o,"writeLayer"),l(u,"writeFeature"),l(c,"writeProperties"),l(h,"command"),l(f,"zigzag"),l(d,"writeGeometry"),l(y,"writeValue")}));p(),p(),p();h(f(),1);var z=h(d(),1);function P(e){if(e<=0)return 0;if(e>=1)return 1;let t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function C(e,t,r,i){let n=new z.default(e,t,r,i);return function(e){return n.solve(e)}}l(P,"easeCubicInOut"),l(C,"bezier");C(.25,.1,.25,1);function B(e,t,r){return Math.min(r,Math.max(t,e))}function V(e,t,r){let i=r-t,n=((e-t)%i+i)%i+t;return n===t?r:n}function T(e,...t){for(let r of t)for(let t in r)e[t]=r[t];return e}function E(e){return Math.log(e)/Math.LN2%1==0}function L(e,t,r){let i={};for(let n in e)i[n]=t.call(r||this,e[n],n,e);return i}function F(e,t,r){let i={};for(let n in e)t.call(r||this,e[n],n,e)&&(i[n]=e[n]);return i}function D(e){return Array.isArray(e)?e.map(D):"object"==typeof e&&e?L(e,D):e}function O(e,t){for(let r=0;r<e.length;r++)if(t.indexOf(e[r])>=0)return!0;return!1}l(B,"clamp"),l(V,"wrap"),l(T,"extend"),l(E,"isPowerOfTwo"),l(L,"mapObject"),l(F,"filterObject"),l(D,"clone"),l(O,"arraysIntersect");var q={};function R(e){q[e]||(typeof console<"u"&&console.warn(e),q[e]=!0)}function j(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function N(e){let t=0;for(let r,i,n=0,a=e.length,s=a-1;n<a;s=n++)r=e[n],i=e[s],t+=(i.x-r.x)*(r.y+i.y);return t}function U(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}l(R,"warnOnce"),l(j,"isCounterClockwise"),l(N,"calculateSignedArea"),l(U,"isWorker");var Z=null;function G(e){if(null==Z){let t=e.navigator?e.navigator.userAgent:null;Z=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Z}function X(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap}l(G,"isSafari"),l(X,"isImageBitmap"),p(),p();var Y=class e{constructor(e,t,r){let i=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;let n=new Int32Array(this.arrayBuffer);e=n[0],t=n[1],r=n[2],this.d=t+2*r;for(let e=0;e<this.d*this.d;e++){let t=n[3+e],r=n[3+e+1];i.push(t===r?null:n.subarray(t,r))}let a=n[3+i.length],s=n[3+i.length+1];this.keys=n.subarray(a,s),this.bboxes=n.subarray(s),this.insert=this._insertReadonly}else{this.d=t+2*r;for(let e=0;e<this.d*this.d;e++)i.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;let n=r/t*e;this.min=-n,this.max=e+n}insert(e,t,r,i,n){this._forEachCell(t,r,i,n,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(n)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,t,r,i,n,a){this.cells[n].push(a)}query(e,t,r,i,n){let a=this.min,s=this.max;if(e<=a&&t<=a&&s<=r&&s<=i&&!n)return Array.prototype.slice.call(this.keys);{let a=[],s={};return this._forEachCell(e,t,r,i,this._queryCell,a,s,n),a}}_queryCell(e,t,r,i,n,a,s,o){let l=this.cells[n];if(null!==l){let n=this.keys,u=this.bboxes;for(let c=0;c<l.length;c++){let h=l[c];if(void 0===s[h]){let l=4*h;(o?o(u[l+0],u[l+1],u[l+2],u[l+3]):e<=u[l+2]&&t<=u[l+3]&&r>=u[l+0]&&i>=u[l+1])?(s[h]=!0,a.push(n[h])):s[h]=!1}}}}_forEachCell(e,t,r,i,n,a,s,o){let l=this._convertToCellCoord(e),u=this._convertToCellCoord(t),c=this._convertToCellCoord(r),h=this._convertToCellCoord(i);for(let p=l;p<=c;p++)for(let l=u;l<=h;l++){let u=this.d*l+p;if((!o||o(this._convertFromCellCoord(p),this._convertFromCellCoord(l),this._convertFromCellCoord(p+1),this._convertFromCellCoord(l+1)))&&n.call(this,e,t,r,i,u,a,s,o))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let e=this.cells,t=3+this.cells.length+1+1,r=0;for(let e=0;e<this.cells.length;e++)r+=this.cells[e].length;let i=new Int32Array(t+r+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;let n=t;for(let t=0;t<e.length;t++){let r=e[t];i[3+t]=n,i.set(r,n),n+=r.length}return i[3+e.length]=n,i.set(this.keys,n),n+=this.keys.length,i[3+e.length+1]=n,i.set(this.bboxes,n),n+=this.bboxes.length,i.buffer}static serialize(e,t){let r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}}static deserialize(t){return new e(t.buffer)}};l(Y,"TransferableGridIndex");var J=Y;p();var H=h(d(),1),W={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},K=["type","source","source-layer","minzoom","maxzoom","filter","layout"],$=class{constructor(e,t,r,i){this.message=(e?"".concat(e,": "):"")+r,i&&(this.identifier=i),null!=t&&t.__line__&&(this.line=t.__line__)}};l($,"ValidationError");var Q=$;function ee(e,...t){for(let r of t)for(let t in r)e[t]=r[t];return e}l(ee,"extendBy");var te=class extends Error{constructor(e,t){super(t),this.message=t,this.key=e}};l(te,"ExpressionParsingError");var re=te,ie=class e{constructor(e,t=[]){this.parent=e,this.bindings={};for(let[e,r]of t)this.bindings[e]=r}concat(t){return new e(this,t)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error("".concat(e," not found in scope."))}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}};l(ie,"Scope");var ne=ie,ae={kind:"null"},se={kind:"number"},oe={kind:"string"},le={kind:"boolean"},ue={kind:"color"},ce={kind:"object"},he={kind:"value"},pe={kind:"collator"},fe={kind:"formatted"},de={kind:"padding"},ye={kind:"resolvedImage"},me={kind:"variableAnchorOffsetCollection"};function ge(e,t){return{kind:"array",itemType:e,N:t}}function xe(e){if("array"===e.kind){let t=xe(e.itemType);return"number"==typeof e.N?"array<".concat(t,", ").concat(e.N,">"):"value"===e.itemType.kind?"array":"array<".concat(t,">")}return e.kind}l(ge,"array$1"),l(xe,"toString$1");var ve=[ae,se,oe,le,ue,fe,ce,ge(he),de,ye,me];function be(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!be(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(let e of ve)if(!be(e,t))return null}return"Expected ".concat(xe(e)," but found ").concat(xe(t)," instead.")}function we(e,t){return t.some((t=>t.kind===e.kind))}function _e(e,t){return t.some((t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e))}function Se(e,t){return"array"===e.kind&&"array"===t.kind?e.itemType.kind===t.itemType.kind&&"number"==typeof e.N:e.kind===t.kind}l(be,"checkSubtype"),l(we,"isValidType"),l(_e,"isValidNativeType"),l(Se,"verifyType");var ke=.96422,Ae=.82521,Ie=4/29,Me=6/29,ze=3*Me*Me,Pe=Math.PI/180,Ce=180/Math.PI;function Be(e){return(e%=360)<0&&(e+=360),e}function Ve([e,t,r,i]){let n,a,s=Ee((.2225045*(e=Te(e))+.7168786*(t=Te(t))+.0606169*(r=Te(r)))/1);e===t&&t===r?n=a=s:(n=Ee((.4360747*e+.3850649*t+.1430804*r)/ke),a=Ee((.0139322*e+.0971045*t+.7141733*r)/Ae));let o=116*s-16;return[o<0?0:o,500*(n-s),200*(s-a),i]}function Te(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Ee(e){return e>.008856451679035631?Math.pow(e,1/3):e/ze+Ie}function Le([e,t,r,i]){let n=(e+16)/116,a=isNaN(t)?n:n+t/500,s=isNaN(r)?n:n-r/200;return n=1*De(n),a=ke*De(a),s=Ae*De(s),[Fe(3.1338561*a-1.6168667*n-.4906146*s),Fe(-.9787684*a+1.9161415*n+.033454*s),Fe(.0719453*a-.2289914*n+1.4052427*s),i]}function Fe(e){return(e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055)<0?0:e>1?1:e}function De(e){return e>Me?e*e*e:ze*(e-Ie)}function Oe(e){let[t,r,i,n]=Ve(e),a=Math.sqrt(r*r+i*i);return[Math.round(1e4*a)?Be(Math.atan2(i,r)*Ce):NaN,a,t,n]}function qe([e,t,r,i]){return e=isNaN(e)?0:e*Pe,Le([r,Math.cos(e)*t,Math.sin(e)*t,i])}function Re([e,t,r,i]){function n(i){let n=(i+e/30)%12,a=t*Math.min(r,1-r);return r-a*Math.max(-1,Math.min(n-3,9-n,1))}return e=Be(e),t/=100,r/=100,l(n,"f"),[n(0),n(8),n(4),i]}function je(e){if("transparent"===(e=e.toLowerCase().trim()))return[0,0,0,0];let t=Xe[e];if(t){let[e,r,i]=t;return[e/255,r/255,i/255,1]}if(e.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e)){let t=e.length<6?1:2,r=1;return[Ne(e.slice(r,r+=t)),Ne(e.slice(r,r+=t)),Ne(e.slice(r,r+=t)),Ne(e.slice(r,r+t)||"ff")]}if(e.startsWith("rgb")){let t=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,r=e.match(t);if(r){let[e,t,i,n,a,s,o,l,u,c,h,p]=r,f=[n||" ",o||" ",c].join("");if("  "===f||"  /"===f||",,"===f||",,,"===f){let e=[i,s,u].join(""),r="%%%"===e?100:""===e?255:0;if(r){let e=[Ze(+t/r,0,1),Ze(+a/r,0,1),Ze(+l/r,0,1),h?Ue(+h,p):1];if(Ge(e))return e}}return}}let r=e.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(r){let[e,t,i,n,a,s,o,l,u]=r,c=[i||" ",a||" ",o].join("");if("  "===c||"  /"===c||",,"===c||",,,"===c){let e=[+t,Ze(+n,0,100),Ze(+s,0,100),l?Ue(+l,u):1];if(Ge(e))return Re(e)}}}function Ne(e){return parseInt(e.padEnd(2,e),16)/255}function Ue(e,t){return Ze(t?e/100:e,0,1)}function Ze(e,t,r){return Math.min(Math.max(t,e),r)}function Ge(e){return!e.some(Number.isNaN)}l(Be,"constrainAngle"),l(Ve,"rgbToLab"),l(Te,"rgb2xyz"),l(Ee,"xyz2lab"),l(Le,"labToRgb"),l(Fe,"xyz2rgb"),l(De,"lab2xyz"),l(Oe,"rgbToHcl"),l(qe,"hclToRgb"),l(Re,"hslToRgb"),l(je,"parseCssColor"),l(Ne,"parseHex"),l(Ue,"parseAlpha"),l(Ze,"clamp"),l(Ge,"validateNumbers");var Xe={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Ye=class e{constructor(e,t,r,i=1,n=!0){this.r=e,this.g=t,this.b=r,this.a=i,n||(this.r*=i,this.g*=i,this.b*=i,i||this.overwriteGetter("rgb",[e,t,r,i]))}static parse(t){if(t instanceof e)return t;if("string"!=typeof t)return;let r=je(t);return r?new e(...r,!1):void 0}get rgb(){let{r:e,g:t,b:r,a:i}=this,n=i||1/0;return this.overwriteGetter("rgb",[e/n,t/n,r/n,i])}get hcl(){return this.overwriteGetter("hcl",Oe(this.rgb))}get lab(){return this.overwriteGetter("lab",Ve(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){let[e,t,r,i]=this.rgb;return"rgba(".concat([e,t,r].map((e=>Math.round(255*e))).join(","),",").concat(i,")")}};l(Ye,"Color");var Je=Ye;Je.black=new Je(0,0,0,1),Je.white=new Je(1,1,1,1),Je.transparent=new Je(0,0,0,0),Je.red=new Je(1,0,0,1);var He=class{constructor(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}};l(He,"Collator");var We=He,Ke=class{constructor(e,t,r,i,n){this.text=e,this.image=t,this.scale=r,this.fontStack=i,this.textColor=n}};l(Ke,"FormattedSection");var $e=Ke,Qe=class e{constructor(e){this.sections=e}static fromString(t){return new e([new $e(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((e=>0!==e.text.length||e.image&&0!==e.image.name.length))}static factory(t){return t instanceof e?t:e.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map((e=>e.text)).join("")}};l(Qe,"Formatted");var et=Qe,tt=class e{constructor(e){this.values=e.slice()}static parse(t){if(t instanceof e)return t;if("number"==typeof t)return new e([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(let e of t)if("number"!=typeof e)return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new e(t)}}toString(){return JSON.stringify(this.values)}};l(tt,"Padding");var rt=tt,it=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]),nt=class e{constructor(e){this.values=e.slice()}static parse(t){if(t instanceof e)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let e=0;e<t.length;e+=2){let r=t[e],i=t[e+1];if("string"!=typeof r||!it.has(r)||!Array.isArray(i)||2!==i.length||"number"!=typeof i[0]||"number"!=typeof i[1])return}return new e(t)}}toString(){return JSON.stringify(this.values)}};l(nt,"VariableAnchorOffsetCollection");var at=nt,st=class e{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(t){return t?new e({name:t,available:!1}):null}};l(st,"ResolvedImage");var ot=st;function lt(e,t,r,i){if(!("number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255)){return"Invalid rgba value [".concat(("number"==typeof i?[e,t,r,i]:[e,t,r]).join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}return typeof i>"u"||"number"==typeof i&&i>=0&&i<=1?null:"Invalid rgba value [".concat([e,t,r,i].join(", "),"]: 'a' must be between 0 and 1.")}function ut(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof Je||e instanceof We||e instanceof et||e instanceof rt||e instanceof at||e instanceof ot)return!0;if(Array.isArray(e)){for(let t of e)if(!ut(t))return!1;return!0}if("object"==typeof e){for(let t in e)if(!ut(e[t]))return!1;return!0}return!1}function ct(e){if(null===e)return ae;if("string"==typeof e)return oe;if("boolean"==typeof e)return le;if("number"==typeof e)return se;if(e instanceof Je)return ue;if(e instanceof We)return pe;if(e instanceof et)return fe;if(e instanceof rt)return de;if(e instanceof at)return me;if(e instanceof ot)return ye;if(Array.isArray(e)){let t,r=e.length;for(let r of e){let e=ct(r);if(t){if(t===e)continue;t=he;break}t=e}return ge(t||he,r)}return ce}function ht(e){let t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Je||e instanceof et||e instanceof rt||e instanceof at||e instanceof ot?e.toString():JSON.stringify(e)}l(lt,"validateRGBA"),l(ut,"isValue"),l(ct,"typeOf"),l(ht,"toString");var pt=class e{constructor(e,t){this.type=e,this.value=t}static parse(t,r){if(2!==t.length)return r.error("'literal' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(!ut(t[1]))return r.error("invalid value");let i=t[1],n=ct(i),a=r.expectedType;return"array"===n.kind&&0===n.N&&a&&"array"===a.kind&&("number"!=typeof a.N||0===a.N)&&(n=a),new e(n,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}};l(pt,"Literal");var ft=pt,dt=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}};l(dt,"RuntimeError");var yt=dt,mt={string:oe,number:se,boolean:le,object:ce},gt=class e{constructor(e,t){this.type=e,this.args=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let i,n=1,a=t[0];if("array"===a){let e,a;if(t.length>2){let i=t[1];if("string"!=typeof i||!(i in mt)||"object"===i)return r.error('The item type argument of "array" must be one of string, number, boolean',1);e=mt[i],n++}else e=he;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);a=t[2],n++}i=ge(e,a)}else{if(!mt[a])throw new Error("Types doesn't contain name = ".concat(a));i=mt[a]}let s=[];for(;n<t.length;n++){let e=r.parse(t[n],n,he);if(!e)return null;s.push(e)}return new e(i,s)}evaluate(e){for(let t=0;t<this.args.length;t++){let r=this.args[t].evaluate(e);if(!be(this.type,ct(r)))return r;if(t===this.args.length-1)throw new yt("Expected value to be of type ".concat(xe(this.type),", but found ").concat(xe(ct(r))," instead."))}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}};l(gt,"Assertion");var xt=gt,vt={"to-boolean":le,"to-color":ue,"to-number":se,"to-string":oe},bt=class e{constructor(e,t){this.type=e,this.args=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let i=t[0];if(!vt[i])throw new Error("Can't parse ".concat(i," as it is not part of the known types"));if(("to-boolean"===i||"to-string"===i)&&2!==t.length)return r.error("Expected one argument.");let n=vt[i],a=[];for(let e=1;e<t.length;e++){let i=r.parse(t[e],e,he);if(!i)return null;a.push(i)}return new e(n,a)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let t,r;for(let i of this.args){if(t=i.evaluate(e),r=null,t instanceof Je)return t;if("string"==typeof t){let r=e.parseColor(t);if(r)return r}else if(Array.isArray(t)&&(r=t.length<3||t.length>4?"Invalid rbga value ".concat(JSON.stringify(t),": expected an array containing either three or four numeric values."):lt(t[0],t[1],t[2],t[3]),!r))return new Je(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new yt(r||"Could not parse color from value '".concat("string"==typeof t?t:JSON.stringify(t),"'"))}case"padding":{let t;for(let r of this.args){t=r.evaluate(e);let i=rt.parse(t);if(i)return i}throw new yt("Could not parse padding from value '".concat("string"==typeof t?t:JSON.stringify(t),"'"))}case"variableAnchorOffsetCollection":{let t;for(let r of this.args){t=r.evaluate(e);let i=at.parse(t);if(i)return i}throw new yt("Could not parse variableAnchorOffsetCollection from value '".concat("string"==typeof t?t:JSON.stringify(t),"'"))}case"number":{let t=null;for(let r of this.args){if(t=r.evaluate(e),null===t)return 0;let i=Number(t);if(!isNaN(i))return i}throw new yt("Could not convert ".concat(JSON.stringify(t)," to number."))}case"formatted":return et.fromString(ht(this.args[0].evaluate(e)));case"resolvedImage":return ot.fromString(ht(this.args[0].evaluate(e)));default:return ht(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}};l(bt,"Coercion");var wt=bt,_t=["Unknown","Point","LineString","Polygon"],St=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?_t[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Je.parse(e)),t}};l(St,"EvaluationContext");var kt=St,At=class e{constructor(e,t,r=[],i,n=new ne,a=[]){this.registry=e,this.path=r,this.key=r.map((e=>"[".concat(e,"]"))).join(""),this.scope=n,this.errors=a,this.expectedType=i,this._isConstant=t}parse(e,t,r,i,n={}){return t?this.concat(t,r,i)._parse(e,n):this._parse(e,n)}_parse(e,t){function r(e,t,r){return"assert"===r?new xt(t,[e]):"coerce"===r?new wt(t,[e]):e}if((null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e)&&(e=["literal",e]),l(r,"annotate"),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let i=e[0];if("string"!=typeof i)return this.error("Expression name must be a string, but found ".concat(typeof i,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;let n=this.registry[i];if(n){let i=n.parse(e,this);if(!i)return null;if(this.expectedType){let e=this.expectedType,n=i.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==n.kind)if("color"!==e.kind&&"formatted"!==e.kind&&"resolvedImage"!==e.kind||"value"!==n.kind&&"string"!==n.kind)if("padding"!==e.kind||"value"!==n.kind&&"number"!==n.kind&&"array"!==n.kind)if("variableAnchorOffsetCollection"!==e.kind||"value"!==n.kind&&"array"!==n.kind){if(this.checkSubtype(e,n))return null}else i=r(i,e,t.typeAnnotation||"coerce");else i=r(i,e,t.typeAnnotation||"coerce");else i=r(i,e,t.typeAnnotation||"coerce");else i=r(i,e,t.typeAnnotation||"assert")}if(!(i instanceof ft)&&"resolvedImage"!==i.type.kind&&this._isConstant(i)){let e=new kt;try{i=new ft(i.type,i.evaluate(e))}catch(e){return this.error(e.message),null}}return i}return this.error('Unknown expression "'.concat(i,'". If you wanted a literal array, use ["literal", [...]].'),0)}return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):"object"==typeof e?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found ".concat(typeof e," instead."))}concat(t,r,i){let n="number"==typeof t?this.path.concat(t):this.path,a=i?this.scope.concat(i):this.scope;return new e(this.registry,this._isConstant,n,r||null,a,this.errors)}error(e,...t){let r="".concat(this.key).concat(t.map((e=>"[".concat(e,"]"))).join(""));this.errors.push(new re(r,e))}checkSubtype(e,t){let r=be(e,t);return r&&this.error(r),r}};l(At,"ParsingContext");var It=At,Mt=class e{constructor(e,t,r){this.type=pe,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(t,r){if(2!==t.length)return r.error("Expected one argument.");let i=t[1];if("object"!=typeof i||Array.isArray(i))return r.error("Collator options argument must be an object.");let n=r.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,le);if(!n)return null;let a=r.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,le);if(!a)return null;let s=null;return i.locale&&(s=r.parse(i.locale,1,oe),!s)?null:new e(n,a,s)}evaluate(e){return new We(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}};l(Mt,"CollatorExpression");var zt=Mt,Pt=8192;function Ct(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Bt(e){return(180+e)/360}function Vt(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Tt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Et(e,t){let r=Bt(e[0]),i=Vt(e[1]),n=Math.pow(2,t.z);return[Math.round(r*n*Pt),Math.round(i*n*Pt)]}function Lt(e,t,r){let i=e[0]-t[0],n=e[1]-t[1],a=e[0]-r[0],s=e[1]-r[1];return i*s-a*n==0&&i*a<=0&&n*s<=0}function Ft(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function Dt(e,t){let r=!1;for(let i=0,n=t.length;i<n;i++){let n=t[i];for(let t=0,i=n.length;t<i-1;t++){if(Lt(e,n[t],n[t+1]))return!1;Ft(e,n[t],n[t+1])&&(r=!r)}}return r}function Ot(e,t){for(let r=0;r<t.length;r++)if(Dt(e,t[r]))return!0;return!1}function qt(e,t){return e[0]*t[1]-e[1]*t[0]}function Rt(e,t,r,i){let n=e[0]-r[0],a=e[1]-r[1],s=t[0]-r[0],o=t[1]-r[1],l=i[0]-r[0],u=i[1]-r[1],c=n*u-l*a,h=s*u-l*o;return c>0&&h<0||c<0&&h>0}function jt(e,t,r,i){let n=[t[0]-e[0],t[1]-e[1]];return 0!==qt([i[0]-r[0],i[1]-r[1]],n)&&!(!Rt(e,t,r,i)||!Rt(r,i,e,t))}function Nt(e,t,r){for(let i of r)for(let r=0;r<i.length-1;++r)if(jt(e,t,i[r],i[r+1]))return!0;return!1}function Ut(e,t){for(let r=0;r<e.length;++r)if(!Dt(e[r],t))return!1;for(let r=0;r<e.length-1;++r)if(Nt(e[r],e[r+1],t))return!1;return!0}function Zt(e,t){for(let r=0;r<t.length;r++)if(Ut(e,t[r]))return!0;return!1}function Gt(e,t,r){let i=[];for(let n=0;n<e.length;n++){let a=[];for(let i=0;i<e[n].length;i++){let s=Et(e[n][i],r);Ct(t,s),a.push(s)}i.push(a)}return i}function Xt(e,t,r){let i=[];for(let n=0;n<e.length;n++){let a=Gt(e[n],t,r);i.push(a)}return i}function Yt(e,t,r,i){if(e[0]<r[0]||e[0]>r[2]){let t=.5*i,n=e[0]-r[0]>t?-i:r[0]-e[0]>t?i:0;0===n&&(n=e[0]-r[2]>t?-i:r[2]-e[0]>t?i:0),e[0]+=n}Ct(t,e)}function Jt(e){e[0]=e[1]=1/0,e[2]=e[3]=-1/0}function Ht(e,t,r,i){let n=Math.pow(2,i.z)*Pt,a=[i.x*Pt,i.y*Pt],s=[];for(let i of e)for(let e of i){let i=[e.x+a[0],e.y+a[1]];Yt(i,t,r,n),s.push(i)}return s}function Wt(e,t,r,i){let n=Math.pow(2,i.z)*Pt,a=[i.x*Pt,i.y*Pt],s=[];for(let r of e){let e=[];for(let i of r){let r=[i.x+a[0],i.y+a[1]];Ct(t,r),e.push(r)}s.push(e)}if(t[2]-t[0]<=n/2){Jt(t);for(let e of s)for(let i of e)Yt(i,t,r,n)}return s}function Kt(e,t){let r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],n=e.canonicalID();if("Polygon"===t.type){let a=Gt(t.coordinates,i,n),s=Ht(e.geometry(),r,i,n);if(!Tt(r,i))return!1;for(let e of s)if(!Dt(e,a))return!1}if("MultiPolygon"===t.type){let a=Xt(t.coordinates,i,n),s=Ht(e.geometry(),r,i,n);if(!Tt(r,i))return!1;for(let e of s)if(!Ot(e,a))return!1}return!0}function $t(e,t){let r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],n=e.canonicalID();if("Polygon"===t.type){let a=Gt(t.coordinates,i,n),s=Wt(e.geometry(),r,i,n);if(!Tt(r,i))return!1;for(let e of s)if(!Ut(e,a))return!1}if("MultiPolygon"===t.type){let a=Xt(t.coordinates,i,n),s=Wt(e.geometry(),r,i,n);if(!Tt(r,i))return!1;for(let e of s)if(!Zt(e,a))return!1}return!0}l(Ct,"updateBBox"),l(Bt,"mercatorXfromLng"),l(Vt,"mercatorYfromLat"),l(Tt,"boxWithinBox"),l(Et,"getTileCoordinates"),l(Lt,"onBoundary"),l(Ft,"rayIntersect"),l(Dt,"pointWithinPolygon"),l(Ot,"pointWithinPolygons"),l(qt,"perp"),l(Rt,"twoSided"),l(jt,"lineIntersectLine"),l(Nt,"lineIntersectPolygon"),l(Ut,"lineStringWithinPolygon"),l(Zt,"lineStringWithinPolygons"),l(Gt,"getTilePolygon"),l(Xt,"getTilePolygons"),l(Yt,"updatePoint"),l(Jt,"resetBBox"),l(Ht,"getTilePoints"),l(Wt,"getTileLines"),l(Kt,"pointsWithinPolygons"),l($t,"linesWithinPolygons");var Qt=class e{constructor(e,t){this.type=le,this.geojson=e,this.geometries=t}static parse(t,r){if(2!==t.length)return r.error("'within' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(ut(t[1])){let r=t[1];if("FeatureCollection"===r.type)for(let t=0;t<r.features.length;++t){let i=r.features[t].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new e(r,r.features[t].geometry)}else if("Feature"===r.type){let t=r.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new e(r,r.geometry)}else if("Polygon"===r.type||"MultiPolygon"===r.type)return new e(r,r)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return Kt(e,this.geometries);if("LineString"===e.geometryType())return $t(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}};l(Qt,"Within");var er=Qt,tr=class e{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(t,r){if(2!==t.length||"string"!=typeof t[1])return r.error("'var' expression requires exactly one string literal argument.");let i=t[1];return r.scope.has(i)?new e(i,r.scope.get(i)):r.error('Unknown variable "'.concat(i,'". Make sure "').concat(i,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}};l(tr,"Var");var rr=tr,ir=class e{constructor(e,t,r,i){this.name=e,this.type=t,this._evaluate=r,this.args=i}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(t,r){let i=t[0],n=e.definitions[i];if(!n)return r.error('Unknown expression "'.concat(i,'". If you wanted a literal array, use ["literal", [...]].'),0);let a=Array.isArray(n)?n[0]:n.type,s=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,o=s.filter((([e])=>!Array.isArray(e)||e.length===t.length-1)),l=null;for(let[n,s]of o){l=new It(r.registry,sr,r.path,null,r.scope);let o=[],u=!1;for(let e=1;e<t.length;e++){let r=t[e],i=Array.isArray(n)?n[e-1]:n.type,a=l.parse(r,1+o.length,i);if(!a){u=!0;break}o.push(a)}if(!u){if(Array.isArray(n)&&n.length!==o.length){l.error("Expected ".concat(n.length," arguments, but found ").concat(o.length," instead."));continue}for(let e=0;e<o.length;e++){let t=Array.isArray(n)?n[e]:n.type,r=o[e];l.concat(e+1).checkSubtype(t,r.type)}if(0===l.errors.length)return new e(i,a,s,o)}}if(1===o.length)r.errors.push(...l.errors);else{let e=(o.length?o:s).map((([e])=>ar(e))).join(" | "),i=[];for(let e=1;e<t.length;e++){let n=r.parse(t[e],1+i.length);if(!n)return null;i.push(xe(n.type))}r.error("Expected arguments of type ".concat(e,", but found (").concat(i.join(", "),") instead."))}return null}static register(t,r){e.definitions=r;for(let i in r)t[i]=e}};l(ir,"CompoundExpression");var nr=ir;function ar(e){return Array.isArray(e)?"(".concat(e.map(xe).join(", "),")"):"(".concat(xe(e.type),"...)")}function sr(e){if(e instanceof rr)return sr(e.boundExpression);if(e instanceof nr&&"error"===e.name)return!1;if(e instanceof zt)return!1;if(e instanceof er)return!1;let t=e instanceof wt||e instanceof xt,r=!0;return e.eachChild((e=>{r=t?r&&sr(e):r&&e instanceof ft})),!!r&&(or(e)&&ur(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]))}function or(e){if(e instanceof nr){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof er)return!1;let t=!0;return e.eachChild((e=>{t&&!or(e)&&(t=!1)})),t}function lr(e){if(e instanceof nr&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild((e=>{t&&!lr(e)&&(t=!1)})),t}function ur(e,t){if(e instanceof nr&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild((e=>{r&&!ur(e,t)&&(r=!1)})),r}function cr(e,t){let r,i,n=e.length-1,a=0,s=n,o=0;for(;a<=s;)if(o=Math.floor((a+s)/2),r=e[o],i=e[o+1],r<=t){if(o===n||t<i)return o;a=o+1}else{if(!(r>t))throw new yt("Input is not a number.");s=o-1}return 0}l(ar,"stringifySignature"),l(sr,"isExpressionConstant"),l(or,"isFeatureConstant"),l(lr,"isStateConstant"),l(ur,"isGlobalPropertyConstant"),l(cr,"findStopLessThanOrEqualTo");var hr=class e{constructor(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(let[e,t]of r)this.labels.push(e),this.outputs.push(t)}static parse(t,r){if(t.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");let i=r.parse(t[1],1,se);if(!i)return null;let n=[],a=null;r.expectedType&&"value"!==r.expectedType.kind&&(a=r.expectedType);for(let e=1;e<t.length;e+=2){let i=1===e?-1/0:t[e],s=t[e+1],o=e,l=e+1;if("number"!=typeof i)return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',o);if(n.length&&n[n.length-1][0]>=i)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',o);let u=r.parse(s,l,a);if(!u)return null;a=a||u.type,n.push([i,u])}return new e(a,i,n)}evaluate(e){let t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);let i=this.input.evaluate(e);if(i<=t[0])return r[0].evaluate(e);let n=t.length;return i>=t[n-1]?r[n-1].evaluate(e):r[cr(t,i)].evaluate(e)}eachChild(e){e(this.input);for(let t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}};l(hr,"Step");var pr=hr;function fr(e){return"rgb"===e||"hcl"===e||"lab"===e}function dr(e,t,r){return e+r*(t-e)}function yr(e,t,r,i="rgb"){switch(i){case"rgb":{let[i,n,a,s]=mr(e.rgb,t.rgb,r);return new Je(i,n,a,s,!1)}case"hcl":{let i,n,[a,s,o,l]=e.hcl,[u,c,h,p]=t.hcl;if(isNaN(a)||isNaN(u))isNaN(a)?isNaN(u)?i=NaN:(i=u,(1===o||0===o)&&(n=c)):(i=a,(1===h||0===h)&&(n=s));else{let e=u-a;u>a&&e>180?e-=360:u<a&&a-u>180&&(e+=360),i=a+r*e}let[f,d,y,m]=qe([i,null!=n?n:dr(s,c,r),dr(o,h,r),dr(l,p,r)]);return new Je(f,d,y,m,!1)}case"lab":{let[i,n,a,s]=Le(mr(e.lab,t.lab,r));return new Je(i,n,a,s,!1)}}}function mr(e,t,r){return e.map(((e,i)=>dr(e,t[i],r)))}function gr(e,t,r){return new rt(mr(e.values,t.values,r))}function xr(e,t,r){let i=e.values,n=t.values;if(i.length!==n.length)throw new yt("Cannot interpolate values of different length. from: ".concat(e.toString(),", to: ").concat(t.toString()));let a=[];for(let e=0;e<i.length;e+=2){if(i[e]!==n[e])throw new yt("Cannot interpolate values containing mismatched anchors. from[".concat(e,"]: ").concat(i[e],", to[").concat(e,"]: ").concat(n[e]));a.push(i[e]);let[t,s]=i[e+1],[o,l]=n[e+1];a.push([dr(t,o,r),dr(s,l,r)])}return new at(a)}l(fr,"isSupportedInterpolationColorSpace"),l(dr,"number"),l(yr,"color"),l(mr,"array"),l(gr,"padding"),l(xr,"variableAnchorOffsetCollection");var vr={number:dr,color:yr,array:mr,padding:gr,variableAnchorOffsetCollection:xr},br=class e{constructor(e,t,r,i,n){this.type=e,this.operator=t,this.interpolation=r,this.input=i,this.labels=[],this.outputs=[];for(let[e,t]of n)this.labels.push(e),this.outputs.push(t)}static interpolationFactor(e,t,r,i){let n=0;if("exponential"===e.name)n=_r(t,e.base,r,i);else if("linear"===e.name)n=_r(t,1,r,i);else if("cubic-bezier"===e.name){let a=e.controlPoints;n=new H.default(a[0],a[1],a[2],a[3]).solve(_r(t,1,r,i))}return n}static parse(t,r){let[i,n,a,...s]=t;if(!Array.isArray(n)||0===n.length)return r.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){let e=n[1];if("number"!=typeof e)return r.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:e}}else{if("cubic-bezier"!==n[0])return r.error("Unknown interpolation type ".concat(String(n[0])),1,0);{let e=n.slice(1);if(4!==e.length||e.some((e=>"number"!=typeof e||e<0||e>1)))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:e}}}if(t.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(a=r.parse(a,2,se),!a)return null;let o=[],l=null;"interpolate-hcl"===i||"interpolate-lab"===i?l=ue:r.expectedType&&"value"!==r.expectedType.kind&&(l=r.expectedType);for(let e=0;e<s.length;e+=2){let t=s[e],i=s[e+1],n=e+3,a=e+4;if("number"!=typeof t)return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',n);if(o.length&&o[o.length-1][0]>=t)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',n);let u=r.parse(i,a,l);if(!u)return null;l=l||u.type,o.push([t,u])}return Se(l,se)||Se(l,ue)||Se(l,de)||Se(l,me)||Se(l,ge(se))?new e(l,i,n,a,o):r.error("Type ".concat(xe(l)," is not interpolatable."))}evaluate(t){let r=this.labels,i=this.outputs;if(1===r.length)return i[0].evaluate(t);let n=this.input.evaluate(t);if(n<=r[0])return i[0].evaluate(t);let a=r.length;if(n>=r[a-1])return i[a-1].evaluate(t);let s=cr(r,n),o=r[s],l=r[s+1],u=e.interpolationFactor(this.interpolation,n,o,l),c=i[s].evaluate(t),h=i[s+1].evaluate(t);switch(this.operator){case"interpolate":return vr[this.type.kind](c,h,u);case"interpolate-hcl":return vr.color(c,h,u,"hcl");case"interpolate-lab":return vr.color(c,h,u,"lab")}}eachChild(e){e(this.input);for(let t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}};l(br,"Interpolate");var wr=br;function _r(e,t,r,i){let n=i-r,a=e-r;return 0===n?0:1===t?a/n:(Math.pow(t,a)-1)/(Math.pow(t,n)-1)}l(_r,"exponentialInterpolation");var Sr=class e{constructor(e,t){this.type=e,this.args=t}static parse(t,r){if(t.length<2)return r.error("Expectected at least one argument.");let i=null,n=r.expectedType;n&&"value"!==n.kind&&(i=n);let a=[];for(let e of t.slice(1)){let t=r.parse(e,1+a.length,i,void 0,{typeAnnotation:"omit"});if(!t)return null;i=i||t.type,a.push(t)}if(!i)throw new Error("No output type");return n&&a.some((e=>be(n,e.type)))?new e(he,a):new e(i,a)}evaluate(e){let t,r=null,i=0;for(let n of this.args)if(i++,r=n.evaluate(e),r&&r instanceof ot&&!r.available&&(t||(t=r.name),r=null,i===this.args.length&&(r=t)),null!==r)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}};l(Sr,"Coalesce");var kr=Sr,Ar=class e{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let t of this.bindings)e(t[1]);e(this.result)}static parse(t,r){if(t.length<4)return r.error("Expected at least 3 arguments, but found ".concat(t.length-1," instead."));let i=[];for(let e=1;e<t.length-1;e+=2){let n=t[e];if("string"!=typeof n)return r.error("Expected string, but found ".concat(typeof n," instead."),e);if(/[^a-zA-Z0-9_]/.test(n))return r.error("Variable names must contain only alphanumeric characters or '_'.",e);let a=r.parse(t[e+1],e+1);if(!a)return null;i.push([n,a])}let n=r.parse(t[t.length-1],t.length-1,r.expectedType,i);return n?new e(i,n):null}outputDefined(){return this.result.outputDefined()}};l(Ar,"Let");var Ir=Ar,Mr=class e{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(t,r){if(3!==t.length)return r.error("Expected 2 arguments, but found ".concat(t.length-1," instead."));let i=r.parse(t[1],1,se),n=r.parse(t[2],2,ge(r.expectedType||he));if(!i||!n)return null;let a=n.type;return new e(a.itemType,i,n)}evaluate(e){let t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new yt("Array index out of bounds: ".concat(t," < 0."));if(t>=r.length)throw new yt("Array index out of bounds: ".concat(t," > ").concat(r.length-1,"."));if(t!==Math.floor(t))throw new yt("Array index must be an integer, but found ".concat(t," instead."));return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}};l(Mr,"At");var zr=Mr,Pr=class e{constructor(e,t){this.type=le,this.needle=e,this.haystack=t}static parse(t,r){if(3!==t.length)return r.error("Expected 2 arguments, but found ".concat(t.length-1," instead."));let i=r.parse(t[1],1,he),n=r.parse(t[2],2,he);return i&&n?we(i.type,[le,oe,se,ae,he])?new e(i,n):r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(xe(i.type)," instead")):null}evaluate(e){let t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!_e(t,["boolean","string","number","null"]))throw new yt("Expected first argument to be of type boolean, string, number or null, but found ".concat(xe(ct(t))," instead."));if(!_e(r,["string","array"]))throw new yt("Expected second argument to be of type array or string, but found ".concat(xe(ct(r))," instead."));return r.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}};l(Pr,"In");var Cr=Pr,Br=class e{constructor(e,t,r){this.type=se,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(t,r){if(t.length<=2||t.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(t.length-1," instead."));let i=r.parse(t[1],1,he),n=r.parse(t[2],2,he);if(!i||!n)return null;if(!we(i.type,[le,oe,se,ae,he]))return r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(xe(i.type)," instead"));if(4===t.length){let a=r.parse(t[3],3,se);return a?new e(i,n,a):null}return new e(i,n)}evaluate(e){let t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!_e(t,["boolean","string","number","null"]))throw new yt("Expected first argument to be of type boolean, string, number or null, but found ".concat(xe(ct(t))," instead."));if(!_e(r,["string","array"]))throw new yt("Expected second argument to be of type array or string, but found ".concat(xe(ct(r))," instead."));if(this.fromIndex){let i=this.fromIndex.evaluate(e);return r.indexOf(t,i)}return r.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}};l(Br,"IndexOf");var Vr=Br,Tr=class e{constructor(e,t,r,i,n,a){this.inputType=e,this.type=t,this.input=r,this.cases=i,this.outputs=n,this.otherwise=a}static parse(t,r){if(t.length<5)return r.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if(t.length%2!=1)return r.error("Expected an even number of arguments.");let i,n;r.expectedType&&"value"!==r.expectedType.kind&&(n=r.expectedType);let a={},s=[];for(let e=2;e<t.length-1;e+=2){let o=t[e],l=t[e+1];Array.isArray(o)||(o=[o]);let u=r.concat(e);if(0===o.length)return u.error("Expected at least one branch label.");for(let e of o){if("number"!=typeof e&&"string"!=typeof e)return u.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if("number"==typeof e&&Math.floor(e)!==e)return u.error("Numeric branch labels must be integer values.");if(i){if(u.checkSubtype(i,ct(e)))return null}else i=ct(e);if(typeof a[String(e)]<"u")return u.error("Branch labels must be unique.");a[String(e)]=s.length}let c=r.parse(l,e,n);if(!c)return null;n=n||c.type,s.push(c)}let o=r.parse(t[1],1,he);if(!o)return null;let l=r.parse(t[t.length-1],t.length-1,n);return!l||"value"!==o.type.kind&&r.concat(1).checkSubtype(i,o.type)?null:new e(i,n,o,a,s,l)}evaluate(e){let t=this.input.evaluate(e);return(ct(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}};l(Tr,"Match");var Er=Tr,Lr=class e{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(t,r){if(t.length<4)return r.error("Expected at least 3 arguments, but found only ".concat(t.length-1,"."));if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let i;r.expectedType&&"value"!==r.expectedType.kind&&(i=r.expectedType);let n=[];for(let e=1;e<t.length-1;e+=2){let a=r.parse(t[e],e,le);if(!a)return null;let s=r.parse(t[e+1],e+1,i);if(!s)return null;n.push([a,s]),i=i||s.type}let a=r.parse(t[t.length-1],t.length-1,i);if(!a)return null;if(!i)throw new Error("Can't infer output type");return new e(i,n,a)}evaluate(e){for(let[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every((([e,t])=>t.outputDefined()))&&this.otherwise.outputDefined()}};l(Lr,"Case");var Fr=Lr,Dr=class e{constructor(e,t,r,i){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=i}static parse(t,r){if(t.length<=2||t.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(t.length-1," instead."));let i=r.parse(t[1],1,he),n=r.parse(t[2],2,se);if(!i||!n)return null;if(!we(i.type,[ge(he),oe,he]))return r.error("Expected first argument to be of type array or string, but found ".concat(xe(i.type)," instead"));if(4===t.length){let a=r.parse(t[3],3,se);return a?new e(i.type,i,n,a):null}return new e(i.type,i,n)}evaluate(e){let t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!_e(t,["string","array"]))throw new yt("Expected first argument to be of type array or string, but found ".concat(xe(ct(t))," instead."));if(this.endIndex){let i=this.endIndex.evaluate(e);return t.slice(r,i)}return t.slice(r)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}};l(Dr,"Slice");var Or=Dr;function qr(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function Rr(e,t,r){return t===r}function jr(e,t,r){return t!==r}function Nr(e,t,r){return t<r}function Ur(e,t,r){return t>r}function Zr(e,t,r){return t<=r}function Gr(e,t,r){return t>=r}function Xr(e,t,r,i){return 0===i.compare(t,r)}function Yr(e,t,r,i){return!Xr(0,t,r,i)}function Jr(e,t,r,i){return i.compare(t,r)<0}function Hr(e,t,r,i){return i.compare(t,r)>0}function Wr(e,t,r,i){return i.compare(t,r)<=0}function Kr(e,t,r,i){return i.compare(t,r)>=0}function $r(e,t,r){var i;let n="=="!==e&&"!="!==e;return l(i=class{constructor(e,t,r){this.type=le,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");let r=e[0],a=t.parse(e[1],1,he);if(!a)return null;if(!qr(r,a.type))return t.concat(1).error('"'.concat(r,"\" comparisons are not supported for type '").concat(xe(a.type),"'."));let s=t.parse(e[2],2,he);if(!s)return null;if(!qr(r,s.type))return t.concat(2).error('"'.concat(r,"\" comparisons are not supported for type '").concat(xe(s.type),"'."));if(a.type.kind!==s.type.kind&&"value"!==a.type.kind&&"value"!==s.type.kind)return t.error("Cannot compare types '".concat(xe(a.type),"' and '").concat(xe(s.type),"'."));n&&("value"===a.type.kind&&"value"!==s.type.kind?a=new xt(s.type,[a]):"value"!==a.type.kind&&"value"===s.type.kind&&(s=new xt(a.type,[s])));let o=null;if(4===e.length){if("string"!==a.type.kind&&"string"!==s.type.kind&&"value"!==a.type.kind&&"value"!==s.type.kind)return t.error("Cannot use collator to compare non-string types.");if(o=t.parse(e[3],3,pe),!o)return null}return new i(a,s,o)}evaluate(i){let a=this.lhs.evaluate(i),s=this.rhs.evaluate(i);if(n&&this.hasUntypedArgument){let t=ct(a),r=ct(s);if(t.kind!==r.kind||"string"!==t.kind&&"number"!==t.kind)throw new yt('Expected arguments for "'.concat(e,'" to be (string, string) or (number, number), but found (').concat(t.kind,", ").concat(r.kind,") instead."))}if(this.collator&&!n&&this.hasUntypedArgument){let e=ct(a),r=ct(s);if("string"!==e.kind||"string"!==r.kind)return t(i,a,s)}return this.collator?r(i,a,s,this.collator.evaluate(i)):t(i,a,s)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}},"Comparison"),i}l(qr,"isComparableType"),l(Rr,"eq"),l(jr,"neq"),l(Nr,"lt"),l(Ur,"gt"),l(Zr,"lteq"),l(Gr,"gteq"),l(Xr,"eqCollate"),l(Yr,"neqCollate"),l(Jr,"ltCollate"),l(Hr,"gtCollate"),l(Wr,"lteqCollate"),l(Kr,"gteqCollate"),l($r,"makeComparison");var Qr=$r("==",Rr,Xr),ei=$r("!=",jr,Yr),ti=$r("<",Nr,Jr),ri=$r(">",Ur,Hr),ii=$r("<=",Zr,Wr),ni=$r(">=",Gr,Kr),ai=class e{constructor(e,t,r,i,n){this.type=oe,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=i,this.maxFractionDigits=n}static parse(t,r){if(3!==t.length)return r.error("Expected two arguments.");let i=r.parse(t[1],1,se);if(!i)return null;let n=t[2];if("object"!=typeof n||Array.isArray(n))return r.error("NumberFormat options argument must be an object.");let a=null;if(n.locale&&(a=r.parse(n.locale,1,oe),!a))return null;let s=null;if(n.currency&&(s=r.parse(n.currency,1,oe),!s))return null;let o=null;if(n["min-fraction-digits"]&&(o=r.parse(n["min-fraction-digits"],1,se),!o))return null;let l=null;return n["max-fraction-digits"]&&(l=r.parse(n["max-fraction-digits"],1,se),!l)?null:new e(i,a,s,o,l)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}};l(ai,"NumberFormat");var si=ai,oi=class e{constructor(e){this.type=fe,this.sections=e}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let i=t[1];if(!Array.isArray(i)&&"object"==typeof i)return r.error("First argument must be an image or text section.");let n=[],a=!1;for(let e=1;e<=t.length-1;++e){let i=t[e];if(a&&"object"==typeof i&&!Array.isArray(i)){a=!1;let e=null;if(i["font-scale"]&&(e=r.parse(i["font-scale"],1,se),!e))return null;let t=null;if(i["text-font"]&&(t=r.parse(i["text-font"],1,ge(oe)),!t))return null;let s=null;if(i["text-color"]&&(s=r.parse(i["text-color"],1,ue),!s))return null;let o=n[n.length-1];o.scale=e,o.font=t,o.textColor=s}else{let i=r.parse(t[e],1,he);if(!i)return null;let s=i.type.kind;if("string"!==s&&"value"!==s&&"null"!==s&&"resolvedImage"!==s)return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,n.push({content:i,scale:null,font:null,textColor:null})}}return new e(n)}evaluate(e){let t=l((t=>{let r=t.content.evaluate(e);return ct(r)===ye?new $e("",r,null,null,null):new $e(ht(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}),"evaluateSection");return new et(this.sections.map(t))}eachChild(e){for(let t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}};l(oi,"FormatExpression");var li=oi,ui=class e{constructor(e){this.type=ye,this.input=e}static parse(t,r){if(2!==t.length)return r.error("Expected two arguments.");let i=r.parse(t[1],1,oe);return i?new e(i):r.error("No image name provided.")}evaluate(e){let t=this.input.evaluate(e),r=ot.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}};l(ui,"ImageExpression");var ci=ui,hi=class e{constructor(e){this.type=se,this.input=e}static parse(t,r){if(2!==t.length)return r.error("Expected 1 argument, but found ".concat(t.length-1," instead."));let i=r.parse(t[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?r.error("Expected argument of type string or array, but found ".concat(xe(i.type)," instead.")):new e(i):null}evaluate(e){let t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new yt("Expected value to be of type string or array, but found ".concat(xe(ct(t))," instead."))}eachChild(e){e(this.input)}outputDefined(){return!1}};l(hi,"Length");var pi={"==":Qr,"!=":ei,">":ri,"<":ti,">=":ni,"<=":ii,array:xt,at:zr,boolean:xt,case:Fr,coalesce:kr,collator:zt,format:li,image:ci,in:Cr,"index-of":Vr,interpolate:wr,"interpolate-hcl":wr,"interpolate-lab":wr,length:hi,let:Ir,literal:ft,match:Er,number:xt,"number-format":si,object:xt,slice:Or,step:pr,string:xt,"to-boolean":wt,"to-color":wt,"to-number":wt,"to-string":wt,var:rr,within:er};function fi(e,[t,r,i,n]){t=t.evaluate(e),r=r.evaluate(e),i=i.evaluate(e);let a=n?n.evaluate(e):1,s=lt(t,r,i,a);if(s)throw new yt(s);return new Je(t/255,r/255,i/255,a,!1)}function di(e,t){return e in t}function yi(e,t){let r=t[e];return typeof r>"u"?null:r}function mi(e,t,r,i){for(;r<=i;){let n=r+i>>1;if(t[n]===e)return!0;t[n]>e?i=n-1:r=n+1}return!1}function gi(e){return{type:e}}function xi(e){return{result:"success",value:e}}function vi(e){return{result:"error",value:e}}function bi(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function wi(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function _i(e){return!!e.expression&&e.expression.interpolated}function Si(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function ki(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Ai(e){return e}function Ii(e,t){let r,i,n,a="color"===t.type,s=e.stops&&"object"==typeof e.stops[0][0],o=s||void 0!==e.property,l=s||!o,u=e.type||(_i(t)?"exponential":"interval");if(a||"padding"===t.type){let r=a?Je.parse:rt.parse;(e=ee({},e)).stops&&(e.stops=e.stops.map((e=>[e[0],r(e[1])]))),e.default?e.default=r(e.default):e.default=r(t.default)}if(e.colorSpace&&!fr(e.colorSpace))throw new Error('Unknown color space: "'.concat(e.colorSpace,'"'));if("exponential"===u)r=Ci;else if("interval"===u)r=Pi;else if("categorical"===u){r=zi,i=Object.create(null);for(let t of e.stops)i[t[0]]=t[1];n=typeof e.stops[0][0]}else{if("identity"!==u)throw new Error('Unknown function type "'.concat(u,'"'));r=Bi}if(s){let r={},i=[];for(let t=0;t<e.stops.length;t++){let n=e.stops[t],a=n[0].zoom;void 0===r[a]&&(r[a]={zoom:a,type:e.type,property:e.property,default:e.default,stops:[]},i.push(a)),r[a].stops.push([n[0].value,n[1]])}let n=[];for(let e of i)n.push([r[e].zoom,Ii(r[e],t)]);let a={name:"linear"};return{kind:"composite",interpolationType:a,interpolationFactor:wr.interpolationFactor.bind(void 0,a),zoomStops:n.map((e=>e[0])),evaluate:({zoom:r},i)=>Ci({stops:n,base:e.base},t,r).evaluate(r,i)}}if(l){let a="exponential"===u?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:a,interpolationFactor:wr.interpolationFactor.bind(void 0,a),zoomStops:e.stops.map((e=>e[0])),evaluate:({zoom:a})=>r(e,t,a,i,n)}}return{kind:"source",evaluate(a,s){let o=s&&s.properties?s.properties[e.property]:void 0;return void 0===o?Mi(e.default,t.default):r(e,t,o,i,n)}}}function Mi(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function zi(e,t,r,i,n){return Mi(typeof r===n?i[r]:void 0,e.default,t.default)}function Pi(e,t,r){if("number"!==Si(r))return Mi(e.default,t.default);let i=e.stops.length;if(1===i||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];let n=cr(e.stops.map((e=>e[0])),r);return e.stops[n][1]}function Ci(e,t,r){let i=void 0!==e.base?e.base:1;if("number"!==Si(r))return Mi(e.default,t.default);let n=e.stops.length;if(1===n||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[n-1][0])return e.stops[n-1][1];let a=cr(e.stops.map((e=>e[0])),r),s=Vi(r,i,e.stops[a][0],e.stops[a+1][0]),o=e.stops[a][1],l=e.stops[a+1][1],u=vr[t.type]||Ai;return"function"==typeof o.evaluate?{evaluate(...t){let r=o.evaluate.apply(void 0,t),i=l.evaluate.apply(void 0,t);if(void 0!==r&&void 0!==i)return u(r,i,s,e.colorSpace)}}:u(o,l,s,e.colorSpace)}function Bi(e,t,r){switch(t.type){case"color":r=Je.parse(r);break;case"formatted":r=et.fromString(r.toString());break;case"resolvedImage":r=ot.fromString(r.toString());break;case"padding":r=rt.parse(r);break;default:Si(r)!==t.type&&("enum"!==t.type||!t.values[r])&&(r=void 0)}return Mi(r,e.default,t.default)}function Vi(e,t,r,i){let n=i-r,a=e-r;return 0===n?0:1===t?a/n:(Math.pow(t,a)-1)/(Math.pow(t,n)-1)}l(fi,"rgba"),l(di,"has"),l(yi,"get"),l(mi,"binarySearch"),l(gi,"varargs"),nr.register(pi,{error:[{kind:"error"},[oe],(e,[t])=>{throw new yt(t.evaluate(e))}],typeof:[oe,[he],(e,[t])=>xe(ct(t.evaluate(e)))],"to-rgba":[ge(se,4),[ue],(e,[t])=>{let[r,i,n,a]=t.evaluate(e).rgb;return[255*r,255*i,255*n,a]}],rgb:[ue,[se,se,se],fi],rgba:[ue,[se,se,se,se],fi],has:{type:le,overloads:[[[oe],(e,[t])=>di(t.evaluate(e),e.properties())],[[oe,ce],(e,[t,r])=>di(t.evaluate(e),r.evaluate(e))]]},get:{type:he,overloads:[[[oe],(e,[t])=>yi(t.evaluate(e),e.properties())],[[oe,ce],(e,[t,r])=>yi(t.evaluate(e),r.evaluate(e))]]},"feature-state":[he,[oe],(e,[t])=>yi(t.evaluate(e),e.featureState||{})],properties:[ce,[],e=>e.properties()],"geometry-type":[oe,[],e=>e.geometryType()],id:[he,[],e=>e.id()],zoom:[se,[],e=>e.globals.zoom],"heatmap-density":[se,[],e=>e.globals.heatmapDensity||0],"line-progress":[se,[],e=>e.globals.lineProgress||0],accumulated:[he,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[se,gi(se),(e,t)=>{let r=0;for(let i of t)r+=i.evaluate(e);return r}],"*":[se,gi(se),(e,t)=>{let r=1;for(let i of t)r*=i.evaluate(e);return r}],"-":{type:se,overloads:[[[se,se],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[se],(e,[t])=>-t.evaluate(e)]]},"/":[se,[se,se],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[se,[se,se],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[se,[],()=>Math.LN2],pi:[se,[],()=>Math.PI],e:[se,[],()=>Math.E],"^":[se,[se,se],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[se,[se],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[se,[se],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[se,[se],(e,[t])=>Math.log(t.evaluate(e))],log2:[se,[se],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[se,[se],(e,[t])=>Math.sin(t.evaluate(e))],cos:[se,[se],(e,[t])=>Math.cos(t.evaluate(e))],tan:[se,[se],(e,[t])=>Math.tan(t.evaluate(e))],asin:[se,[se],(e,[t])=>Math.asin(t.evaluate(e))],acos:[se,[se],(e,[t])=>Math.acos(t.evaluate(e))],atan:[se,[se],(e,[t])=>Math.atan(t.evaluate(e))],min:[se,gi(se),(e,t)=>Math.min(...t.map((t=>t.evaluate(e))))],max:[se,gi(se),(e,t)=>Math.max(...t.map((t=>t.evaluate(e))))],abs:[se,[se],(e,[t])=>Math.abs(t.evaluate(e))],round:[se,[se],(e,[t])=>{let r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[se,[se],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[se,[se],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[le,[oe,he],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[le,[he],(e,[t])=>e.id()===t.value],"filter-type-==":[le,[oe],(e,[t])=>e.geometryType()===t.value],"filter-<":[le,[oe,he],(e,[t,r])=>{let i=e.properties()[t.value],n=r.value;return typeof i==typeof n&&i<n}],"filter-id-<":[le,[he],(e,[t])=>{let r=e.id(),i=t.value;return typeof r==typeof i&&r<i}],"filter->":[le,[oe,he],(e,[t,r])=>{let i=e.properties()[t.value],n=r.value;return typeof i==typeof n&&i>n}],"filter-id->":[le,[he],(e,[t])=>{let r=e.id(),i=t.value;return typeof r==typeof i&&r>i}],"filter-<=":[le,[oe,he],(e,[t,r])=>{let i=e.properties()[t.value],n=r.value;return typeof i==typeof n&&i<=n}],"filter-id-<=":[le,[he],(e,[t])=>{let r=e.id(),i=t.value;return typeof r==typeof i&&r<=i}],"filter->=":[le,[oe,he],(e,[t,r])=>{let i=e.properties()[t.value],n=r.value;return typeof i==typeof n&&i>=n}],"filter-id->=":[le,[he],(e,[t])=>{let r=e.id(),i=t.value;return typeof r==typeof i&&r>=i}],"filter-has":[le,[he],(e,[t])=>t.value in e.properties()],"filter-has-id":[le,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[le,[ge(oe)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[le,[ge(he)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[le,[oe,ge(he)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[le,[oe,ge(he)],(e,[t,r])=>mi(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:le,overloads:[[[le,le],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[gi(le),(e,t)=>{for(let r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:le,overloads:[[[le,le],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[gi(le),(e,t)=>{for(let r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[le,[le],(e,[t])=>!t.evaluate(e)],"is-supported-script":[le,[oe],(e,[t])=>{let r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[oe,[oe],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[oe,[oe],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[oe,gi(he),(e,t)=>t.map((t=>ht(t.evaluate(e)))).join("")],"resolved-locale":[oe,[pe],(e,[t])=>t.evaluate(e).resolvedLocale()]}),l(xi,"success"),l(vi,"error"),l(bi,"supportsPropertyExpression"),l(wi,"supportsZoomExpression"),l(_i,"supportsInterpolation"),l(Si,"getType"),l(ki,"isFunction"),l(Ai,"identityFunction"),l(Ii,"createFunction"),l(Mi,"coalesce$1"),l(zi,"evaluateCategoricalFunction"),l(Pi,"evaluateIntervalFunction"),l(Ci,"evaluateExponentialFunction"),l(Bi,"evaluateIdentityFunction"),l(Vi,"interpolationFactor");var Ti=class{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new kt,this._defaultValue=t?Yi(t):null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,r,i,n,a){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=i,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,i,n,a){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=i,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=a||null;try{let e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new yt("Expected value to be one of ".concat(Object.keys(this._enumValues).map((e=>JSON.stringify(e))).join(", "),", but found ").concat(JSON.stringify(e)," instead."));return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,typeof console<"u"&&console.warn(e.message)),this._defaultValue}}};l(Ti,"StyleExpression");var Ei=Ti;function Li(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in pi}function Fi(e,t){let r=new It(pi,sr,[],t?Xi(t):void 0),i=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return i?xi(new Ei(i,t)):vi(r.errors)}l(Li,"isExpression"),l(Fi,"createExpression");var Di=class{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!lr(t.expression)}evaluateWithoutErrorHandling(e,t,r,i,n,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,i,n,a)}evaluate(e,t,r,i,n,a){return this._styleExpression.evaluate(e,t,r,i,n,a)}};l(Di,"ZoomConstantExpression");var Oi=Di,qi=class{constructor(e,t,r,i){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!lr(t.expression),this.interpolationType=i}evaluateWithoutErrorHandling(e,t,r,i,n,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,i,n,a)}evaluate(e,t,r,i,n,a){return this._styleExpression.evaluate(e,t,r,i,n,a)}interpolationFactor(e,t,r){return this.interpolationType?wr.interpolationFactor(this.interpolationType,e,t,r):0}};l(qi,"ZoomDependentExpression");var Ri=qi;function ji(e,t){let r=Fi(e,t);if("error"===r.result)return r;let i=r.value.expression,n=or(i);if(!n&&!bi(t))return vi([new re("","data expressions not supported")]);let a=ur(i,["zoom"]);if(!a&&!wi(t))return vi([new re("","zoom expressions not supported")]);let s=Gi(i);if(!s&&!a)return vi([new re("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(s instanceof re)return vi([s]);if(s instanceof wr&&!_i(t))return vi([new re("",'"interpolate" expressions cannot be used with this property')]);if(!s)return xi(new Oi(n?"constant":"source",r.value));let o=s instanceof wr?s.interpolation:void 0;return xi(new Ri(n?"camera":"composite",r.value,s.labels,o))}l(ji,"createPropertyExpression");var Ni=class e{constructor(e,t){this._parameters=e,this._specification=t,ee(this,Ii(this._parameters,this._specification))}static deserialize(t){return new e(t._parameters,t._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}};l(Ni,"StylePropertyFunction");var Ui=Ni;function Zi(e,t){if(ki(e))return new Ui(e,t);if(Li(e)){let r=ji(e,t);if("error"===r.result)throw new Error(r.value.map((e=>"".concat(e.key,": ").concat(e.message))).join(", "));return r.value}{let r=e;return"color"===t.type&&"string"==typeof e?r=Je.parse(e):"padding"!==t.type||"number"!=typeof e&&!Array.isArray(e)?"variableAnchorOffsetCollection"===t.type&&Array.isArray(e)&&(r=at.parse(e)):r=rt.parse(e),{kind:"constant",evaluate:()=>r}}}function Gi(e){let t=null;if(e instanceof Ir)t=Gi(e.result);else if(e instanceof kr){for(let r of e.args)if(t=Gi(r),t)break}else(e instanceof pr||e instanceof wr)&&e.input instanceof nr&&"zoom"===e.input.name&&(t=e);return t instanceof re||e.eachChild((e=>{let r=Gi(e);r instanceof re?t=r:!t&&r?t=new re("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&r&&t!==r&&(t=new re("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function Xi(e){let t={color:ue,string:oe,number:se,enum:oe,boolean:le,formatted:fe,padding:de,resolvedImage:ye,variableAnchorOffsetCollection:me};return"array"===e.type?ge(t[e.value]||he,e.length):t[e.type]}function Yi(e){return"color"===e.type&&ki(e.default)?new Je(0,0,0,0):"color"===e.type?Je.parse(e.default)||null:"padding"===e.type?rt.parse(e.default)||null:"variableAnchorOffsetCollection"===e.type?at.parse(e.default)||null:void 0===e.default?null:e.default}function Ji(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(let t of e.slice(1))if(!Ji(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}l(Zi,"normalizePropertyExpression"),l(Gi,"findZoomCurve"),l(Xi,"getExpectedType"),l(Yi,"getDefaultValue"),l(Ji,"isExpressionFilter");var Hi={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Wi(e){if(null==e)return{filter:()=>!0,needGeometry:!1};Ji(e)||(e=Qi(e));let t=Fi(e,Hi);if("error"===t.result)throw new Error(t.value.map((e=>"".concat(e.key,": ").concat(e.message))).join(", "));return{filter:(e,r,i)=>t.value.evaluate(e,r,{},i),needGeometry:$i(e)}}function Ki(e,t){return e<t?-1:e>t?1:0}function $i(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(let t=1;t<e.length;t++)if($i(e[t]))return!0;return!1}function Qi(e){if(!e)return!0;let t=e[0];return e.length<=1?"any"!==t:"=="===t?en(e[1],e[2],"=="):"!="===t?an(en(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?en(e[1],e[2],t):"any"===t?tn(e.slice(1)):"all"===t?["all"].concat(e.slice(1).map(Qi)):"none"===t?["all"].concat(e.slice(1).map(Qi).map(an)):"in"===t?rn(e[1],e.slice(2)):"!in"===t?an(rn(e[1],e.slice(2))):"has"===t?nn(e[1]):"!has"===t?an(nn(e[1])):"within"!==t||e}function en(e,t,r){switch(e){case"$type":return["filter-type-".concat(r),t];case"$id":return["filter-id-".concat(r),t];default:return["filter-".concat(r),e,t]}}function tn(e){return["any"].concat(e.map(Qi))}function rn(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((e=>typeof e!=typeof t[0]))?["filter-in-large",e,["literal",t.sort(Ki)]]:["filter-in-small",e,["literal",t]]}}function nn(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function an(e){return["!",e]}function sn(e){let t=typeof e;if("number"===t||"boolean"===t||"string"===t||null==e)return JSON.stringify(e);if(Array.isArray(e)){let t="[";for(let r of e)t+="".concat(sn(r),",");return"".concat(t,"]")}let r=Object.keys(e).sort(),i="{";for(let t=0;t<r.length;t++)i+="".concat(JSON.stringify(r[t]),":").concat(sn(e[r[t]]),",");return"".concat(i,"}")}function on(e){let t="";for(let r of K)t+="/".concat(sn(e[r]));return t}function ln(e,t){let r={};for(let i=0;i<e.length;i++){let n=t&&t[e[i].id]||on(e[i]);t&&(t[e[i].id]=n);let a=r[n];a||(a=r[n]=[]),a.push(e[i])}let i=[];for(let e in r)i.push(r[e]);return i}function un(e){let t=e.key,r=e.value;return r?[new Q(t,r,"constants have been deprecated as of v8")]:[]}function cn(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function hn(e){if(Array.isArray(e))return e.map(hn);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){let t={};for(let r in e)t[r]=hn(e[r]);return t}return cn(e)}function pn(e){let t=e.key,r=e.value,i=e.valueSpec||{},n=e.objectElementValidators||{},a=e.style,s=e.styleSpec,o=e.validateSpec,l=[],u=Si(r);if("object"!==u)return[new Q(t,r,"object expected, ".concat(u," found"))];for(let e in r){let u,c=e.split(".")[0],h=i[c]||i["*"];if(n[c])u=n[c];else if(i[c])u=o;else if(n["*"])u=n["*"];else{if(!i["*"]){l.push(new Q(t,r[e],'unknown property "'.concat(e,'"')));continue}u=o}l=l.concat(u({key:(t&&"".concat(t,"."))+e,value:r[e],valueSpec:h,style:a,styleSpec:s,object:r,objectKey:e,validateSpec:o},r))}for(let e in i)n[e]||i[e].required&&void 0===i[e].default&&void 0===r[e]&&l.push(new Q(t,r,'missing required property "'.concat(e,'"')));return l}function fn(e){let t=e.value,r=e.valueSpec,i=e.validateSpec,n=e.style,a=e.styleSpec,s=e.key,o=e.arrayElementValidator||i;if("array"!==Si(t))return[new Q(s,t,"array expected, ".concat(Si(t)," found"))];if(r.length&&t.length!==r.length)return[new Q(s,t,"array length ".concat(r.length," expected, length ").concat(t.length," found"))];if(r["min-length"]&&t.length<r["min-length"])return[new Q(s,t,"array length at least ".concat(r["min-length"]," expected, length ").concat(t.length," found"))];let l={type:r.value,values:r.values};a.$version<7&&(l.function=r.function),"object"===Si(r.value)&&(l=r.value);let u=[];for(let r=0;r<t.length;r++)u=u.concat(o({array:t,arrayIndex:r,value:t[r],valueSpec:l,validateSpec:e.validateSpec,style:n,styleSpec:a,key:"".concat(s,"[").concat(r,"]")}));return u}function dn(e){let t=e.key,r=e.value,i=e.valueSpec,n=Si(r);return"number"===n&&r!=r&&(n="NaN"),"number"!==n?[new Q(t,r,"number expected, ".concat(n," found"))]:"minimum"in i&&r<i.minimum?[new Q(t,r,"".concat(r," is less than the minimum value ").concat(i.minimum))]:"maximum"in i&&r>i.maximum?[new Q(t,r,"".concat(r," is greater than the maximum value ").concat(i.maximum))]:[]}function yn(e){let t,r,i,n=e.valueSpec,a=cn(e.value.type),s={},o="categorical"!==a&&void 0===e.value.property,l=!o,u="array"===Si(e.value.stops)&&"array"===Si(e.value.stops[0])&&"object"===Si(e.value.stops[0][0]),c=pn({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:h,default:d}});return"identity"===a&&o&&c.push(new Q(e.key,e.value,'missing required property "property"')),"identity"!==a&&!e.value.stops&&c.push(new Q(e.key,e.value,'missing required property "stops"')),"exponential"===a&&e.valueSpec.expression&&!_i(e.valueSpec)&&c.push(new Q(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!bi(e.valueSpec)?c.push(new Q(e.key,e.value,"property functions not supported")):o&&!wi(e.valueSpec)&&c.push(new Q(e.key,e.value,"zoom functions not supported"))),("categorical"===a||u)&&void 0===e.value.property&&c.push(new Q(e.key,e.value,'"property" property is required')),c;function h(e){if("identity"===a)return[new Q(e.key,e.value,'identity function may not have a "stops" property')];let t=[],r=e.value;return t=t.concat(fn({key:e.key,value:r,valueSpec:e.valueSpec,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:p})),"array"===Si(r)&&0===r.length&&t.push(new Q(e.key,r,"array must have at least one stop")),t}function p(e){let t=[],a=e.value,o=e.key;if("array"!==Si(a))return[new Q(o,a,"array expected, ".concat(Si(a)," found"))];if(2!==a.length)return[new Q(o,a,"array length 2 expected, length ".concat(a.length," found"))];if(u){if("object"!==Si(a[0]))return[new Q(o,a,"object expected, ".concat(Si(a[0])," found"))];if(void 0===a[0].zoom)return[new Q(o,a,"object stop key must have zoom")];if(void 0===a[0].value)return[new Q(o,a,"object stop key must have value")];if(i&&i>cn(a[0].zoom))return[new Q(o,a[0].zoom,"stop zoom values must appear in ascending order")];cn(a[0].zoom)!==i&&(i=cn(a[0].zoom),r=void 0,s={}),t=t.concat(pn({key:"".concat(o,"[0]"),value:a[0],valueSpec:{zoom:{}},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:dn,value:f}}))}else t=t.concat(f({key:"".concat(o,"[0]"),value:a[0],valueSpec:{},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec},a));return Li(hn(a[1]))?t.concat([new Q("".concat(o,"[1]"),a[1],"expressions are not allowed in function stops.")]):t.concat(e.validateSpec({key:"".concat(o,"[1]"),value:a[1],valueSpec:n,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec}))}function f(e,i){let o=Si(e.value),l=cn(e.value),u=null!==e.value?e.value:i;if(t){if(o!==t)return[new Q(e.key,u,"".concat(o," stop domain type must match previous stop domain type ").concat(t))]}else t=o;if("number"!==o&&"string"!==o&&"boolean"!==o)return[new Q(e.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==o&&"categorical"!==a){let t="number expected, ".concat(o," found");return bi(n)&&void 0===a&&(t+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Q(e.key,u,t)]}return"categorical"!==a||"number"!==o||isFinite(l)&&Math.floor(l)===l?"categorical"!==a&&"number"===o&&void 0!==r&&l<r?[new Q(e.key,u,"stop domain values must appear in ascending order")]:(r=l,"categorical"===a&&l in s?[new Q(e.key,u,"stop domain values must be unique")]:(s[l]=!0,[])):[new Q(e.key,u,"integer expected, found ".concat(l))]}function d(e){return e.validateSpec({key:e.key,value:e.value,valueSpec:n,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec})}}function mn(e){let t=("property"===e.expressionContext?ji:Fi)(hn(e.value),e.valueSpec);if("error"===t.result)return t.value.map((t=>new Q("".concat(e.key).concat(t.key),e.value,t.message)));let r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new Q(e.key,e.value,'Invalid data expression for "'.concat(e.propertyKey,'". Output values must be contained as literals within the expression.'))];if("property"===e.expressionContext&&"layout"===e.propertyType&&!lr(r))return[new Q(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!lr(r))return[new Q(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!ur(r,["zoom","feature-state"]))return[new Q(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!or(r))return[new Q(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function gn(e){let t=e.value,r=e.key,i=Si(t);return"boolean"!==i?[new Q(r,t,"boolean expected, ".concat(i," found"))]:[]}function xn(e){let t=e.key,r=e.value,i=Si(r);return"string"!==i?[new Q(t,r,"color expected, ".concat(i," found"))]:Je.parse(String(r))?[]:[new Q(t,r,'color expected, "'.concat(r,'" found'))]}function vn(e){let t=e.key,r=e.value,i=e.valueSpec,n=[];return Array.isArray(i.values)?-1===i.values.indexOf(cn(r))&&n.push(new Q(t,r,"expected one of [".concat(i.values.join(", "),"], ").concat(JSON.stringify(r)," found"))):-1===Object.keys(i.values).indexOf(cn(r))&&n.push(new Q(t,r,"expected one of [".concat(Object.keys(i.values).join(", "),"], ").concat(JSON.stringify(r)," found"))),n}function bn(e){return Ji(hn(e.value))?mn(ee({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):wn(e)}function wn(e){let t=e.value,r=e.key;if("array"!==Si(t))return[new Q(r,t,"array expected, ".concat(Si(t)," found"))];let i,n=e.styleSpec,a=[];if(t.length<1)return[new Q(r,t,"filter array must have at least 1 element")];switch(a=a.concat(vn({key:"".concat(r,"[0]"),value:t[0],valueSpec:n.filter_operator,style:e.style,styleSpec:e.styleSpec})),cn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===cn(t[1])&&a.push(new Q(r,t,'"$type" cannot be use with operator "'.concat(t[0],'"')));case"==":case"!=":3!==t.length&&a.push(new Q(r,t,'filter array for operator "'.concat(t[0],'" must have 3 elements')));case"in":case"!in":t.length>=2&&(i=Si(t[1]),"string"!==i&&a.push(new Q("".concat(r,"[1]"),t[1],"string expected, ".concat(i," found"))));for(let s=2;s<t.length;s++)i=Si(t[s]),"$type"===cn(t[1])?a=a.concat(vn({key:"".concat(r,"[").concat(s,"]"),value:t[s],valueSpec:n.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&a.push(new Q("".concat(r,"[").concat(s,"]"),t[s],"string, number, or boolean expected, ".concat(i," found")));break;case"any":case"all":case"none":for(let i=1;i<t.length;i++)a=a.concat(wn({key:"".concat(r,"[").concat(i,"]"),value:t[i],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=Si(t[1]),2!==t.length?a.push(new Q(r,t,'filter array for "'.concat(t[0],'" operator must have 2 elements'))):"string"!==i&&a.push(new Q("".concat(r,"[1]"),t[1],"string expected, ".concat(i," found")));break;case"within":i=Si(t[1]),2!==t.length?a.push(new Q(r,t,'filter array for "'.concat(t[0],'" operator must have 2 elements'))):"object"!==i&&a.push(new Q("".concat(r,"[1]"),t[1],"object expected, ".concat(i," found")))}return a}function _n(e,t){let r=e.key,i=e.validateSpec,n=e.style,a=e.styleSpec,s=e.value,o=e.objectKey,l=a["".concat(t,"_").concat(e.layerType)];if(!l)return[];let u=o.match(/^(.*)-transition$/);if("paint"===t&&u&&l[u[1]]&&l[u[1]].transition)return i({key:r,value:s,valueSpec:a.transition,style:n,styleSpec:a});let c,h=e.valueSpec||l[o];if(!h)return[new Q(r,s,'unknown property "'.concat(o,'"'))];if("string"===Si(s)&&bi(h)&&!h.tokens&&(c=/^{([^}]+)}$/.exec(s)))return[new Q(r,s,'"'.concat(o,'" does not support interpolation syntax\n')+'Use an identity property function instead: `{ "type": "identity", "property": '.concat(JSON.stringify(c[1])," }`."))];let p=[];return"symbol"===e.layerType&&("text-field"===o&&n&&!n.glyphs&&p.push(new Q(r,s,'use of "text-field" requires a style "glyphs" property')),"text-font"===o&&ki(hn(s))&&"identity"===cn(s.type)&&p.push(new Q(r,s,'"text-font" does not support identity functions'))),p.concat(i({key:e.key,value:s,valueSpec:h,style:n,styleSpec:a,expressionContext:"property",propertyType:t,propertyKey:o}))}function Sn(e){return _n(e,"paint")}function kn(e){return _n(e,"layout")}function An(e){let t=[],r=e.value,i=e.key,n=e.style,a=e.styleSpec;!r.type&&!r.ref&&t.push(new Q(i,r,'either "type" or "ref" is required'));let s=cn(r.type),o=cn(r.ref);if(r.id){let a=cn(r.id);for(let s=0;s<e.arrayIndex;s++){let e=n.layers[s];cn(e.id)===a&&t.push(new Q(i,r.id,'duplicate layer id "'.concat(r.id,'", previously used at line ').concat(e.id.__line__)))}}if("ref"in r){let e;["type","source","source-layer","filter","layout"].forEach((e=>{e in r&&t.push(new Q(i,r[e],'"'.concat(e,'" is prohibited for ref layers')))})),n.layers.forEach((t=>{cn(t.id)===o&&(e=t)})),e?e.ref?t.push(new Q(i,r.ref,"ref cannot reference another ref layer")):s=cn(e.type):t.push(new Q(i,r.ref,'ref layer "'.concat(o,'" not found')))}else if("background"!==s)if(r.source){let e=n.sources&&n.sources[r.source],a=e&&cn(e.type);e?"vector"===a&&"raster"===s?t.push(new Q(i,r.source,'layer "'.concat(r.id,'" requires a raster source'))):"raster"===a&&"raster"!==s?t.push(new Q(i,r.source,'layer "'.concat(r.id,'" requires a vector source'))):"vector"!==a||r["source-layer"]?"raster-dem"===a&&"hillshade"!==s?t.push(new Q(i,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"===s&&r.paint&&r.paint["line-gradient"]&&("geojson"!==a||!e.lineMetrics)&&t.push(new Q(i,r,'layer "'.concat(r.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):t.push(new Q(i,r,'layer "'.concat(r.id,'" must specify a "source-layer"'))):t.push(new Q(i,r.source,'source "'.concat(r.source,'" not found')))}else t.push(new Q(i,r,'missing required property "source"'));return t=t.concat(pn({key:i,value:r,valueSpec:a.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":()=>[],type:()=>e.validateSpec({key:"".concat(i,".type"),value:r.type,valueSpec:a.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:r,objectKey:"type"}),filter:bn,layout:e=>pn({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>kn(ee({layerType:s},e))}}),paint:e=>pn({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>Sn(ee({layerType:s},e))}})}})),t}function In(e){let t=e.value,r=e.key,i=Si(t);return"string"!==i?[new Q(r,t,"string expected, ".concat(i," found"))]:[]}l(Wi,"createFilter"),l(Ki,"compare"),l($i,"geometryNeeded"),l(Qi,"convertFilter$1"),l(en,"convertComparisonOp$1"),l(tn,"convertDisjunctionOp"),l(rn,"convertInOp$1"),l(nn,"convertHasOp$1"),l(an,"convertNegation"),l(sn,"stringify"),l(on,"getKey"),l(ln,"groupByLayout"),l(un,"validateConstants"),l(cn,"unbundle"),l(hn,"deepUnbundle"),l(pn,"validateObject"),l(fn,"validateArray"),l(dn,"validateNumber"),l(yn,"validateFunction"),l(mn,"validateExpression"),l(gn,"validateBoolean"),l(xn,"validateColor"),l(vn,"validateEnum"),l(bn,"validateFilter"),l(wn,"validateNonExpressionFilter"),l(_n,"validateProperty"),l(Sn,"validatePaintProperty"),l(kn,"validateLayoutProperty"),l(An,"validateLayer"),l(In,"validateString");var Mn={promoteId:Pn};function zn(e){let t=e.value,r=e.key,i=e.styleSpec,n=e.style,a=e.validateSpec;if(!t.type)return[new Q(r,t,'"type" is required')];let s,o=cn(t.type);switch(o){case"vector":case"raster":case"raster-dem":return s=pn({key:r,value:t,valueSpec:i["source_".concat(o.replace("-","_"))],style:e.style,styleSpec:i,objectElementValidators:Mn,validateSpec:a}),s;case"geojson":if(s=pn({key:r,value:t,valueSpec:i.source_geojson,style:n,styleSpec:i,validateSpec:a,objectElementValidators:Mn}),t.cluster)for(let e in t.clusterProperties){let[i,n]=t.clusterProperties[e],o="string"==typeof i?[i,["accumulated"],["get",e]]:i;s.push(...mn({key:"".concat(r,".").concat(e,".map"),value:n,validateSpec:a,expressionContext:"cluster-map"})),s.push(...mn({key:"".concat(r,".").concat(e,".reduce"),value:o,validateSpec:a,expressionContext:"cluster-reduce"}))}return s;case"video":return pn({key:r,value:t,valueSpec:i.source_video,style:n,validateSpec:a,styleSpec:i});case"image":return pn({key:r,value:t,valueSpec:i.source_image,style:n,validateSpec:a,styleSpec:i});case"canvas":return[new Q(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vn({key:"".concat(r,".type"),value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,validateSpec:a,styleSpec:i})}}function Pn({key:e,value:t}){if("string"===Si(t))return In({key:e,value:t});{let r=[];for(let i in t)r.push(...In({key:"".concat(e,".").concat(i),value:t[i]}));return r}}function Cn(e){let t=e.value,r=e.styleSpec,i=r.light,n=e.style,a=[],s=Si(t);if(void 0===t)return a;if("object"!==s)return a=a.concat([new Q("light",t,"object expected, ".concat(s," found"))]),a;for(let s in t){let o=s.match(/^(.*)-transition$/);a=o&&i[o[1]]&&i[o[1]].transition?a.concat(e.validateSpec({key:s,value:t[s],valueSpec:r.transition,validateSpec:e.validateSpec,style:n,styleSpec:r})):i[s]?a.concat(e.validateSpec({key:s,value:t[s],valueSpec:i[s],validateSpec:e.validateSpec,style:n,styleSpec:r})):a.concat([new Q(s,t[s],'unknown property "'.concat(s,'"'))])}return a}function Bn(e){let t=e.value,r=e.styleSpec,i=r.terrain,n=e.style,a=[],s=Si(t);if(void 0===t)return a;if("object"!==s)return a=a.concat([new Q("terrain",t,"object expected, ".concat(s," found"))]),a;for(let s in t)a=i[s]?a.concat(e.validateSpec({key:s,value:t[s],valueSpec:i[s],validateSpec:e.validateSpec,style:n,styleSpec:r})):a.concat([new Q(s,t[s],'unknown property "'.concat(s,'"'))]);return a}function Vn(e){return 0===In(e).length?[]:mn(e)}function Tn(e){return 0===In(e).length?[]:mn(e)}function En(e){let t=e.key,r=e.value;if("array"===Si(r)){if(r.length<1||r.length>4)return[new Q(t,r,"padding requires 1 to 4 values; ".concat(r.length," values found"))];let i={type:"number"},n=[];for(let a=0;a<r.length;a++)n=n.concat(e.validateSpec({key:"".concat(t,"[").concat(a,"]"),value:r[a],validateSpec:e.validateSpec,valueSpec:i}));return n}return dn({key:t,value:r,valueSpec:{}})}function Ln(e){let t=e.key,r=e.value,i=Si(r),n=e.styleSpec;if("array"!==i||r.length<1||r.length%2!=0)return[new Q(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let i=0;i<r.length;i+=2)a=a.concat(vn({key:"".concat(t,"[").concat(i,"]"),value:r[i],valueSpec:n.layout_symbol["text-anchor"]})),a=a.concat(fn({key:"".concat(t,"[").concat(i+1,"]"),value:r[i+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:n}));return a}function Fn(e){let t=[],r=e.value,i=e.key;if(Array.isArray(r)){let n=[],a=[];for(let s in r){r[s].id&&n.includes(r[s].id)&&t.push(new Q(i,r,"all the sprites' ids must be unique, but ".concat(r[s].id," is duplicated"))),n.push(r[s].id),r[s].url&&a.includes(r[s].url)&&t.push(new Q(i,r,"all the sprites' URLs must be unique, but ".concat(r[s].url," is duplicated"))),a.push(r[s].url);let o={id:{type:"string",required:!0},url:{type:"string",required:!0}};t=t.concat(pn({key:"".concat(i,"[").concat(s,"]"),value:r[s],valueSpec:o,validateSpec:e.validateSpec}))}return t}return In({key:i,value:r})}l(zn,"validateSource"),l(Pn,"validatePromoteId"),l(Cn,"validateLight"),l(Bn,"validateTerrain"),l(Vn,"validateFormatted"),l(Tn,"validateImage"),l(En,"validatePadding"),l(Ln,"validateVariableAnchorOffsetCollection"),l(Fn,"validateSprite");var Dn={"*":()=>[],array:fn,boolean:gn,number:dn,color:xn,constants:un,enum:vn,filter:bn,function:yn,layer:An,object:pn,source:zn,light:Cn,terrain:Bn,string:In,formatted:Vn,resolvedImage:Tn,padding:En,variableAnchorOffsetCollection:Ln,sprite:Fn};function On(e){let t=e.value,r=e.valueSpec,i=e.styleSpec;return e.validateSpec=On,r.expression&&ki(cn(t))?yn(e):r.expression&&Li(hn(t))?mn(e):r.type&&Dn[r.type]?Dn[r.type](e):pn(ee({},e,{valueSpec:r.type?i[r.type]:r}))}function qn(e){let t=e.value,r=e.key,i=In(e);return i.length||(-1===t.indexOf("{fontstack}")&&i.push(new Q(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&i.push(new Q(r,t,'"glyphs" url must include a "{range}" token'))),i}function Rn(e,t=W){let r=[];return r=r.concat(On({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:On,objectElementValidators:{glyphs:qn,"*":()=>[]}})),e.constants&&(r=r.concat(un({key:"constants",value:e.constants,style:e,styleSpec:t,validateSpec:On}))),Nn(r)}function jn(e){return function(t){return e({...t,validateSpec:On})}}function Nn(e){return[].concat(e).sort(((e,t)=>e.line-t.line))}function Un(e){return function(...t){return Nn(e.apply(this,t))}}l(On,"validate"),l(qn,"validateGlyphsUrl"),l(Rn,"validateStyleMin"),Rn.source=Un(jn(zn)),Rn.sprite=Un(jn(Fn)),Rn.glyphs=Un(jn(qn)),Rn.light=Un(jn(Cn)),Rn.terrain=Un(jn(Bn)),Rn.layer=Un(jn(An)),Rn.filter=Un(jn(bn)),Rn.paintProperty=Un(jn(Sn)),Rn.layoutProperty=Un(jn(kn)),l(jn,"injectValidateSpec"),l(Nn,"sortErrors"),l(Un,"wrapCleanErrors"),p(),p();var Zn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""},Gn=class extends Error{constructor(e,t,r,i){super("AJAXError: ".concat(t," (").concat(e,"): ").concat(r)),this.status=e,this.statusText=t,this.url=r,this.body=i}};l(Gn,"AJAXError");var Xn=Gn,Yn=U()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href,Jn=l((e=>Zn.REGISTERED_PROTOCOLS[e.substring(0,e.indexOf("://"))]),"getProtocolAction"),Hn=l((e=>/^file:/.test(e)||/^file:/.test(Yn())&&!/^\w+:/.test(e)),"isFileURL");function Wn(e,t){let r=new AbortController,i=new Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:Yn(),signal:r.signal}),n=!1,a=!1;"json"===e.type&&i.headers.set("Accept","application/json");let s=l(((r,n,s)=>{if(!a){if(r&&"SecurityError"!==r.message&&R(r),n&&s)return o(n);fetch(i).then((r=>r.ok?o(r):r.blob().then((i=>t(new Xn(r.status,r.statusText,e.url,i)))))).catch((e=>{20!==e.code&&t(new Error(e.message))}))}}),"validateOrFetch"),o=l((r=>{("arrayBuffer"===e.type||"image"===e.type?r.arrayBuffer():"json"===e.type?r.json():r.text()).then((e=>{a||(n=!0,t(null,e,r.headers.get("Cache-Control"),r.headers.get("Expires")))})).catch((e=>{a||t(new Error(e.message))}))}),"finishRequest");return s(null,null),{cancel:()=>{a=!0,n||r.abort()}}}function Kn(e,t){let r=new XMLHttpRequest;r.open(e.method||"GET",e.url,!0),("arrayBuffer"===e.type||"image"===e.type)&&(r.responseType="arraybuffer");for(let t in e.headers)r.setRequestHeader(t,e.headers[t]);return"json"===e.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===e.credentials,r.onerror=()=>{t(new Error(r.statusText))},r.onload=()=>{if((r.status>=200&&r.status<300||0===r.status)&&null!==r.response){let i=r.response;if("json"===e.type)try{i=JSON.parse(r.response)}catch(e){return t(e)}t(null,i,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else{let i=new Blob([r.response],{type:r.getResponseHeader("Content-Type")});t(new Xn(r.status,r.statusText,e.url,i))}},r.send(e.body),{cancel:()=>r.abort()}}l(Wn,"makeFetchRequest"),l(Kn,"makeXMLHttpRequest");var $n=l((function(e,t){if(/:\/\//.test(e.url)&&!/^https?:|^file:/.test(e.url)){if(U()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t);if(!U())return(Jn(e.url)||Wn)(e,t)}if(!Hn(e.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Wn(e,t);if(U()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}return Kn(e,t)}),"makeRequest"),Qn=l((function(e,t){return $n(T(e,{type:"json"}),t)}),"getJSON"),ea=l((function(e,t){return $n(T(e,{type:"arrayBuffer"}),t)}),"getArrayBuffer"),ta={};function ra(e,t,r={}){if(ta[e])throw new Error("".concat(e," is already registered."));Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),ta[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}l(ra,"register"),ra("Object",Object),ra("TransferableGridIndex",J),ra("Color",Je),ra("Error",Error),ra("AJAXError",Xn),ra("ResolvedImage",ot),ra("StylePropertyFunction",Ui),ra("StyleExpression",Ei,{omit:["_evaluator"]}),ra("ZoomDependentExpression",Ri),ra("ZoomConstantExpression",Oi),ra("CompoundExpression",nr,{omit:["_evaluate"]});for(let e in pi)pi[e]._classRegistryKey||ra("Expression_".concat(e),pi[e]);function ia(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function na(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob)return e;if(ia(e)||X(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){let r=e;return t&&t.push(r.buffer),r}if(e instanceof ImageData)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){let r=[];for(let i of e)r.push(na(i,t));return r}if("object"==typeof e){let r=e.constructor,i=r._classRegistryKey;if(!i)throw new Error("can't serialize object of unregistered class");if(!ta[i])throw new Error("".concat(i," is not registered."));let n=r.serialize?r.serialize(e,t):{};if(r.serialize){if(t&&n===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let r in e){if(!e.hasOwnProperty(r)||ta[i].omit.indexOf(r)>=0)continue;let a=e[r];n[r]=ta[i].shallow.indexOf(r)>=0?a:na(a,t)}e instanceof Error&&(n.message=e.message)}if(n.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==i&&(n.$name=i),n}throw new Error("can't serialize object of type ".concat(typeof e))}function aa(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||ia(e)||X(e)||ArrayBuffer.isView(e)||e instanceof ImageData)return e;if(Array.isArray(e))return e.map(aa);if("object"==typeof e){let t=e.$name||"Object";if(!ta[t])throw new Error("can't deserialize unregistered class ".concat(t));let{klass:r}=ta[t];if(!r)throw new Error("can't deserialize unregistered class ".concat(t));if(r.deserialize)return r.deserialize(e);let i=Object.create(r.prototype);for(let r of Object.keys(e)){if("$name"===r)continue;let n=e[r];i[r]=ta[t].shallow.indexOf(r)>=0?n:aa(n)}return i}throw new Error("can't deserialize object of type ".concat(typeof e))}l(ia,"isArrayBuffer"),l(na,"serialize"),l(aa,"deserialize"),p();var sa=class{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){delete this._channel,this._callback=()=>{}}};l(sa,"ThrottledInvoker");var oa=sa,la=class{constructor(e,t,r){this.receive=l((e=>{let t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){delete this.tasks[r];let e=this.cancelCallbacks[r];delete this.cancelCallbacks[r],e&&e()}else U()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)}),"receive"),this.process=l((()=>{if(!this.taskQueue.length)return;let e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}),"process"),this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new oa(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=U()?e:window}send(e,t,r,i,n=!1){let a=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[a]=r);let s=G(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:e,hasCallback:!!r,targetMapId:i,mustQueue:n,sourceMapId:this.mapId,data:na(t,s)},s),{cancel:()=>{r&&delete this.callbacks[a],this.target.postMessage({id:a,type:"<cancel>",targetMapId:i,sourceMapId:this.mapId})}}}processTask(e,t){if("<response>"===t.type){let r=this.callbacks[e];delete this.callbacks[e],r&&(t.error?r(aa(t.error)):r(null,aa(t.data)))}else{let r=!1,i=G(this.globalScope)?void 0:[],n=t.hasCallback?(t,n)=>{r=!0,delete this.cancelCallbacks[e],this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:t?na(t):null,data:na(n,i)},i)}:e=>{r=!0},a=null,s=aa(t.data);if(this.parent[t.type])a=this.parent[t.type](t.sourceMapId,s,n);else if(this.parent.getWorkerSource){let e=t.type.split(".");a=this.parent.getWorkerSource(t.sourceMapId,e[0],s.source)[e[1]](s,n)}else n(new Error("Could not find function ".concat(t.type)));!r&&a&&a.cancel&&(this.cancelCallbacks[e]=a.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}};l(la,"Actor");var ua=la;function ca(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function ha(e,t,r){if(r&&r[e]){let i=r[e].indexOf(t);-1!==i&&r[e].splice(i,1)}}p(),p(),p(),p(),p(),p(),l(ca,"_addEventListener"),l(ha,"_removeEventListener");var pa=class{constructor(e,t={}){T(this,t),this.type=e}};l(pa,"Event");var fa=pa,da=class extends fa{constructor(e,t={}){super("error",T({error:e},t))}};l(da,"ErrorEvent");var ya=da,ma=class{on(e,t){return this._listeners=this._listeners||{},ca(e,t,this._listeners),this}off(e,t){return ha(e,t,this._listeners),ha(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},ca(e,t,this._oneTimeListeners),this):new Promise((t=>this.once(e,t)))}fire(e,t){"string"==typeof e&&(e=new fa(e,t||{}));let r=e.type;if(this.listens(r)){e.target=this;let t=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];for(let r of t)r.call(this,e);let i=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];for(let t of i)ha(r,t,this._oneTimeListeners),t.call(this,e);let n=this._eventedParent;n&&(T(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),n.fire(e))}else e instanceof ya&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}};l(ma,"Evented");var ga=ma,xa=Rn,va=(xa.source,xa.light,xa.terrain,xa.filter,xa.paintProperty),ba=xa.layoutProperty;function wa(e,t){let r=!1;if(t&&t.length)for(let i of t)e.fire(new ya(new Error(i.message))),r=!0;return r}l(wa,"emitValidationErrors"),p(),p(),p();var _a=class{constructor(){this.first=!0}update(e,t){let r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))}};l(_a,"ZoomHistory");var Sa=_a;p(),p();var ka=e=>e>=128&&e<=255,Aa=e=>e>=1536&&e<=1791,Ia=e=>e>=1872&&e<=1919,Ma=e=>e>=2208&&e<=2303,za=e=>e>=4352&&e<=4607,Pa=e=>e>=5120&&e<=5759,Ca=e=>e>=6016&&e<=6143,Ba=e=>e>=6320&&e<=6399,Va=e=>e>=8192&&e<=8303,Ta=e=>e>=8448&&e<=8527,Ea=e=>e>=8528&&e<=8591,La=e=>e>=8960&&e<=9215,Fa=e=>e>=9216&&e<=9279,Da=e=>e>=9280&&e<=9311,Oa=e=>e>=9312&&e<=9471,qa=e=>e>=9632&&e<=9727,Ra=e=>e>=9728&&e<=9983,ja=e=>e>=11008&&e<=11263,Na=e=>e>=11904&&e<=12031,Ua=e=>e>=12032&&e<=12255,Za=e=>e>=12272&&e<=12287,Ga=e=>e>=12288&&e<=12351,Xa=e=>e>=12352&&e<=12447,Ya=e=>e>=12448&&e<=12543,Ja=e=>e>=12544&&e<=12591,Ha=e=>e>=12592&&e<=12687,Wa=e=>e>=12688&&e<=12703,Ka=e=>e>=12704&&e<=12735,$a=e=>e>=12736&&e<=12783,Qa=e=>e>=12784&&e<=12799,es=e=>e>=12800&&e<=13055,ts=e=>e>=13056&&e<=13311,rs=e=>e>=13312&&e<=19903,is=e=>e>=19904&&e<=19967,ns=e=>e>=19968&&e<=40959,as=e=>e>=40960&&e<=42127,ss=e=>e>=42128&&e<=42191,os=e=>e>=43360&&e<=43391,ls=e=>e>=44032&&e<=55215,us=e=>e>=55216&&e<=55295,cs=e=>e>=57344&&e<=63743,hs=e=>e>=63744&&e<=64255,ps=e=>e>=64336&&e<=65023,fs=e=>e>=65040&&e<=65055,ds=e=>e>=65072&&e<=65103,ys=e=>e>=65104&&e<=65135,ms=e=>e>=65136&&e<=65279,gs=e=>e>=65280&&e<=65519;function xs(e){for(let t of e)if(_s(t.charCodeAt(0)))return!0;return!1}function vs(e){for(let t of e)if(!bs(t.charCodeAt(0)))return!1;return!0}function bs(e){return!(Aa(e)||Ia(e)||Ma(e)||ps(e)||ms(e))}function ws(e){return!(e<11904)&&!!(Ka(e)||Ja(e)||ds(e)||hs(e)||ts(e)||Na(e)||$a(e)||Ga(e)||rs(e)||ns(e)||es(e)||gs(e)||Xa(e)||Za(e)||Ua(e)||Qa(e)||Ya(e)||fs(e)||ss(e)||as(e))}function _s(e){return 746===e||747===e||!(e<4352)&&!(!(Ka(e)||Ja(e)||ds(e)&&!(e>=65097&&e<=65103)||hs(e)||ts(e)||Na(e)||$a(e)||Ga(e)&&!(e>=12296&&e<=12305)&&!(e>=12308&&e<=12319)&&12336!==e||rs(e)||ns(e)||es(e)||Ha(e)||os(e)||us(e)||za(e)||ls(e)||Xa(e)||Za(e)||Wa(e)||Ua(e)||Qa(e)||Ya(e)&&12540!==e)&&(!gs(e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)&&(!ys(e)||e>=65112&&e<=65118||e>=65123&&e<=65126)&&!Pa(e)&&!Ba(e)&&!fs(e)&&!is(e)&&!as(e)&&!ss(e))}function Ss(e){return!!(ka(e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||Va(e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||Ta(e)||Ea(e)||La(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||Fa(e)&&9251!==e||Da(e)||Oa(e)||qa(e)||Ra(e)&&!(e>=9754&&e<=9759)||ja(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ga(e)||Ya(e)||cs(e)||ds(e)||ys(e)||gs(e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}function ks(e){return!(_s(e)||Ss(e))}function As(e){return Aa(e)||Ia(e)||Ma(e)||ps(e)||ms(e)}function Is(e){return e>=1424&&e<=2303||ps(e)||ms(e)}function Ms(e,t){return!(!t&&Is(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Ca(e))}function zs(e){for(let t of e)if(Is(t.charCodeAt(0)))return!0;return!1}function Ps(e,t){for(let r of e)if(!Ms(r.charCodeAt(0),t))return!1;return!0}l(xs,"allowsVerticalWritingMode"),l(vs,"allowsLetterSpacing"),l(bs,"charAllowsLetterSpacing"),l(ws,"charAllowsIdeographicBreaking"),l(_s,"charHasUprightVerticalOrientation"),l(Ss,"charHasNeutralVerticalOrientation"),l(ks,"charHasRotatedVerticalOrientation"),l(As,"charInComplexShapingScript"),l(Is,"charInRTLScript"),l(Ms,"charInSupportedScript"),l(zs,"stringContainsRTLText"),l(Ps,"isStringInSupportedScript"),p(),p();typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),typeof navigator<"u"&&navigator.hardwareConcurrency;var Cs="loading",Bs="loaded",Vs="unavailable",Ts=null,Es=(new ga,l((function(){return Vs}),"getRTLTextPluginStatus")),Ls={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Vs===Bs||null!=Ls.applyArabicShaping,isLoading:()=>Vs===Cs,setState(e){if(!U())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Vs=e.pluginStatus,Ts=e.pluginURL},isParsed(){if(!U())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return null!=Ls.applyArabicShaping&&null!=Ls.processBidirectionalText&&null!=Ls.processStyledBidirectionalText},getPluginURL(){if(!U())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Ts}},Fs=class{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Sa,this.transition={})}isSupportedScript(e){return Ps(e,Ls.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}}};l(Fs,"EvaluationParameters");var Ds=Fs,Os=class{constructor(e,t){this.property=e,this.value=t,this.expression=Zi(void 0===t?e.specification.default:t,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)}};l(Os,"PropertyValue");var qs=Os,Rs=class{constructor(e){this.property=e,this.value=new qs(e,void 0)}transitioned(e,t){return new Gs(this.property,this.value,t,T({},e.transition,this.transition),e.now)}untransitioned(){return new Gs(this.property,this.value,null,{},0)}};l(Rs,"TransitionablePropertyValue");var js=Rs,Ns=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return D(this._values[e].value.value)}setValue(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new js(this._values[e].property)),this._values[e].value=new qs(this._values[e].property,null===t?void 0:D(t))}getTransition(e){return D(this._values[e].transition)}setTransition(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new js(this._values[e].property)),this._values[e].transition=D(t)||void 0}serialize(){let e={};for(let t of Object.keys(this._values)){let r=this.getValue(t);void 0!==r&&(e[t]=r);let i=this.getTransition(t);void 0!==i&&(e["".concat(t,"-transition")]=i)}return e}transitioned(e,t){let r=new Ys(this._properties);for(let i of Object.keys(this._values))r._values[i]=this._values[i].transitioned(e,t._values[i]);return r}untransitioned(){let e=new Ys(this._properties);for(let t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}};l(Ns,"Transitionable");var Us=Ns,Zs=class{constructor(e,t,r,i,n){this.property=e,this.value=t,this.begin=n+i.delay||0,this.end=this.begin+i.duration||0,e.specification.transition&&(i.delay||i.duration)&&(this.prior=r)}possiblyEvaluate(e,t,r){let i=e.now||0,n=this.value.possiblyEvaluate(e,t,r),a=this.prior;if(a){if(i>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(i<this.begin)return a.possiblyEvaluate(e,t,r);{let s=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(e,t,r),n,P(s))}}return n}};l(Zs,"TransitioningPropertyValue");var Gs=Zs,Xs=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,r){let i=new Qs(this._properties);for(let n of Object.keys(this._values))i._values[n]=this._values[n].possiblyEvaluate(e,t,r);return i}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}};l(Xs,"Transitioning");var Ys=Xs,Js=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return D(this._values[e].value)}setValue(e,t){this._values[e]=new qs(this._values[e].property,null===t?void 0:D(t))}serialize(){let e={};for(let t of Object.keys(this._values)){let r=this.getValue(t);void 0!==r&&(e[t]=r)}return e}possiblyEvaluate(e,t,r){let i=new Qs(this._properties);for(let n of Object.keys(this._values))i._values[n]=this._values[n].possiblyEvaluate(e,t,r);return i}};l(Js,"Layout");var Hs=Js,Ws=class{constructor(e,t,r){this.property=e,this.value=t,this.parameters=r}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,r,i){return this.property.evaluate(this.value,this.parameters,e,t,r,i)}};l(Ws,"PossiblyEvaluatedPropertyValue");var Ks=Ws,$s=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}};l($s,"PossiblyEvaluated");var Qs=$s,eo=class{constructor(e){this.specification=e}possiblyEvaluate(e,t){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(t)}interpolate(e,t,r){let i=this.specification.type,n=vr[i];return n?n(e,t,r):e}};l(eo,"DataConstantProperty");var to=eo,ro=class{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,r,i){return"constant"===e.expression.kind||"camera"===e.expression.kind?new Ks(this,{kind:"constant",value:e.expression.evaluate(t,null,{},r,i)},t):new Ks(this,e.expression,t)}interpolate(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new Ks(this,{kind:"constant",value:void 0},e.parameters);let i=this.specification.type,n=vr[i];if(n){let i=n(e.value.value,t.value.value,r);return new Ks(this,{kind:"constant",value:i},e.parameters)}return e}evaluate(e,t,r,i,n,a){return"constant"===e.kind?e.value:e.evaluate(t,r,i,n,a)}};l(ro,"DataDrivenProperty");var io=ro,no=class extends io{possiblyEvaluate(e,t,r,i){if(void 0===e.value)return new Ks(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){let n=e.expression.evaluate(t,null,{},r,i),a="resolvedImage"===e.property.specification.type&&"string"!=typeof n?n.name:n,s=this._calculate(a,a,a,t);return new Ks(this,{kind:"constant",value:s},t)}if("camera"===e.expression.kind){let r=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new Ks(this,{kind:"constant",value:r},t)}return new Ks(this,e.expression,t)}evaluate(e,t,r,i,n,a){if("source"===e.kind){let s=e.evaluate(t,r,i,n,a);return this._calculate(s,s,s,t)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},r,i),e.evaluate({zoom:Math.floor(t.zoom)},r,i),e.evaluate({zoom:Math.floor(t.zoom)+1},r,i),t):e.value}_calculate(e,t,r,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}};l(no,"CrossFadedDataDrivenProperty");var ao=no,so=class{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,i){if(void 0!==e.value){if("constant"===e.expression.kind){let n=e.expression.evaluate(t,null,{},r,i);return this._calculate(n,n,n,t)}return this._calculate(e.expression.evaluate(new Ds(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Ds(Math.floor(t.zoom),t)),e.expression.evaluate(new Ds(Math.floor(t.zoom+1),t)),t)}}_calculate(e,t,r,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}};l(so,"CrossFadedProperty");var oo=so,lo=class{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,i){return!!e.expression.evaluate(t,null,{},r,i)}interpolate(){return!1}};l(lo,"ColorRampProperty");var uo=lo,co=class{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let t in e){let r=e[t];r.specification.overridable&&this.overridableProperties.push(t);let i=this.defaultPropertyValues[t]=new qs(r,void 0),n=this.defaultTransitionablePropertyValues[t]=new js(r);this.defaultTransitioningPropertyValues[t]=n.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=i.possiblyEvaluate({})}}};l(co,"Properties");var ho=co;ra("DataDrivenProperty",io),ra("DataConstantProperty",to),ra("CrossFadedDataDrivenProperty",ao),ra("CrossFadedProperty",oo),ra("ColorRampProperty",uo);var po="-transition",fo=class extends ga{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new Hs(t.layout)),t.paint)){this._transitionablePaint=new Us(t.paint);for(let t in e.paint)this.setPaintProperty(t,e.paint[t],{validate:!1});for(let t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Qs(t.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t,r={}){if(null!=t){let i="layers.".concat(this.id,".layout.").concat(e);if(this._validate(ba,i,e,t,r))return}"visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t}getPaintProperty(e){return e.endsWith(po)?this._transitionablePaint.getTransition(e.slice(0,-po.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t,r={}){if(null!=t){let i="layers.".concat(this.id,".paint.").concat(e);if(this._validate(va,i,e,t,r))return!1}if(e.endsWith(po))return this._transitionablePaint.setTransition(e.slice(0,-po.length),t||void 0),!1;{let r=this._transitionablePaint._values[e],i="cross-faded-data-driven"===r.property.specification["property-type"],n=r.value.isDataDriven(),a=r.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);let s=this._transitionablePaint._values[e].value;return s.isDataDriven()||n||i||this._handleOverridablePaintPropertyUpdate(e,a,s)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,t,r){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom||this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){let e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),F(e,((e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)))}_validate(e,t,r,i,n={}){return(!n||!1!==n.validate)&&wa(this,e.call(xa,{key:t,layerType:this.type,objectKey:r,value:i,styleSpec:W,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let e in this.paint._values){let t=this.paint.get(e);if(t instanceof Ks&&bi(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}};l(fo,"StyleLayer");var yo=fo;p(),p(),p();var mo={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},go=class{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}};l(go,"Struct");var xo=go,vo=class{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}};l(vo,"StructArray");var bo=vo;function wo(e,t=1){let r=0,i=0;return{members:e.map((e=>{let n=_o(e.type),a=r=So(r,Math.max(t,n)),s=e.components||1;return i=Math.max(i,n),r+=n*s,{name:e.name,type:e.type,components:s,offset:a}})),size:So(r,Math.max(i,t)),alignment:t}}function _o(e){return mo[e].BYTES_PER_ELEMENT}function So(e,t){return Math.ceil(e/t)*t}l(wo,"createLayout"),l(_o,"sizeOf"),l(So,"align");var ko=h(f(),1),Ao=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){let r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){let i=2*e;return this.int16[i+0]=t,this.int16[i+1]=r,e}};l(Ao,"StructArrayLayout2i4");var Io=Ao;Io.prototype.bytesPerElement=4,ra("StructArrayLayout2i4",Io);var Mo=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,t,r)}emplace(e,t,r,i){let n=3*e;return this.int16[n+0]=t,this.int16[n+1]=r,this.int16[n+2]=i,e}};l(Mo,"StructArrayLayout3i6");var zo=Mo;zo.prototype.bytesPerElement=6,ra("StructArrayLayout3i6",zo);var Po=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,i){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r,i)}emplace(e,t,r,i,n){let a=4*e;return this.int16[a+0]=t,this.int16[a+1]=r,this.int16[a+2]=i,this.int16[a+3]=n,e}};l(Po,"StructArrayLayout4i8");var Co=Po;Co.prototype.bytesPerElement=8,ra("StructArrayLayout4i8",Co);var Bo=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,n,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,i,n,a)}emplace(e,t,r,i,n,a,s){let o=6*e;return this.int16[o+0]=t,this.int16[o+1]=r,this.int16[o+2]=i,this.int16[o+3]=n,this.int16[o+4]=a,this.int16[o+5]=s,e}};l(Bo,"StructArrayLayout2i4i12");var Vo=Bo;Vo.prototype.bytesPerElement=12,ra("StructArrayLayout2i4i12",Vo);var To=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,n,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,i,n,a)}emplace(e,t,r,i,n,a,s){let o=4*e,l=8*e;return this.int16[o+0]=t,this.int16[o+1]=r,this.uint8[l+4]=i,this.uint8[l+5]=n,this.uint8[l+6]=a,this.uint8[l+7]=s,e}};l(To,"StructArrayLayout2i4ub8");var Eo=To;Eo.prototype.bytesPerElement=8,ra("StructArrayLayout2i4ub8",Eo);var Lo=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){let r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){let i=2*e;return this.float32[i+0]=t,this.float32[i+1]=r,e}};l(Lo,"StructArrayLayout2f8");var Fo=Lo;Fo.prototype.bytesPerElement=8,ra("StructArrayLayout2f8",Fo);var Do=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,n,a,s,o,l,u){let c=this.length;return this.resize(c+1),this.emplace(c,e,t,r,i,n,a,s,o,l,u)}emplace(e,t,r,i,n,a,s,o,l,u,c){let h=10*e;return this.uint16[h+0]=t,this.uint16[h+1]=r,this.uint16[h+2]=i,this.uint16[h+3]=n,this.uint16[h+4]=a,this.uint16[h+5]=s,this.uint16[h+6]=o,this.uint16[h+7]=l,this.uint16[h+8]=u,this.uint16[h+9]=c,e}};l(Do,"StructArrayLayout10ui20");var Oo=Do;Oo.prototype.bytesPerElement=20,ra("StructArrayLayout10ui20",Oo);var qo=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,n,a,s,o,l,u,c,h){let p=this.length;return this.resize(p+1),this.emplace(p,e,t,r,i,n,a,s,o,l,u,c,h)}emplace(e,t,r,i,n,a,s,o,l,u,c,h,p){let f=12*e;return this.int16[f+0]=t,this.int16[f+1]=r,this.int16[f+2]=i,this.int16[f+3]=n,this.uint16[f+4]=a,this.uint16[f+5]=s,this.uint16[f+6]=o,this.uint16[f+7]=l,this.int16[f+8]=u,this.int16[f+9]=c,this.int16[f+10]=h,this.int16[f+11]=p,e}};l(qo,"StructArrayLayout4i4ui4i24");var Ro=qo;Ro.prototype.bytesPerElement=24,ra("StructArrayLayout4i4ui4i24",Ro);var jo=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,t,r)}emplace(e,t,r,i){let n=3*e;return this.float32[n+0]=t,this.float32[n+1]=r,this.float32[n+2]=i,e}};l(jo,"StructArrayLayout3f12");var No=jo;No.prototype.bytesPerElement=12,ra("StructArrayLayout3f12",No);var Uo=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){let r=1*e;return this.uint32[r+0]=t,e}};l(Uo,"StructArrayLayout1ul4");var Zo=Uo;Zo.prototype.bytesPerElement=4,ra("StructArrayLayout1ul4",Zo);var Go=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,n,a,s,o,l){let u=this.length;return this.resize(u+1),this.emplace(u,e,t,r,i,n,a,s,o,l)}emplace(e,t,r,i,n,a,s,o,l,u){let c=10*e,h=5*e;return this.int16[c+0]=t,this.int16[c+1]=r,this.int16[c+2]=i,this.int16[c+3]=n,this.int16[c+4]=a,this.int16[c+5]=s,this.uint32[h+3]=o,this.uint16[c+8]=l,this.uint16[c+9]=u,e}};l(Go,"StructArrayLayout6i1ul2ui20");var Xo=Go;Xo.prototype.bytesPerElement=20,ra("StructArrayLayout6i1ul2ui20",Xo);var Yo=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,n,a){let s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,i,n,a)}emplace(e,t,r,i,n,a,s){let o=6*e;return this.int16[o+0]=t,this.int16[o+1]=r,this.int16[o+2]=i,this.int16[o+3]=n,this.int16[o+4]=a,this.int16[o+5]=s,e}};l(Yo,"StructArrayLayout2i2i2i12");var Jo=Yo;Jo.prototype.bytesPerElement=12,ra("StructArrayLayout2i2i2i12",Jo);var Ho=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,i,n){let a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,i,n)}emplace(e,t,r,i,n,a){let s=4*e,o=8*e;return this.float32[s+0]=t,this.float32[s+1]=r,this.float32[s+2]=i,this.int16[o+6]=n,this.int16[o+7]=a,e}};l(Ho,"StructArrayLayout2f1f2i16");var Wo=Ho;Wo.prototype.bytesPerElement=16,ra("StructArrayLayout2f1f2i16",Wo);var Ko=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,i){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r,i)}emplace(e,t,r,i,n){let a=12*e,s=3*e;return this.uint8[a+0]=t,this.uint8[a+1]=r,this.float32[s+1]=i,this.float32[s+2]=n,e}};l(Ko,"StructArrayLayout2ub2f12");var $o=Ko;$o.prototype.bytesPerElement=12,ra("StructArrayLayout2ub2f12",$o);var Qo=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,t,r)}emplace(e,t,r,i){let n=3*e;return this.uint16[n+0]=t,this.uint16[n+1]=r,this.uint16[n+2]=i,e}};l(Qo,"StructArrayLayout3ui6");var el=Qo;el.prototype.bytesPerElement=6,ra("StructArrayLayout3ui6",el);var tl=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,i,n,a,s,o,l,u,c,h,p,f,d,y,m){let g=this.length;return this.resize(g+1),this.emplace(g,e,t,r,i,n,a,s,o,l,u,c,h,p,f,d,y,m)}emplace(e,t,r,i,n,a,s,o,l,u,c,h,p,f,d,y,m,g){let x=24*e,v=12*e,b=48*e;return this.int16[x+0]=t,this.int16[x+1]=r,this.uint16[x+2]=i,this.uint16[x+3]=n,this.uint32[v+2]=a,this.uint32[v+3]=s,this.uint32[v+4]=o,this.uint16[x+10]=l,this.uint16[x+11]=u,this.uint16[x+12]=c,this.float32[v+7]=h,this.float32[v+8]=p,this.uint8[b+36]=f,this.uint8[b+37]=d,this.uint8[b+38]=y,this.uint32[v+10]=m,this.int16[x+22]=g,e}};l(tl,"StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48");var rl=tl;rl.prototype.bytesPerElement=48,ra("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",rl);var il=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,i,n,a,s,o,l,u,c,h,p,f,d,y,m,g,x,v,b,w,_,S,k,A,I,M){let z=this.length;return this.resize(z+1),this.emplace(z,e,t,r,i,n,a,s,o,l,u,c,h,p,f,d,y,m,g,x,v,b,w,_,S,k,A,I,M)}emplace(e,t,r,i,n,a,s,o,l,u,c,h,p,f,d,y,m,g,x,v,b,w,_,S,k,A,I,M,z){let P=34*e,C=17*e;return this.int16[P+0]=t,this.int16[P+1]=r,this.int16[P+2]=i,this.int16[P+3]=n,this.int16[P+4]=a,this.int16[P+5]=s,this.int16[P+6]=o,this.int16[P+7]=l,this.uint16[P+8]=u,this.uint16[P+9]=c,this.uint16[P+10]=h,this.uint16[P+11]=p,this.uint16[P+12]=f,this.uint16[P+13]=d,this.uint16[P+14]=y,this.uint16[P+15]=m,this.uint16[P+16]=g,this.uint16[P+17]=x,this.uint16[P+18]=v,this.uint16[P+19]=b,this.uint16[P+20]=w,this.uint16[P+21]=_,this.uint16[P+22]=S,this.uint32[C+12]=k,this.float32[C+13]=A,this.float32[C+14]=I,this.float32[C+15]=M,this.float32[C+16]=z,e}};l(il,"StructArrayLayout8i15ui1ul4f68");var nl=il;nl.prototype.bytesPerElement=68,ra("StructArrayLayout8i15ui1ul4f68",nl);var al=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){let r=1*e;return this.float32[r+0]=t,e}};l(al,"StructArrayLayout1f4");var sl=al;sl.prototype.bytesPerElement=4,ra("StructArrayLayout1f4",sl);var ol=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){let i=this.length;return this.resize(i+1),this.emplace(i,e,t,r)}emplace(e,t,r,i){let n=2*e,a=4*e;return this.uint32[n+0]=t,this.uint16[a+2]=r,this.uint16[a+3]=i,e}};l(ol,"StructArrayLayout1ul2ui8");var ll=ol;ll.prototype.bytesPerElement=8,ra("StructArrayLayout1ul2ui8",ll);var ul=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){let r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){let i=2*e;return this.uint16[i+0]=t,this.uint16[i+1]=r,e}};l(ul,"StructArrayLayout2ui4");var cl=ul;cl.prototype.bytesPerElement=4,ra("StructArrayLayout2ui4",cl);var hl=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){let r=1*e;return this.uint16[r+0]=t,e}};l(hl,"StructArrayLayout1ui2");var pl=hl;pl.prototype.bytesPerElement=2,ra("StructArrayLayout1ui2",pl);var fl=class extends bo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,i){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r,i)}emplace(e,t,r,i,n){let a=4*e;return this.float32[a+0]=t,this.float32[a+1]=r,this.float32[a+2]=i,this.float32[a+3]=n,e}};l(fl,"StructArrayLayout4f16");var dl=fl;dl.prototype.bytesPerElement=16,ra("StructArrayLayout4f16",dl);var yl=class extends xo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ko.default(this.anchorPointX,this.anchorPointY)}};l(yl,"CollisionBoxStruct");var ml=yl;ml.prototype.size=20;var gl=class extends Xo{get(e){return new ml(this,e)}};l(gl,"CollisionBoxArray");var xl=gl;ra("CollisionBoxArray",xl);var vl=class extends xo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}};l(vl,"PlacedSymbolStruct");var bl=vl;bl.prototype.size=48;var wl=class extends rl{get(e){return new bl(this,e)}};l(wl,"PlacedSymbolArray");var _l=wl;ra("PlacedSymbolArray",_l);var Sl=class extends xo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}};l(Sl,"SymbolInstanceStruct");var kl=Sl;kl.prototype.size=68;var Al=class extends nl{get(e){return new kl(this,e)}};l(Al,"SymbolInstanceArray");var Il=Al;ra("SymbolInstanceArray",Il);var Ml=class extends sl{getoffsetX(e){return this.float32[1*e+0]}};l(Ml,"GlyphOffsetArray");var zl=Ml;ra("GlyphOffsetArray",zl);var Pl=class extends zo{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}};l(Pl,"SymbolLineVertexArray");var Cl=Pl;ra("SymbolLineVertexArray",Cl);var Bl=class extends xo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}};l(Bl,"FeatureIndexStruct");var Vl=Bl;Vl.prototype.size=8;var Tl=class extends ll{get(e){return new Vl(this,e)}};l(Tl,"FeatureIndexArray");var El=Tl;ra("FeatureIndexArray",El);var Ll=class extends Io{};l(Ll,"PosArray");var Fl=Ll,Dl=class extends Io{};l(Dl,"CircleLayoutArray");var Ol=Dl,ql=class extends Io{};l(ql,"FillLayoutArray");var Rl=ql,jl=class extends Vo{};l(jl,"FillExtrusionLayoutArray");var Nl=jl,Ul=class extends Eo{};l(Ul,"LineLayoutArray");var Zl=Ul,Gl=class extends Fo{};l(Gl,"LineExtLayoutArray");var Xl=Gl,Yl=class extends Oo{};l(Yl,"PatternLayoutArray");var Jl=Yl,Hl=class extends Ro{};l(Hl,"SymbolLayoutArray");var Wl=Hl,Kl=class extends No{};l(Kl,"SymbolDynamicLayoutArray");var $l=Kl,Ql=class extends Zo{};l(Ql,"SymbolOpacityArray");var eu=Ql,tu=class extends Jo{};l(tu,"CollisionBoxLayoutArray");var ru=tu,iu=class extends $o{};l(iu,"CollisionVertexArray");var nu=iu,au=class extends el{};l(au,"TriangleIndexArray");var su=au,ou=class extends cl{};l(ou,"LineIndexArray");var lu=ou;p();var uu=wo([{name:"a_pos",components:2,type:"Int16"}],4),{members:cu,size:hu,alignment:pu}=uu;p();var fu=class e{constructor(e=[]){this.segments=e}prepareSegment(t,r,i,n){let a=this.segments[this.segments.length-1];return t>e.MAX_VERTEX_ARRAY_LENGTH&&R("Max vertices per segment is ".concat(e.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(t)),(!a||a.vertexLength+t>e.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==n)&&(a={vertexOffset:r.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==n&&(a.sortKey=n),this.segments.push(a)),a}get(){return this.segments}destroy(){for(let e of this.segments)for(let t in e.vaos)e.vaos[t].destroy()}static simpleSegment(t,r,i,n){return new e([{vertexOffset:t,primitiveOffset:r,vertexLength:i,primitiveLength:n,vaos:{},sortKey:0}])}};l(fu,"SegmentVector");var du=fu;function yu(e,t){return 256*(e=B(Math.floor(e),0,255))+(t=B(Math.floor(t),0,255))}du.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ra("SegmentVector",du),p(),p(),l(yu,"packUint8ToFloat"),p();var mu=wo([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);p();var gu=h(g(),1),xu=class e{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,r,i){this.ids.push(bu(e)),this.positions.push(t,r,i)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let t=bu(e),r=0,i=this.ids.length-1;for(;r<i;){let e=r+i>>1;this.ids[e]>=t?i=e:r=e+1}let n=[];for(;this.ids[r]===t;){let e=this.positions[3*r],t=this.positions[3*r+1],i=this.positions[3*r+2];n.push({index:e,start:t,end:i}),r++}return n}static serialize(e,t){let r=new Float64Array(e.ids),i=new Uint32Array(e.positions);return wu(r,i,0,r.length-1),t&&t.push(r.buffer,i.buffer),{ids:r,positions:i}}static deserialize(t){let r=new e;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}};l(xu,"FeaturePositionMap");var vu=xu;function bu(e){let t=+e;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:(0,gu.default)(String(e))}function wu(e,t,r,i){for(;r<i;){let n=e[r+i>>1],a=r-1,s=i+1;for(;;){do{a++}while(e[a]<n);do{s--}while(e[s]>n);if(a>=s)break;_u(e,a,s),_u(t,3*a,3*s),_u(t,3*a+1,3*s+1),_u(t,3*a+2,3*s+2)}s-r<i-s?(wu(e,t,r,s),r=s+1):(wu(e,t,s+1,i),i=s)}}function _u(e,t,r){let i=e[t];e[t]=e[r],e[r]=i}l(bu,"getNumericId"),l(wu,"sort"),l(_u,"swap"),ra("FeaturePositionMap",vu),p();var Su=class{constructor(e,t){this.gl=e.gl,this.location=t}};l(Su,"Uniform");var ku=Su,Au=class extends ku{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}};l(Au,"Uniform1f");var Iu=Au,Mu=class extends ku{constructor(e,t){super(e,t),this.current=[0,0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2]||e[3]!==this.current[3])&&(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}};l(Mu,"Uniform4f");var zu=Mu,Pu=class extends ku{constructor(e,t){super(e,t),this.current=Je.transparent}set(e){(e.r!==this.current.r||e.g!==this.current.g||e.b!==this.current.b||e.a!==this.current.a)&&(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}};l(Pu,"UniformColor");var Cu=Pu;new Float32Array(16);function Bu(e){return[yu(255*e.r,255*e.g),yu(255*e.b,255*e.a)]}l(Bu,"packColor");var Vu=class{constructor(e,t,r){this.value=e,this.uniformNames=t.map((e=>"u_".concat(e))),this.type=r}setUniform(e,t,r){e.set(r.constantOr(this.value))}getBinding(e,t,r){return"color"===this.type?new Cu(e,t):new Iu(e,t)}};l(Vu,"ConstantBinder");var Tu=Vu,Eu=class{constructor(e,t){this.uniformNames=t.map((e=>"u_".concat(e))),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr}setUniform(e,t,r,i){let n="u_pattern_to"===i?this.patternTo:"u_pattern_from"===i?this.patternFrom:"u_pixel_ratio_to"===i?this.pixelRatioTo:"u_pixel_ratio_from"===i?this.pixelRatioFrom:null;n&&e.set(n)}getBinding(e,t,r){return"u_pattern"===r.substr(0,9)?new zu(e,t):new Iu(e,t)}};l(Eu,"CrossFadedConstantBinder");var Lu=Eu,Fu=class{constructor(e,t,r,i){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:"a_".concat(e),type:"Float32",components:"color"===r?2:1,offset:0}))),this.paintVertexArray=new i}populatePaintArray(e,t,r,i,n){let a=this.paintVertexArray.length,s=this.expression.evaluate(new Ds(0),t,{},i,[],n);this.paintVertexArray.resize(e),this._setPaintValue(a,e,s)}updatePaintArray(e,t,r,i){let n=this.expression.evaluate({zoom:0},r,i);this._setPaintValue(e,t,n)}_setPaintValue(e,t,r){if("color"===this.type){let i=Bu(r);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,i[0],i[1])}else{for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}};l(Fu,"SourceExpressionBinder");var Du=Fu,Ou=class{constructor(e,t,r,i,n,a){this.expression=e,this.uniformNames=t.map((e=>"u_".concat(e,"_t"))),this.type=r,this.useIntegerZoom=i,this.zoom=n,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:"a_".concat(e),type:"Float32",components:"color"===r?4:2,offset:0}))),this.paintVertexArray=new a}populatePaintArray(e,t,r,i,n){let a=this.expression.evaluate(new Ds(this.zoom),t,{},i,[],n),s=this.expression.evaluate(new Ds(this.zoom+1),t,{},i,[],n),o=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(o,e,a,s)}updatePaintArray(e,t,r,i){let n=this.expression.evaluate({zoom:this.zoom},r,i),a=this.expression.evaluate({zoom:this.zoom+1},r,i);this._setPaintValue(e,t,n,a)}_setPaintValue(e,t,r,i){if("color"===this.type){let n=Bu(r),a=Bu(i);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,n[0],n[1],a[0],a[1])}else{for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,r,i);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t){let r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,i=B(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(i)}getBinding(e,t,r){return new Iu(e,t)}};l(Ou,"CompositeExpressionBinder");var qu=Ou,Ru=class{constructor(e,t,r,i,n,a){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=i,this.layerId=a,this.zoomInPaintVertexArray=new n,this.zoomOutPaintVertexArray=new n}populatePaintArray(e,t,r){let i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(i,e,t.patterns&&t.patterns[this.layerId],r)}updatePaintArray(e,t,r,i,n){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],n)}_setPaintValues(e,t,r,i){if(!i||!r)return;let{min:n,mid:a,max:s}=r,o=i[n],l=i[a],u=i[s];if(o&&l&&u)for(let r=e;r<t;r++)this.zoomInPaintVertexArray.emplace(r,l.tl[0],l.tl[1],l.br[0],l.br[1],o.tl[0],o.tl[1],o.br[0],o.br[1],l.pixelRatio,o.pixelRatio),this.zoomOutPaintVertexArray.emplace(r,l.tl[0],l.tl[1],l.br[0],l.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],l.pixelRatio,u.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,mu.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,mu.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}};l(Ru,"CrossFadedCompositeBinder");var ju=Ru,Nu=class{constructor(e,t,r){this.binders={},this._buffers=[];let i=[];for(let n in e.paint._values){if(!r(n))continue;let a=e.paint.get(n);if(!(a instanceof Ks&&bi(a.property.specification)))continue;let s=Xu(n,e.type),o=a.value,l=a.property.specification.type,u=a.property.useIntegerZoom,c=a.property.specification["property-type"],h="cross-faded"===c||"cross-faded-data-driven"===c;if("constant"===o.kind)this.binders[n]=h?new Lu(o.value,s):new Tu(o.value,s,l),i.push("/u_".concat(n));else if("source"===o.kind||h){let r=Ju(n,l,"source");this.binders[n]=h?new ju(o,l,u,t,r,e.id):new Du(o,s,l,r),i.push("/a_".concat(n))}else{let e=Ju(n,l,"composite");this.binders[n]=new qu(o,s,l,u,t,e),i.push("/z_".concat(n))}}this.cacheKey=i.sort().join("")}getMaxValue(e){let t=this.binders[e];return t instanceof Du||t instanceof qu?t.maxValue:0}populatePaintArrays(e,t,r,i,n){for(let a in this.binders){let s=this.binders[a];(s instanceof Du||s instanceof qu||s instanceof ju)&&s.populatePaintArray(e,t,r,i,n)}}setConstantPatternPositions(e,t){for(let r in this.binders){let i=this.binders[r];i instanceof Lu&&i.setConstantPatternPositions(e,t)}}updatePaintArrays(e,t,r,i,n){let a=!1;for(let s in e){let o=t.getPositions(s);for(let t of o){let o=r.feature(t.index);for(let r in this.binders){let l=this.binders[r];if((l instanceof Du||l instanceof qu||l instanceof ju)&&!0===l.expression.isStateDependent){let u=i.paint.get(r);l.expression=u.value,l.updatePaintArray(t.start,t.end,o,e[s],n),a=!0}}}}return a}defines(){let e=[];for(let t in this.binders){let r=this.binders[t];(r instanceof Tu||r instanceof Lu)&&e.push(...r.uniformNames.map((e=>"#define HAS_UNIFORM_".concat(e))))}return e}getBinderAttributes(){let e=[];for(let t in this.binders){let r=this.binders[t];if(r instanceof Du||r instanceof qu)for(let t=0;t<r.paintVertexAttributes.length;t++)e.push(r.paintVertexAttributes[t].name);else if(r instanceof ju)for(let t=0;t<mu.members.length;t++)e.push(mu.members[t].name)}return e}getBinderUniforms(){let e=[];for(let t in this.binders){let r=this.binders[t];if(r instanceof Tu||r instanceof Lu||r instanceof qu)for(let t of r.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,t){let r=[];for(let i in this.binders){let n=this.binders[i];if(n instanceof Tu||n instanceof Lu||n instanceof qu)for(let a of n.uniformNames)if(t[a]){let s=n.getBinding(e,t[a],a);r.push({name:a,property:i,binding:s})}}return r}setUniforms(e,t,r,i){for(let{name:e,property:n,binding:a}of t)this.binders[n].setUniform(a,i,r.get(n),e)}updatePaintBuffers(e){this._buffers=[];for(let t in this.binders){let r=this.binders[t];if(e&&r instanceof ju){let t=2===e.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;t&&this._buffers.push(t)}else(r instanceof Du||r instanceof qu)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(let t in this.binders){let r=this.binders[t];(r instanceof Du||r instanceof qu||r instanceof ju)&&r.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let t=this.binders[e];(t instanceof Du||t instanceof qu||t instanceof ju)&&t.destroy()}}};l(Nu,"ProgramConfiguration");var Uu=Nu,Zu=class{constructor(e,t,r=(()=>!0)){this.programConfigurations={};for(let i of e)this.programConfigurations[i.id]=new Uu(i,t,r);this.needsUpload=!1,this._featureMap=new vu,this._bufferOffset=0}populatePaintArrays(e,t,r,i,n,a){for(let r in this.programConfigurations)this.programConfigurations[r].populatePaintArrays(e,t,i,n,a);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,r,i){for(let n of r)this.needsUpload=this.programConfigurations[n.id].updatePaintArrays(e,this._featureMap,t,n,i)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}};l(Zu,"ProgramConfigurationSet");var Gu=Zu;function Xu(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace("".concat(t,"-"),"").replace(/-/g,"_")]}function Yu(e){return{"line-pattern":{source:Jl,composite:Jl},"fill-pattern":{source:Jl,composite:Jl},"fill-extrusion-pattern":{source:Jl,composite:Jl}}[e]}function Ju(e,t,r){let i={color:{source:Fo,composite:dl},number:{source:sl,composite:Fo}},n=Yu(e);return n&&n[r]||i[t][r]}l(Xu,"paintAttributeNames"),l(Yu,"getLayoutException"),l(Ju,"layoutType"),ra("ConstantBinder",Tu),ra("CrossFadedConstantBinder",Lu),ra("SourceExpressionBinder",Du),ra("CrossFadedCompositeBinder",ju),ra("CompositeExpressionBinder",qu),ra("ProgramConfiguration",Uu,{omit:["_buffers"]}),ra("ProgramConfigurationSet",Gu),p(),p(),p();var Hu=Math.pow(2,14)-1,Wu=-Hu-1;function Ku(e){let t=8192/e.extent,r=e.loadGeometry();for(let e=0;e<r.length;e++){let i=r[e];for(let e=0;e<i.length;e++){let r=i[e],n=Math.round(r.x*t),a=Math.round(r.y*t);r.x=B(n,Wu,Hu),r.y=B(a,Wu,Hu),(n<r.x||n>r.x+1||a<r.y||a>r.y+1)&&R("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function $u(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Ku(e):[]}}function Qu(e,t,r,i,n){e.emplaceBack(2*t+(i+1)/2,2*r+(n+1)/2)}l(Ku,"loadGeometry"),p(),l($u,"toEvaluationFeature"),l(Qu,"addCircleVertex");var ec=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ol,this.indexArray=new su,this.segments=new du,this.programConfigurations=new Gu(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){let i=this.layers[0],n=[],a=null,s=!1;"circle"===i.type&&(a=i.layout.get("circle-sort-key"),s=!a.isConstant());for(let{feature:t,id:i,index:o,sourceLayerIndex:l}of e){let e=this.layers[0]._featureFilter.needGeometry,u=$u(t,e);if(!this.layers[0]._featureFilter.filter(new Ds(this.zoom),u,r))continue;let c=s?a.evaluate(u,{},r):void 0,h={id:i,properties:t.properties,type:t.type,sourceLayerIndex:l,index:o,geometry:e?u.geometry:Ku(t),patterns:{},sortKey:c};n.push(h)}s&&n.sort(((e,t)=>e.sortKey-t.sortKey));for(let i of n){let{geometry:n,index:a,sourceLayerIndex:s}=i,o=e[a].feature;this.addFeature(i,n,a,r),t.featureIndex.insert(o,n,a,s,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,cu),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,r,i){for(let r of t)for(let t of r){let r=t.x,i=t.y;if(r<0||r>=8192||i<0||i>=8192)continue;let n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),a=n.vertexLength;Qu(this.layoutVertexArray,r,i,-1,-1),Qu(this.layoutVertexArray,r,i,1,-1),Qu(this.layoutVertexArray,r,i,1,1),Qu(this.layoutVertexArray,r,i,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+3,a+2),n.vertexLength+=4,n.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},i)}};l(ec,"CircleBucket");var tc=ec;ra("CircleBucket",tc,{omit:["layers"]}),p();var rc=h(f(),1);function ic(e,t){for(let r=0;r<e.length;r++)if(fc(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(fc(e,t[r]))return!0;return!!lc(e,t)}function nc(e,t,r){return!(!fc(e,t)&&!cc(t,e,r))}function ac(e,t){if(1===e.length)return pc(t,e[0]);for(let r=0;r<t.length;r++){let i=t[r];for(let t=0;t<i.length;t++)if(fc(e,i[t]))return!0}for(let r=0;r<e.length;r++)if(pc(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(lc(e,t[r]))return!0;return!1}function sc(e,t,r){for(let i=0;i<t.length;i++){let n=t[i];if(e.length>=3)for(let t=0;t<n.length;t++)if(fc(e,n[t]))return!0;if(oc(e,n,r))return!0}return!1}function oc(e,t,r){if(e.length>1){if(lc(e,t))return!0;for(let i=0;i<t.length;i++)if(cc(t[i],e,r))return!0}for(let i=0;i<e.length;i++)if(cc(e[i],t,r))return!0;return!1}function lc(e,t){if(0===e.length||0===t.length)return!1;for(let r=0;r<e.length-1;r++){let i=e[r],n=e[r+1];for(let e=0;e<t.length-1;e++){if(uc(i,n,t[e],t[e+1]))return!0}}return!1}function uc(e,t,r,i){return j(e,r,i)!==j(t,r,i)&&j(e,t,r)!==j(e,t,i)}function cc(e,t,r){let i=r*r;if(1===t.length)return e.distSqr(t[0])<i;for(let r=1;r<t.length;r++){if(hc(e,t[r-1],t[r])<i)return!0}return!1}function hc(e,t,r){let i=t.distSqr(r);if(0===i)return e.distSqr(t);let n=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/i;return n<0?e.distSqr(t):n>1?e.distSqr(r):e.distSqr(r.sub(t)._mult(n)._add(t))}function pc(e,t){let r,i,n,a=!1;for(let s=0;s<e.length;s++){r=e[s];for(let e=0,s=r.length-1;e<r.length;s=e++)i=r[e],n=r[s],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(a=!a)}return a}function fc(e,t){let r=!1;for(let i=0,n=e.length-1;i<e.length;n=i++){let a=e[i],s=e[n];a.y>t.y!=s.y>t.y&&t.x<(s.x-a.x)*(t.y-a.y)/(s.y-a.y)+a.x&&(r=!r)}return r}function dc(e,t,r,i,n){for(let a of e)if(t<=a.x&&r<=a.y&&i>=a.x&&n>=a.y)return!0;let a=[new rc.default(t,r),new rc.default(t,n),new rc.default(i,n),new rc.default(i,r)];if(e.length>2)for(let t of a)if(fc(e,t))return!0;for(let t=0;t<e.length-1;t++){if(yc(e[t],e[t+1],a))return!0}return!1}function yc(e,t,r){let i=r[0],n=r[2];if(e.x<i.x&&t.x<i.x||e.x>n.x&&t.x>n.x||e.y<i.y&&t.y<i.y||e.y>n.y&&t.y>n.y)return!1;let a=j(e,t,r[0]);return a!==j(e,t,r[1])||a!==j(e,t,r[2])||a!==j(e,t,r[3])}l(ic,"polygonIntersectsPolygon"),l(nc,"polygonIntersectsBufferedPoint"),l(ac,"polygonIntersectsMultiPolygon"),l(sc,"polygonIntersectsBufferedMultiLine"),l(oc,"lineIntersectsBufferedLine"),l(lc,"lineIntersectsLine"),l(uc,"lineSegmentIntersectsLineSegment"),l(cc,"pointIntersectsBufferedLine"),l(hc,"distToSegmentSquared"),l(pc,"multiPolygonContainsPoint"),l(fc,"polygonContainsPoint"),l(dc,"polygonIntersectsBox"),l(yc,"edgeIntersectsBox"),p();var mc=h(f(),1);function gc(e,t,r){let i=t.paint.get(e).value;return"constant"===i.kind?i.value:r.programConfigurations.get(t.id).getMaxValue(e)}function xc(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function vc(e,t,r,i,n){if(!t[0]&&!t[1])return e;let a=mc.default.convert(t)._mult(n);"viewport"===r&&a._rotate(-i);let s=[];for(let t=0;t<e.length;t++){let r=e[t];s.push(r.sub(a))}return s}function bc(e,t){let r=[];for(let i=0;i<e.length;i++){let n=e[i],a=[];for(let e=0;e<n.length;e++){let r=n[e-1],i=n[e],s=n[e+1],o=0===e?new mc.default(0,0):i.sub(r)._unit()._perp(),l=e===n.length-1?new mc.default(0,0):s.sub(i)._unit()._perp(),u=o._add(l)._unit(),c=u.x*l.x+u.y*l.y;0!==c&&u._mult(1/c),a.push(u._mult(t)._add(i))}r.push(a)}return r}l(gc,"getMaximumPaintValue"),l(xc,"translateDistance"),l(vc,"translate"),l(bc,"offsetLine"),p();var wc,_c,Sc=l((()=>wc=wc||new ho({"circle-sort-key":new io(W.layout_circle["circle-sort-key"])})),"getLayout"),kc=l((()=>_c=_c||new ho({"circle-radius":new io(W.paint_circle["circle-radius"]),"circle-color":new io(W.paint_circle["circle-color"]),"circle-blur":new io(W.paint_circle["circle-blur"]),"circle-opacity":new io(W.paint_circle["circle-opacity"]),"circle-translate":new to(W.paint_circle["circle-translate"]),"circle-translate-anchor":new to(W.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new to(W.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new to(W.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new io(W.paint_circle["circle-stroke-width"]),"circle-stroke-color":new io(W.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new io(W.paint_circle["circle-stroke-opacity"])})),"getPaint"),Ac={get paint(){return kc()},get layout(){return Sc()}};p(),p();var Ic=1e-6,Mc=typeof Float32Array<"u"?Float32Array:Array,zc=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var Pc={};function Cc(){var e=new Mc(16);return Mc!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Bc(e){var t=new Mc(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Vc(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Tc(e,t,r,i,n,a,s,o,l,u,c,h,p,f,d,y){var m=new Mc(16);return m[0]=e,m[1]=t,m[2]=r,m[3]=i,m[4]=n,m[5]=a,m[6]=s,m[7]=o,m[8]=l,m[9]=u,m[10]=c,m[11]=h,m[12]=p,m[13]=f,m[14]=d,m[15]=y,m}function Ec(e,t,r,i,n,a,s,o,l,u,c,h,p,f,d,y,m){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=a,e[5]=s,e[6]=o,e[7]=l,e[8]=u,e[9]=c,e[10]=h,e[11]=p,e[12]=f,e[13]=d,e[14]=y,e[15]=m,e}function Lc(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Fc(e,t){if(e===t){var r=t[1],i=t[2],n=t[3],a=t[6],s=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=a,e[11]=t[14],e[12]=n,e[13]=s,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function Dc(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=t[4],o=t[5],l=t[6],u=t[7],c=t[8],h=t[9],p=t[10],f=t[11],d=t[12],y=t[13],m=t[14],g=t[15],x=r*o-i*s,v=r*l-n*s,b=r*u-a*s,w=i*l-n*o,_=i*u-a*o,S=n*u-a*l,k=c*y-h*d,A=c*m-p*d,I=c*g-f*d,M=h*m-p*y,z=h*g-f*y,P=p*g-f*m,C=x*P-v*z+b*M+w*I-_*A+S*k;return C?(C=1/C,e[0]=(o*P-l*z+u*M)*C,e[1]=(n*z-i*P-a*M)*C,e[2]=(y*S-m*_+g*w)*C,e[3]=(p*_-h*S-f*w)*C,e[4]=(l*I-s*P-u*A)*C,e[5]=(r*P-n*I+a*A)*C,e[6]=(m*b-d*S-g*v)*C,e[7]=(c*S-p*b+f*v)*C,e[8]=(s*z-o*I+u*k)*C,e[9]=(i*I-r*z-a*k)*C,e[10]=(d*_-y*b+g*x)*C,e[11]=(h*b-c*_-f*x)*C,e[12]=(o*A-s*M-l*k)*C,e[13]=(r*M-i*A+n*k)*C,e[14]=(y*v-d*w-m*x)*C,e[15]=(c*w-h*v+p*x)*C,e):null}function Oc(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=t[4],o=t[5],l=t[6],u=t[7],c=t[8],h=t[9],p=t[10],f=t[11],d=t[12],y=t[13],m=t[14],g=t[15];return e[0]=o*(p*g-f*m)-h*(l*g-u*m)+y*(l*f-u*p),e[1]=-(i*(p*g-f*m)-h*(n*g-a*m)+y*(n*f-a*p)),e[2]=i*(l*g-u*m)-o*(n*g-a*m)+y*(n*u-a*l),e[3]=-(i*(l*f-u*p)-o*(n*f-a*p)+h*(n*u-a*l)),e[4]=-(s*(p*g-f*m)-c*(l*g-u*m)+d*(l*f-u*p)),e[5]=r*(p*g-f*m)-c*(n*g-a*m)+d*(n*f-a*p),e[6]=-(r*(l*g-u*m)-s*(n*g-a*m)+d*(n*u-a*l)),e[7]=r*(l*f-u*p)-s*(n*f-a*p)+c*(n*u-a*l),e[8]=s*(h*g-f*y)-c*(o*g-u*y)+d*(o*f-u*h),e[9]=-(r*(h*g-f*y)-c*(i*g-a*y)+d*(i*f-a*h)),e[10]=r*(o*g-u*y)-s*(i*g-a*y)+d*(i*u-a*o),e[11]=-(r*(o*f-u*h)-s*(i*f-a*h)+c*(i*u-a*o)),e[12]=-(s*(h*m-p*y)-c*(o*m-l*y)+d*(o*p-l*h)),e[13]=r*(h*m-p*y)-c*(i*m-n*y)+d*(i*p-n*h),e[14]=-(r*(o*m-l*y)-s*(i*m-n*y)+d*(i*l-n*o)),e[15]=r*(o*p-l*h)-s*(i*p-n*h)+c*(i*l-n*o),e}function qc(e){var t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],s=e[5],o=e[6],l=e[7],u=e[8],c=e[9],h=e[10],p=e[11],f=e[12],d=e[13],y=e[14],m=e[15];return(t*s-r*a)*(h*m-p*y)-(t*o-i*a)*(c*m-p*d)+(t*l-n*a)*(c*y-h*d)+(r*o-i*s)*(u*m-p*f)-(r*l-n*s)*(u*y-h*f)+(i*l-n*o)*(u*d-c*f)}function Rc(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],u=t[6],c=t[7],h=t[8],p=t[9],f=t[10],d=t[11],y=t[12],m=t[13],g=t[14],x=t[15],v=r[0],b=r[1],w=r[2],_=r[3];return e[0]=v*i+b*o+w*h+_*y,e[1]=v*n+b*l+w*p+_*m,e[2]=v*a+b*u+w*f+_*g,e[3]=v*s+b*c+w*d+_*x,v=r[4],b=r[5],w=r[6],_=r[7],e[4]=v*i+b*o+w*h+_*y,e[5]=v*n+b*l+w*p+_*m,e[6]=v*a+b*u+w*f+_*g,e[7]=v*s+b*c+w*d+_*x,v=r[8],b=r[9],w=r[10],_=r[11],e[8]=v*i+b*o+w*h+_*y,e[9]=v*n+b*l+w*p+_*m,e[10]=v*a+b*u+w*f+_*g,e[11]=v*s+b*c+w*d+_*x,v=r[12],b=r[13],w=r[14],_=r[15],e[12]=v*i+b*o+w*h+_*y,e[13]=v*n+b*l+w*p+_*m,e[14]=v*a+b*u+w*f+_*g,e[15]=v*s+b*c+w*d+_*x,e}function jc(e,t,r){var i,n,a,s,o,l,u,c,h,p,f,d,y=r[0],m=r[1],g=r[2];return t===e?(e[12]=t[0]*y+t[4]*m+t[8]*g+t[12],e[13]=t[1]*y+t[5]*m+t[9]*g+t[13],e[14]=t[2]*y+t[6]*m+t[10]*g+t[14],e[15]=t[3]*y+t[7]*m+t[11]*g+t[15]):(i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],u=t[6],c=t[7],h=t[8],p=t[9],f=t[10],d=t[11],e[0]=i,e[1]=n,e[2]=a,e[3]=s,e[4]=o,e[5]=l,e[6]=u,e[7]=c,e[8]=h,e[9]=p,e[10]=f,e[11]=d,e[12]=i*y+o*m+h*g+t[12],e[13]=n*y+l*m+p*g+t[13],e[14]=a*y+u*m+f*g+t[14],e[15]=s*y+c*m+d*g+t[15]),e}function Nc(e,t,r){var i=r[0],n=r[1],a=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Uc(e,t,r,i){var n,a,s,o,l,u,c,h,p,f,d,y,m,g,x,v,b,w,_,S,k,A,I,M,z=i[0],P=i[1],C=i[2],B=Math.hypot(z,P,C);return B<Ic?null:(z*=B=1/B,P*=B,C*=B,n=Math.sin(r),s=1-(a=Math.cos(r)),o=t[0],l=t[1],u=t[2],c=t[3],h=t[4],p=t[5],f=t[6],d=t[7],y=t[8],m=t[9],g=t[10],x=t[11],v=z*z*s+a,b=P*z*s+C*n,w=C*z*s-P*n,_=z*P*s-C*n,S=P*P*s+a,k=C*P*s+z*n,A=z*C*s+P*n,I=P*C*s-z*n,M=C*C*s+a,e[0]=o*v+h*b+y*w,e[1]=l*v+p*b+m*w,e[2]=u*v+f*b+g*w,e[3]=c*v+d*b+x*w,e[4]=o*_+h*S+y*k,e[5]=l*_+p*S+m*k,e[6]=u*_+f*S+g*k,e[7]=c*_+d*S+x*k,e[8]=o*A+h*I+y*M,e[9]=l*A+p*I+m*M,e[10]=u*A+f*I+g*M,e[11]=c*A+d*I+x*M,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Zc(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[4],s=t[5],o=t[6],l=t[7],u=t[8],c=t[9],h=t[10],p=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*n+u*i,e[5]=s*n+c*i,e[6]=o*n+h*i,e[7]=l*n+p*i,e[8]=u*n-a*i,e[9]=c*n-s*i,e[10]=h*n-o*i,e[11]=p*n-l*i,e}function Gc(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[0],s=t[1],o=t[2],l=t[3],u=t[8],c=t[9],h=t[10],p=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n-u*i,e[1]=s*n-c*i,e[2]=o*n-h*i,e[3]=l*n-p*i,e[8]=a*i+u*n,e[9]=s*i+c*n,e[10]=o*i+h*n,e[11]=l*i+p*n,e}function Xc(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[0],s=t[1],o=t[2],l=t[3],u=t[4],c=t[5],h=t[6],p=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n+u*i,e[1]=s*n+c*i,e[2]=o*n+h*i,e[3]=l*n+p*i,e[4]=u*n-a*i,e[5]=c*n-s*i,e[6]=h*n-o*i,e[7]=p*n-l*i,e}function Yc(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Jc(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Hc(e,t,r){var i,n,a,s=r[0],o=r[1],l=r[2],u=Math.hypot(s,o,l);return u<Ic?null:(s*=u=1/u,o*=u,l*=u,i=Math.sin(t),a=1-(n=Math.cos(t)),e[0]=s*s*a+n,e[1]=o*s*a+l*i,e[2]=l*s*a-o*i,e[3]=0,e[4]=s*o*a-l*i,e[5]=o*o*a+n,e[6]=l*o*a+s*i,e[7]=0,e[8]=s*l*a+o*i,e[9]=o*l*a-s*i,e[10]=l*l*a+n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Wc(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Kc(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function $c(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Qc(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=i+i,l=n+n,u=a+a,c=i*o,h=i*l,p=i*u,f=n*l,d=n*u,y=a*u,m=s*o,g=s*l,x=s*u;return e[0]=1-(f+y),e[1]=h+x,e[2]=p-g,e[3]=0,e[4]=h-x,e[5]=1-(c+y),e[6]=d+m,e[7]=0,e[8]=p+g,e[9]=d-m,e[10]=1-(c+f),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function eh(e,t){var r=new Mc(3),i=-t[0],n=-t[1],a=-t[2],s=t[3],o=t[4],l=t[5],u=t[6],c=t[7],h=i*i+n*n+a*a+s*s;return h>0?(r[0]=2*(o*s+c*i+l*a-u*n)/h,r[1]=2*(l*s+c*n+u*i-o*a)/h,r[2]=2*(u*s+c*a+o*n-l*i)/h):(r[0]=2*(o*s+c*i+l*a-u*n),r[1]=2*(l*s+c*n+u*i-o*a),r[2]=2*(u*s+c*a+o*n-l*i)),Qc(e,t,r),e}function th(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function rh(e,t){var r=t[0],i=t[1],n=t[2],a=t[4],s=t[5],o=t[6],l=t[8],u=t[9],c=t[10];return e[0]=Math.hypot(r,i,n),e[1]=Math.hypot(a,s,o),e[2]=Math.hypot(l,u,c),e}function ih(e,t){var r=new Mc(3);rh(r,t);var i=1/r[0],n=1/r[1],a=1/r[2],s=t[0]*i,o=t[1]*n,l=t[2]*a,u=t[4]*i,c=t[5]*n,h=t[6]*a,p=t[8]*i,f=t[9]*n,d=t[10]*a,y=s+c+d,m=0;return y>0?(m=2*Math.sqrt(y+1),e[3]=.25*m,e[0]=(h-f)/m,e[1]=(p-l)/m,e[2]=(o-u)/m):s>c&&s>d?(m=2*Math.sqrt(1+s-c-d),e[3]=(h-f)/m,e[0]=.25*m,e[1]=(o+u)/m,e[2]=(p+l)/m):c>d?(m=2*Math.sqrt(1+c-s-d),e[3]=(p-l)/m,e[0]=(o+u)/m,e[1]=.25*m,e[2]=(h+f)/m):(m=2*Math.sqrt(1+d-s-c),e[3]=(o-u)/m,e[0]=(p+l)/m,e[1]=(h+f)/m,e[2]=.25*m),e}function nh(e,t,r,i){var n=t[0],a=t[1],s=t[2],o=t[3],l=n+n,u=a+a,c=s+s,h=n*l,p=n*u,f=n*c,d=a*u,y=a*c,m=s*c,g=o*l,x=o*u,v=o*c,b=i[0],w=i[1],_=i[2];return e[0]=(1-(d+m))*b,e[1]=(p+v)*b,e[2]=(f-x)*b,e[3]=0,e[4]=(p-v)*w,e[5]=(1-(h+m))*w,e[6]=(y+g)*w,e[7]=0,e[8]=(f+x)*_,e[9]=(y-g)*_,e[10]=(1-(h+d))*_,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function ah(e,t,r,i,n){var a=t[0],s=t[1],o=t[2],l=t[3],u=a+a,c=s+s,h=o+o,p=a*u,f=a*c,d=a*h,y=s*c,m=s*h,g=o*h,x=l*u,v=l*c,b=l*h,w=i[0],_=i[1],S=i[2],k=n[0],A=n[1],I=n[2],M=(1-(y+g))*w,z=(f+b)*w,P=(d-v)*w,C=(f-b)*_,B=(1-(p+g))*_,V=(m+x)*_,T=(d+v)*S,E=(m-x)*S,L=(1-(p+y))*S;return e[0]=M,e[1]=z,e[2]=P,e[3]=0,e[4]=C,e[5]=B,e[6]=V,e[7]=0,e[8]=T,e[9]=E,e[10]=L,e[11]=0,e[12]=r[0]+k-(M*k+C*A+T*I),e[13]=r[1]+A-(z*k+B*A+E*I),e[14]=r[2]+I-(P*k+V*A+L*I),e[15]=1,e}function sh(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=r+r,o=i+i,l=n+n,u=r*s,c=i*s,h=i*o,p=n*s,f=n*o,d=n*l,y=a*s,m=a*o,g=a*l;return e[0]=1-h-d,e[1]=c+g,e[2]=p-m,e[3]=0,e[4]=c-g,e[5]=1-u-d,e[6]=f+y,e[7]=0,e[8]=p+m,e[9]=f-y,e[10]=1-u-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function oh(e,t,r,i,n,a,s){var o=1/(r-t),l=1/(n-i),u=1/(a-s);return e[0]=2*a*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*l,e[6]=0,e[7]=0,e[8]=(r+t)*o,e[9]=(n+i)*l,e[10]=(s+a)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*a*2*u,e[15]=0,e}function lh(e,t,r,i,n){var a,s=1/Math.tan(t/2);return e[0]=s/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=n&&n!==1/0?(a=1/(i-n),e[10]=(n+i)*a,e[14]=2*n*i*a):(e[10]=-1,e[14]=-2*i),e}c(Pc,{add:()=>vh,adjoint:()=>Oc,clone:()=>Bc,copy:()=>Vc,create:()=>Cc,determinant:()=>qc,equals:()=>kh,exactEquals:()=>Sh,frob:()=>xh,fromQuat:()=>sh,fromQuat2:()=>eh,fromRotation:()=>Hc,fromRotationTranslation:()=>Qc,fromRotationTranslationScale:()=>nh,fromRotationTranslationScaleOrigin:()=>ah,fromScaling:()=>Jc,fromTranslation:()=>Yc,fromValues:()=>Tc,fromXRotation:()=>Wc,fromYRotation:()=>Kc,fromZRotation:()=>$c,frustum:()=>oh,getRotation:()=>ih,getScaling:()=>rh,getTranslation:()=>th,identity:()=>Lc,invert:()=>Dc,lookAt:()=>yh,mul:()=>Ah,multiply:()=>Rc,multiplyScalar:()=>wh,multiplyScalarAndAdd:()=>_h,ortho:()=>fh,orthoNO:()=>ph,orthoZO:()=>dh,perspective:()=>uh,perspectiveFromFieldOfView:()=>hh,perspectiveNO:()=>lh,perspectiveZO:()=>ch,rotate:()=>Uc,rotateX:()=>Zc,rotateY:()=>Gc,rotateZ:()=>Xc,scale:()=>Nc,set:()=>Ec,str:()=>gh,sub:()=>Ih,subtract:()=>bh,targetTo:()=>mh,translate:()=>jc,transpose:()=>Fc}),p(),l(Cc,"create"),l(Bc,"clone"),l(Vc,"copy"),l(Tc,"fromValues"),l(Ec,"set"),l(Lc,"identity"),l(Fc,"transpose"),l(Dc,"invert"),l(Oc,"adjoint"),l(qc,"determinant"),l(Rc,"multiply"),l(jc,"translate"),l(Nc,"scale"),l(Uc,"rotate"),l(Zc,"rotateX"),l(Gc,"rotateY"),l(Xc,"rotateZ"),l(Yc,"fromTranslation"),l(Jc,"fromScaling"),l(Hc,"fromRotation"),l(Wc,"fromXRotation"),l(Kc,"fromYRotation"),l($c,"fromZRotation"),l(Qc,"fromRotationTranslation"),l(eh,"fromQuat2"),l(th,"getTranslation"),l(rh,"getScaling"),l(ih,"getRotation"),l(nh,"fromRotationTranslationScale"),l(ah,"fromRotationTranslationScaleOrigin"),l(sh,"fromQuat"),l(oh,"frustum"),l(lh,"perspectiveNO");var uh=lh;function ch(e,t,r,i,n){var a,s=1/Math.tan(t/2);return e[0]=s/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=n&&n!==1/0?(a=1/(i-n),e[10]=n*a,e[14]=n*i*a):(e[10]=-1,e[14]=-i),e}function hh(e,t,r,i){var n=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),s=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(s+o),u=2/(n+a);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-(s-o)*l*.5,e[9]=(n-a)*u*.5,e[10]=i/(r-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*r/(r-i),e[15]=0,e}function ph(e,t,r,i,n,a,s){var o=1/(t-r),l=1/(i-n),u=1/(a-s);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*o,e[13]=(n+i)*l,e[14]=(s+a)*u,e[15]=1,e}l(ch,"perspectiveZO"),l(hh,"perspectiveFromFieldOfView"),l(ph,"orthoNO");var fh=ph;function dh(e,t,r,i,n,a,s){var o=1/(t-r),l=1/(i-n),u=1/(a-s);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=u,e[11]=0,e[12]=(t+r)*o,e[13]=(n+i)*l,e[14]=a*u,e[15]=1,e}function yh(e,t,r,i){var n,a,s,o,l,u,c,h,p,f,d=t[0],y=t[1],m=t[2],g=i[0],x=i[1],v=i[2],b=r[0],w=r[1],_=r[2];return Math.abs(d-b)<Ic&&Math.abs(y-w)<Ic&&Math.abs(m-_)<Ic?Lc(e):(c=d-b,h=y-w,p=m-_,n=x*(p*=f=1/Math.hypot(c,h,p))-v*(h*=f),a=v*(c*=f)-g*p,s=g*h-x*c,(f=Math.hypot(n,a,s))?(n*=f=1/f,a*=f,s*=f):(n=0,a=0,s=0),o=h*s-p*a,l=p*n-c*s,u=c*a-h*n,(f=Math.hypot(o,l,u))?(o*=f=1/f,l*=f,u*=f):(o=0,l=0,u=0),e[0]=n,e[1]=o,e[2]=c,e[3]=0,e[4]=a,e[5]=l,e[6]=h,e[7]=0,e[8]=s,e[9]=u,e[10]=p,e[11]=0,e[12]=-(n*d+a*y+s*m),e[13]=-(o*d+l*y+u*m),e[14]=-(c*d+h*y+p*m),e[15]=1,e)}function mh(e,t,r,i){var n=t[0],a=t[1],s=t[2],o=i[0],l=i[1],u=i[2],c=n-r[0],h=a-r[1],p=s-r[2],f=c*c+h*h+p*p;f>0&&(c*=f=1/Math.sqrt(f),h*=f,p*=f);var d=l*p-u*h,y=u*c-o*p,m=o*h-l*c;return(f=d*d+y*y+m*m)>0&&(d*=f=1/Math.sqrt(f),y*=f,m*=f),e[0]=d,e[1]=y,e[2]=m,e[3]=0,e[4]=h*m-p*y,e[5]=p*d-c*m,e[6]=c*y-h*d,e[7]=0,e[8]=c,e[9]=h,e[10]=p,e[11]=0,e[12]=n,e[13]=a,e[14]=s,e[15]=1,e}function gh(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function xh(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function vh(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function bh(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function wh(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function _h(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e[9]=t[9]+r[9]*i,e[10]=t[10]+r[10]*i,e[11]=t[11]+r[11]*i,e[12]=t[12]+r[12]*i,e[13]=t[13]+r[13]*i,e[14]=t[14]+r[14]*i,e[15]=t[15]+r[15]*i,e}function Sh(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function kh(e,t){var r=e[0],i=e[1],n=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],f=e[11],d=e[12],y=e[13],m=e[14],g=e[15],x=t[0],v=t[1],b=t[2],w=t[3],_=t[4],S=t[5],k=t[6],A=t[7],I=t[8],M=t[9],z=t[10],P=t[11],C=t[12],B=t[13],V=t[14],T=t[15];return Math.abs(r-x)<=Ic*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(i-v)<=Ic*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(n-b)<=Ic*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(a-w)<=Ic*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-_)<=Ic*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(o-S)<=Ic*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(l-k)<=Ic*Math.max(1,Math.abs(l),Math.abs(k))&&Math.abs(u-A)<=Ic*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(c-I)<=Ic*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(h-M)<=Ic*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(p-z)<=Ic*Math.max(1,Math.abs(p),Math.abs(z))&&Math.abs(f-P)<=Ic*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(d-C)<=Ic*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(y-B)<=Ic*Math.max(1,Math.abs(y),Math.abs(B))&&Math.abs(m-V)<=Ic*Math.max(1,Math.abs(m),Math.abs(V))&&Math.abs(g-T)<=Ic*Math.max(1,Math.abs(g),Math.abs(T))}l(dh,"orthoZO"),l(yh,"lookAt"),l(mh,"targetTo"),l(gh,"str"),l(xh,"frob"),l(vh,"add"),l(bh,"subtract"),l(wh,"multiplyScalar"),l(_h,"multiplyScalarAndAdd"),l(Sh,"exactEquals"),l(kh,"equals");var Ah=Rc,Ih=bh,Mh={};function zh(){var e=new Mc(4);return Mc!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Ph(e){var t=new Mc(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Ch(e,t,r,i){var n=new Mc(4);return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function Bh(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Vh(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}function Th(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Eh(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function Lh(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function Fh(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function Dh(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Oh(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function qh(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function Rh(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function jh(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function Nh(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function Uh(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e}function Zh(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return Math.hypot(r,i,n,a)}function Gh(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return r*r+i*i+n*n+a*a}function Xh(e){var t=e[0],r=e[1],i=e[2],n=e[3];return Math.hypot(t,r,i,n)}function Yh(e){var t=e[0],r=e[1],i=e[2],n=e[3];return t*t+r*r+i*i+n*n}function Jh(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Hh(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function Wh(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=r*r+i*i+n*n+a*a;return s>0&&(s=1/Math.sqrt(s)),e[0]=r*s,e[1]=i*s,e[2]=n*s,e[3]=a*s,e}function Kh(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function $h(e,t,r,i){var n=r[0]*i[1]-r[1]*i[0],a=r[0]*i[2]-r[2]*i[0],s=r[0]*i[3]-r[3]*i[0],o=r[1]*i[2]-r[2]*i[1],l=r[1]*i[3]-r[3]*i[1],u=r[2]*i[3]-r[3]*i[2],c=t[0],h=t[1],p=t[2],f=t[3];return e[0]=h*u-p*l+f*o,e[1]=-c*u+p*s-f*a,e[2]=c*l-h*s+f*n,e[3]=-c*o+h*a-p*n,e}function Qh(e,t,r,i){var n=t[0],a=t[1],s=t[2],o=t[3];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e[2]=s+i*(r[2]-s),e[3]=o+i*(r[3]-o),e}function ep(e,t){var r,i,n,a,s,o;t=t||1;do{s=(r=2*zc()-1)*r+(i=2*zc()-1)*i}while(s>=1);do{o=(n=2*zc()-1)*n+(a=2*zc()-1)*a}while(o>=1);var l=Math.sqrt((1-s)/o);return e[0]=t*r,e[1]=t*i,e[2]=t*n*l,e[3]=t*a*l,e}function tp(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3];return e[0]=r[0]*i+r[4]*n+r[8]*a+r[12]*s,e[1]=r[1]*i+r[5]*n+r[9]*a+r[13]*s,e[2]=r[2]*i+r[6]*n+r[10]*a+r[14]*s,e[3]=r[3]*i+r[7]*n+r[11]*a+r[15]*s,e}function rp(e,t,r){var i=t[0],n=t[1],a=t[2],s=r[0],o=r[1],l=r[2],u=r[3],c=u*i+o*a-l*n,h=u*n+l*i-s*a,p=u*a+s*n-o*i,f=-s*i-o*n-l*a;return e[0]=c*u+f*-s+h*-l-p*-o,e[1]=h*u+f*-o+p*-s-c*-l,e[2]=p*u+f*-l+c*-o-h*-s,e[3]=t[3],e}function ip(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function np(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function ap(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function sp(e,t){var r=e[0],i=e[1],n=e[2],a=e[3],s=t[0],o=t[1],l=t[2],u=t[3];return Math.abs(r-s)<=Ic*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-o)<=Ic*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-l)<=Ic*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-u)<=Ic*Math.max(1,Math.abs(a),Math.abs(u))}c(Mh,{add:()=>Th,ceil:()=>Dh,clone:()=>Ph,copy:()=>Bh,create:()=>zh,cross:()=>$h,dist:()=>cp,distance:()=>Zh,div:()=>up,divide:()=>Fh,dot:()=>Kh,equals:()=>sp,exactEquals:()=>ap,floor:()=>Oh,forEach:()=>dp,fromValues:()=>Ch,inverse:()=>Hh,len:()=>pp,length:()=>Xh,lerp:()=>Qh,max:()=>Rh,min:()=>qh,mul:()=>lp,multiply:()=>Lh,negate:()=>Jh,normalize:()=>Wh,random:()=>ep,round:()=>jh,scale:()=>Nh,scaleAndAdd:()=>Uh,set:()=>Vh,sqrDist:()=>hp,sqrLen:()=>fp,squaredDistance:()=>Gh,squaredLength:()=>Yh,str:()=>np,sub:()=>op,subtract:()=>Eh,transformMat4:()=>tp,transformQuat:()=>rp,zero:()=>ip}),p(),l(zh,"create"),l(Ph,"clone"),l(Ch,"fromValues"),l(Bh,"copy"),l(Vh,"set"),l(Th,"add"),l(Eh,"subtract"),l(Lh,"multiply"),l(Fh,"divide"),l(Dh,"ceil"),l(Oh,"floor"),l(qh,"min"),l(Rh,"max"),l(jh,"round"),l(Nh,"scale"),l(Uh,"scaleAndAdd"),l(Zh,"distance"),l(Gh,"squaredDistance"),l(Xh,"length"),l(Yh,"squaredLength"),l(Jh,"negate"),l(Hh,"inverse"),l(Wh,"normalize"),l(Kh,"dot"),l($h,"cross"),l(Qh,"lerp"),l(ep,"random"),l(tp,"transformMat4"),l(rp,"transformQuat"),l(ip,"zero"),l(np,"str"),l(ap,"exactEquals"),l(sp,"equals");var op=Eh,lp=Lh,up=Fh,cp=Zh,hp=Gh,pp=Xh,fp=Yh,dp=function(){var e=zh();return function(t,r,i,n,a,s){var o,l;for(r||(r=4),i||(i=0),l=n?Math.min(n*r+i,t.length):t.length,o=i;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],a(e,e,s),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}}(),yp=h(f(),1),mp=class extends yo{constructor(e){super(e,Ac)}createBucket(e){return new tc(e)}queryRadius(e){let t=e;return gc("circle-radius",this,t)+gc("circle-stroke-width",this,t)+xc(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,r,i,n,a,s,o){let l=vc(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,s),u=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r),c="map"===this.paint.get("circle-pitch-alignment"),h=c?l:vp(l,o),p=c?u*s:u;for(let e of i)for(let t of e){let e=c?t:xp(t,o),r=p,i=Mh.transformMat4([],[t.x,t.y,0,1],o);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?r*=i[3]/a.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(r*=a.cameraToCenterDistance/i[3]),nc(h,e,r))return!0}return!1}};l(mp,"CircleStyleLayer");var gp=mp;function xp(e,t){let r=Mh.transformMat4([],[e.x,e.y,0,1],t);return new yp.default(r[0]/r[3],r[1]/r[3])}function vp(e,t){return e.map((e=>xp(e,t)))}l(xp,"projectPoint"),l(vp,"projectQueryGeometry"),p(),p();var bp=class extends tc{};l(bp,"HeatmapBucket");var wp=bp;ra("HeatmapBucket",wp,{omit:["layers"]}),p();var _p,Sp=l((()=>_p=_p||new ho({"heatmap-radius":new io(W.paint_heatmap["heatmap-radius"]),"heatmap-weight":new io(W.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new to(W.paint_heatmap["heatmap-intensity"]),"heatmap-color":new uo(W.paint_heatmap["heatmap-color"]),"heatmap-opacity":new to(W.paint_heatmap["heatmap-opacity"])})),"getPaint"),kp={get paint(){return Sp()}};function Ap(e,{width:t,height:r},i,n){if(n){if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==t*r*i)throw new RangeError("mismatched image size. expected: ".concat(n.length," but got: ").concat(t*r*i))}else n=new Uint8Array(t*r*i);return e.width=t,e.height=r,e.data=n,e}function Ip(e,{width:t,height:r},i){if(t===e.width&&r===e.height)return;let n=Ap({},{width:t,height:r},i);Mp(e,n,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,t),height:Math.min(e.height,r)},i),e.width=t,e.height=r,e.data=n.data}function Mp(e,t,r,i,n,a){if(0===n.width||0===n.height)return t;if(n.width>e.width||n.height>e.height||r.x>e.width-n.width||r.y>e.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>t.width||n.height>t.height||i.x>t.width-n.width||i.y>t.height-n.height)throw new RangeError("out of range destination coordinates for image copy");let s=e.data,o=t.data;if(s===o)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<n.height;l++){let u=((r.y+l)*e.width+r.x)*a,c=((i.y+l)*t.width+i.x)*a;for(let e=0;e<n.width*a;e++)o[c+e]=s[u+e]}return t}p(),p(),l(Ap,"createImage"),l(Ip,"resizeImage"),l(Mp,"copyImage");var zp=class e{constructor(e,t){Ap(this,e,1,t)}resize(e){Ip(this,e,1)}clone(){return new e({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,i,n){Mp(e,t,r,i,n,1)}};l(zp,"AlphaImage");var Pp=zp,Cp=class e{constructor(e,t){Ap(this,e,4,t)}resize(e){Ip(this,e,4)}replace(e,t){t?this.data.set(e):e instanceof Uint8ClampedArray?this.data=new Uint8Array(e.buffer):this.data=e}clone(){return new e({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,i,n){Mp(e,t,r,i,n,4)}};l(Cp,"RGBAImage");var Bp=Cp;function Vp(e){let t={},r=e.resolution||256,i=e.clips?e.clips.length:1,n=e.image||new Bp({width:r,height:i});if(!E(r))throw new Error("width is not a power of 2 - ".concat(r));let a=l(((r,i,a)=>{t[e.evaluationKey]=a;let s=e.expression.evaluate(t);n.data[r+i+0]=Math.floor(255*s.r/s.a),n.data[r+i+1]=Math.floor(255*s.g/s.a),n.data[r+i+2]=Math.floor(255*s.b/s.a),n.data[r+i+3]=Math.floor(255*s.a)}),"renderPixel");if(e.clips)for(let t=0,n=0;t<i;++t,n+=4*r)for(let i=0,s=0;i<r;i++,s+=4){let o=i/(r-1),{start:l,end:u}=e.clips[t];a(n,s,l*(1-o)+u*o)}else for(let e=0,t=0;e<r;e++,t+=4){a(0,t,e/(r-1))}return n}ra("AlphaImage",Pp),ra("RGBAImage",Bp),l(Vp,"renderColorRamp");var Tp=class extends yo{constructor(e){super(e,kp),this._updateColorRamp()}createBucket(e){return new wp(e)}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){let e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Vp({expression:e,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}};l(Tp,"HeatmapStyleLayer");var Ep=Tp;p(),p();var Lp,Fp=l((()=>Lp=Lp||new ho({"hillshade-illumination-direction":new to(W.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new to(W.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new to(W.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new to(W.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new to(W.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new to(W.paint_hillshade["hillshade-accent-color"])})),"getPaint"),Dp={get paint(){return Fp()}},Op=class extends yo{constructor(e){super(e,Dp)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}};l(Op,"HillshadeStyleLayer");var qp=Op;p(),p(),p();var Rp=wo([{name:"a_pos",components:2,type:"Int16"}],4),{members:jp,size:Np,alignment:Up}=Rp,Zp=h(x(),1);function Gp(e,t,r,i,n){Xp(e,t,r||0,i||e.length-1,n||Jp)}function Xp(e,t,r,i,n){for(;i>r;){if(i-r>600){var a=i-r+1,s=t-r+1,o=Math.log(a),l=.5*Math.exp(2*o/3),u=.5*Math.sqrt(o*l*(a-l)/a)*(s-a/2<0?-1:1);Xp(e,t,Math.max(r,Math.floor(t-s*l/a+u)),Math.min(i,Math.floor(t+(a-s)*l/a+u)),n)}var c=e[t],h=r,p=i;for(Yp(e,r,t),n(e[i],c)>0&&Yp(e,r,i);h<p;){for(Yp(e,h,p),h++,p--;n(e[h],c)<0;)h++;for(;n(e[p],c)>0;)p--}0===n(e[r],c)?Yp(e,r,p):Yp(e,++p,i),p<=t&&(r=p+1),t<=p&&(i=p-1)}}function Yp(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function Jp(e,t){return e<t?-1:e>t?1:0}function Hp(e,t){let r=e.length;if(r<=1)return[e];let i,n,a=[];for(let t=0;t<r;t++){let r=N(e[t]);0!==r&&(e[t].area=Math.abs(r),void 0===n&&(n=r<0),n===r<0?(i&&a.push(i),i=[e[t]]):i.push(e[t]))}if(i&&a.push(i),t>1)for(let e=0;e<a.length;e++)a[e].length<=t||(Gp(a[e],t,1,a[e].length-1,Wp),a[e]=a[e].slice(0,t));return a}function Wp(e,t){return t.area-e.area}function Kp(e,t,r){let i=r.patternDependencies,n=!1;for(let r of t){let t=r.paint.get("".concat(e,"-pattern"));t.isConstant()||(n=!0);let a=t.constantOr(null);a&&(n=!0,i[a.to]=!0,i[a.from]=!0)}return n}function $p(e,t,r,i,n){let a=n.patternDependencies;for(let s of t){let t=s.paint.get("".concat(e,"-pattern")).value;if("constant"!==t.kind){let e=t.evaluate({zoom:i-1},r,{},n.availableImages),o=t.evaluate({zoom:i},r,{},n.availableImages),l=t.evaluate({zoom:i+1},r,{},n.availableImages);e=e&&e.name?e.name:e,o=o&&o.name?o.name:o,l=l&&l.name?l.name:l,a[e]=!0,a[o]=!0,a[l]=!0,r.patterns[s.id]={min:e,mid:o,max:l}}}return r}p(),p(),l(Gp,"quickselect"),l(Xp,"quickselectStep"),l(Yp,"swap"),l(Jp,"defaultCompare"),l(Hp,"classifyRings"),l(Wp,"compareAreas"),p(),l(Kp,"hasPattern"),l($p,"addPatternDependencies");var Qp=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Rl,this.indexArray=new su,this.indexArray2=new lu,this.programConfigurations=new Gu(e.layers,e.zoom),this.segments=new du,this.segments2=new du,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){this.hasPattern=Kp("fill",this.layers,t);let i=this.layers[0].layout.get("fill-sort-key"),n=!i.isConstant(),a=[];for(let{feature:s,id:o,index:l,sourceLayerIndex:u}of e){let e=this.layers[0]._featureFilter.needGeometry,c=$u(s,e);if(!this.layers[0]._featureFilter.filter(new Ds(this.zoom),c,r))continue;let h=n?i.evaluate(c,{},r,t.availableImages):void 0,p={id:o,properties:s.properties,type:s.type,sourceLayerIndex:u,index:l,geometry:e?c.geometry:Ku(s),patterns:{},sortKey:h};a.push(p)}n&&a.sort(((e,t)=>e.sortKey-t.sortKey));for(let i of a){let{geometry:n,index:a,sourceLayerIndex:s}=i;if(this.hasPattern){let e=$p("fill",this.layers,i,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(i,n,a,r,{});let o=e[a].feature;t.featureIndex.insert(o,n,a,s,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}addFeatures(e,t,r){for(let e of this.patternFeatures)this.addFeature(e,e.geometry,e.index,t,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,jp),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,r,i,n){for(let e of Hp(t,500)){let t=0;for(let r of e)t+=r.length;let r=this.segments.prepareSegment(t,this.layoutVertexArray,this.indexArray),i=r.vertexLength,n=[],a=[];for(let t of e){if(0===t.length)continue;t!==e[0]&&a.push(n.length/2);let r=this.segments2.prepareSegment(t.length,this.layoutVertexArray,this.indexArray2),i=r.vertexLength;this.layoutVertexArray.emplaceBack(t[0].x,t[0].y),this.indexArray2.emplaceBack(i+t.length-1,i),n.push(t[0].x),n.push(t[0].y);for(let e=1;e<t.length;e++)this.layoutVertexArray.emplaceBack(t[e].x,t[e].y),this.indexArray2.emplaceBack(i+e-1,i+e),n.push(t[e].x),n.push(t[e].y);r.vertexLength+=t.length,r.primitiveLength+=t.length}let s=(0,Zp.default)(n,a);for(let e=0;e<s.length;e+=3)this.indexArray.emplaceBack(i+s[e],i+s[e+1],i+s[e+2]);r.vertexLength+=t,r.primitiveLength+=s.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,n,i)}};l(Qp,"FillBucket");var ef=Qp;ra("FillBucket",ef,{omit:["layers","patternFeatures"]}),p();var tf,rf,nf=l((()=>tf=tf||new ho({"fill-sort-key":new io(W.layout_fill["fill-sort-key"])})),"getLayout"),af=l((()=>rf=rf||new ho({"fill-antialias":new to(W.paint_fill["fill-antialias"]),"fill-opacity":new io(W.paint_fill["fill-opacity"]),"fill-color":new io(W.paint_fill["fill-color"]),"fill-outline-color":new io(W.paint_fill["fill-outline-color"]),"fill-translate":new to(W.paint_fill["fill-translate"]),"fill-translate-anchor":new to(W.paint_fill["fill-translate-anchor"]),"fill-pattern":new ao(W.paint_fill["fill-pattern"])})),"getPaint"),sf={get paint(){return af()},get layout(){return nf()}},of=class extends yo{constructor(e){super(e,sf)}recalculate(e,t){super.recalculate(e,t);let r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new ef(e)}queryRadius(){return xc(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,r,i,n,a,s){return ac(vc(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,s),i)}isTileClipped(){return!0}};l(of,"FillStyleLayer");var lf=of;p(),p(),p();var uf=wo([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),cf=wo([{name:"a_centroid",components:2,type:"Int16"}],4),{members:hf,size:pf,alignment:ff}=uf,df=h(x(),1),yf=h(_(),1).default.VectorTileFeature.types,mf=Math.pow(2,13);function gf(e,t,r,i,n,a,s,o){e.emplaceBack(t,r,2*Math.floor(i*mf)+s,n*mf*2,a*mf*2,Math.round(o))}l(gf,"addVertex");var xf=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Nl,this.centroidVertexArray=new Fl,this.indexArray=new su,this.programConfigurations=new Gu(e.layers,e.zoom),this.segments=new du,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){this.features=[],this.hasPattern=Kp("fill-extrusion",this.layers,t);for(let{feature:i,id:n,index:a,sourceLayerIndex:s}of e){let e=this.layers[0]._featureFilter.needGeometry,o=$u(i,e);if(!this.layers[0]._featureFilter.filter(new Ds(this.zoom),o,r))continue;let l={id:n,sourceLayerIndex:s,index:a,geometry:e?o.geometry:Ku(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push($p("fill-extrusion",this.layers,l,this.zoom,t)):this.addFeature(l,l.geometry,a,r,{}),t.featureIndex.insert(i,l.geometry,a,s,this.index,!0)}}addFeatures(e,t,r){for(let e of this.features){let{geometry:i}=e;this.addFeature(e,i,e.index,t,r)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,hf),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,cf.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,t,r,i,n){let a={x:0,y:0,vertexCount:0};for(let r of Hp(t,500)){let t=0;for(let e of r)t+=e.length;let i=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let e of r){if(0===e.length||wf(e))continue;let t=0;for(let r=0;r<e.length;r++){let n=e[r];if(r>=1){let s=e[r-1];if(!bf(n,s)){i.vertexLength+4>du.MAX_VERTEX_ARRAY_LENGTH&&(i=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let e=n.sub(s)._perp()._unit(),r=s.dist(n);t+r>32768&&(t=0),gf(this.layoutVertexArray,n.x,n.y,e.x,e.y,0,0,t),gf(this.layoutVertexArray,n.x,n.y,e.x,e.y,0,1,t),a.x+=2*n.x,a.y+=2*n.y,a.vertexCount+=2,t+=r,gf(this.layoutVertexArray,s.x,s.y,e.x,e.y,0,0,t),gf(this.layoutVertexArray,s.x,s.y,e.x,e.y,0,1,t),a.x+=2*s.x,a.y+=2*s.y,a.vertexCount+=2;let o=i.vertexLength;this.indexArray.emplaceBack(o,o+2,o+1),this.indexArray.emplaceBack(o+1,o+2,o+3),i.vertexLength+=4,i.primitiveLength+=2}}}}if(i.vertexLength+t>du.MAX_VERTEX_ARRAY_LENGTH&&(i=this.segments.prepareSegment(t,this.layoutVertexArray,this.indexArray)),"Polygon"!==yf[e.type])continue;let n=[],s=[],o=i.vertexLength;for(let e of r)if(0!==e.length){e!==r[0]&&s.push(n.length/2);for(let t=0;t<e.length;t++){let r=e[t];gf(this.layoutVertexArray,r.x,r.y,0,0,1,1,0),a.x+=r.x,a.y+=r.y,a.vertexCount+=1,n.push(r.x),n.push(r.y)}}let l=(0,df.default)(n,s);for(let e=0;e<l.length;e+=3)this.indexArray.emplaceBack(o+l[e],o+l[e+2],o+l[e+1]);i.primitiveLength+=l.length/3,i.vertexLength+=t}for(let e=0;e<a.vertexCount;e++)this.centroidVertexArray.emplaceBack(Math.floor(a.x/a.vertexCount),Math.floor(a.y/a.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,n,i)}};l(xf,"FillExtrusionBucket");var vf=xf;function bf(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}function wf(e){return e.every((e=>e.x<0))||e.every((e=>e.x>8192))||e.every((e=>e.y<0))||e.every((e=>e.y>8192))}ra("FillExtrusionBucket",vf,{omit:["layers","features"]}),l(bf,"isBoundaryEdge"),l(wf,"isEntirelyOutside"),p();var _f,Sf=l((()=>_f=_f||new ho({"fill-extrusion-opacity":new to(W["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new io(W["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new to(W["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new to(W["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ao(W["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new io(W["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new io(W["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new to(W["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})),"getPaint"),kf={get paint(){return Sf()}},Af=h(f(),1),If=class extends yo{constructor(e){super(e,kf)}createBucket(e){return new vf(e)}queryRadius(){return xc(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,t,r,i,n,a,s,o){let l=vc(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),u=this.paint.get("fill-extrusion-height").evaluate(t,r),c=this.paint.get("fill-extrusion-base").evaluate(t,r),h=Vf(l,o,a,0),p=Bf(i,c,u,o);return Cf(p[0],p[1],h)}};l(If,"FillExtrusionStyleLayer");var Mf=If;function zf(e,t){return e.x*t.x+e.y*t.y}function Pf(e,t){if(1===e.length){let r,i=0,n=t[i++];for(;!r||n.equals(r);)if(r=t[i++],!r)return 1/0;for(;i<t.length;i++){let a=t[i],s=e[0],o=r.sub(n),l=a.sub(n),u=s.sub(n),c=zf(o,o),h=zf(o,l),p=zf(l,l),f=zf(u,o),d=zf(u,l),y=c*p-h*h,m=(p*f-h*d)/y,g=(c*d-h*f)/y,x=1-m-g,v=n.z*x+r.z*m+a.z*g;if(isFinite(v))return v}return 1/0}{let e=1/0;for(let r of t)e=Math.min(e,r.z);return e}}function Cf(e,t,r){let i=1/0;ac(r,t)&&(i=Pf(r,t[0]));for(let n=0;n<t.length;n++){let a=t[n],s=e[n];for(let e=0;e<a.length-1;e++){let t=a[e],n=a[e+1],o=s[e],l=[t,n,s[e+1],o,t];ic(r,l)&&(i=Math.min(i,Pf(r,l)))}}return i!==1/0&&i}function Bf(e,t,r,i){let n=[],a=[],s=i[8]*t,o=i[9]*t,l=i[10]*t,u=i[11]*t,c=i[8]*r,h=i[9]*r,p=i[10]*r,f=i[11]*r;for(let t of e){let e=[],r=[];for(let n of t){let t=n.x,a=n.y,d=i[0]*t+i[4]*a+i[12],y=i[1]*t+i[5]*a+i[13],m=i[2]*t+i[6]*a+i[14],g=i[3]*t+i[7]*a+i[15],x=d+s,v=y+o,b=m+l,w=g+u,_=d+c,S=y+h,k=m+p,A=g+f,I=new Af.default(x/w,v/w);I.z=b/w,e.push(I);let M=new Af.default(_/A,S/A);M.z=k/A,r.push(M)}n.push(e),a.push(r)}return[n,a]}function Vf(e,t,r,i){let n=[];for(let r of e){let e=[r.x,r.y,i,1];Mh.transformMat4(e,e,t),n.push(new Af.default(e[0]/e[3],e[1]/e[3]))}return n}l(zf,"dot"),l(Pf,"getIntersectionDistance"),l(Cf,"checkIntersection"),l(Bf,"projectExtrusion"),l(Vf,"projectQueryGeometry"),p(),p(),p();var Tf=wo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ef,size:Lf,alignment:Ff}=Tf;p();var Df=wo([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Of,size:qf,alignment:Rf}=Df,jf=h(_(),1).default.VectorTileFeature.types,Nf=Math.cos(Math.PI/180*37.5),Uf=Math.pow(2,14)/.5,Zf=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((e=>{this.gradients[e.id]={}})),this.layoutVertexArray=new Zl,this.layoutVertexArray2=new Xl,this.indexArray=new su,this.programConfigurations=new Gu(e.layers,e.zoom),this.segments=new du,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){this.hasPattern=Kp("line",this.layers,t);let i=this.layers[0].layout.get("line-sort-key"),n=!i.isConstant(),a=[];for(let{feature:t,id:s,index:o,sourceLayerIndex:l}of e){let e=this.layers[0]._featureFilter.needGeometry,u=$u(t,e);if(!this.layers[0]._featureFilter.filter(new Ds(this.zoom),u,r))continue;let c=n?i.evaluate(u,{},r):void 0,h={id:s,properties:t.properties,type:t.type,sourceLayerIndex:l,index:o,geometry:e?u.geometry:Ku(t),patterns:{},sortKey:c};a.push(h)}n&&a.sort(((e,t)=>e.sortKey-t.sortKey));for(let i of a){let{geometry:n,index:a,sourceLayerIndex:s}=i;if(this.hasPattern){let e=$p("line",this.layers,i,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(i,n,a,r,{});let o=e[a].feature;t.featureIndex.insert(o,n,a,s,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}addFeatures(e,t,r){for(let e of this.patternFeatures)this.addFeature(e,e.geometry,e.index,t,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Of)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ef),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end")){return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}}addFeature(e,t,r,i,n){let a=this.layers[0].layout,s=a.get("line-join").evaluate(e,{}),o=a.get("line-cap"),l=a.get("line-miter-limit"),u=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let r of t)this.addLine(r,e,s,o,l,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,n,i)}addLine(e,t,r,i,n,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let s="Polygon"===jf[t.type],o=e.length;for(;o>=2&&e[o-1].equals(e[o-2]);)o--;let l=0;for(;l<o-1&&e[l].equals(e[l+1]);)l++;if(o<(s?3:2))return;"bevel"===r&&(n=1.05);let u,c,h,p,f,d=this.overscaling<=16?122880/(512*this.overscaling):0,y=this.segments.prepareSegment(10*o,this.layoutVertexArray,this.indexArray);this.e1=this.e2=-1,s&&(u=e[o-2],f=e[l].sub(u)._unit()._perp());for(let t=l;t<o;t++){if(h=t===o-1?s?e[l+1]:void 0:e[t+1],h&&e[t].equals(h))continue;f&&(p=f),u&&(c=u),u=e[t],f=h?h.sub(u)._unit()._perp():p,p=p||f;let m=p.add(f);(0!==m.x||0!==m.y)&&m._unit();let g=p.x*f.x+p.y*f.y,x=m.x*f.x+m.y*f.y,v=0!==x?1/x:1/0,b=2*Math.sqrt(2-2*x),w=x<Nf&&c&&h,_=p.x*f.y-p.y*f.x>0;if(w&&t>l){let e=u.dist(c);if(e>2*d){let t=u.sub(u.sub(c)._mult(d/e)._round());this.updateDistance(c,t),this.addCurrentVertex(t,p,0,0,y),c=t}}let S=c&&h,k=S?r:s?"butt":i;if(S&&"round"===k&&(v<a?k="miter":v<=2&&(k="fakeround")),"miter"===k&&v>n&&(k="bevel"),"bevel"===k&&(v>2&&(k="flipbevel"),v<n&&(k="miter")),c&&this.updateDistance(c,u),"miter"===k)m._mult(v),this.addCurrentVertex(u,m,0,0,y);else if("flipbevel"===k){if(v>100)m=f.mult(-1);else{let e=v*p.add(f).mag()/p.sub(f).mag();m._perp()._mult(e*(_?-1:1))}this.addCurrentVertex(u,m,0,0,y),this.addCurrentVertex(u,m.mult(-1),0,0,y)}else if("bevel"===k||"fakeround"===k){let e=-Math.sqrt(v*v-1),t=_?e:0,r=_?0:e;if(c&&this.addCurrentVertex(u,p,t,r,y),"fakeround"===k){let e=Math.round(180*b/Math.PI/20);for(let t=1;t<e;t++){let r=t/e;if(.5!==r){let e=r-.5;r+=r*e*(r-1)*((1.0904+g*(g*(3.55645-1.43519*g)-3.2452))*e*e+(.848013+g*(.215638*g-1.06021)))}let i=f.sub(p)._mult(r)._add(p)._unit()._mult(_?-1:1);this.addHalfVertex(u,i.x,i.y,!1,_,0,y)}}h&&this.addCurrentVertex(u,f,-t,-r,y)}else if("butt"===k)this.addCurrentVertex(u,m,0,0,y);else if("square"===k){let e=c?1:-1;this.addCurrentVertex(u,m,e,e,y)}else"round"===k&&(c&&(this.addCurrentVertex(u,p,0,0,y),this.addCurrentVertex(u,p,1,1,y,!0)),h&&(this.addCurrentVertex(u,f,-1,-1,y,!0),this.addCurrentVertex(u,f,0,0,y)));if(w&&t<o-1){let e=u.dist(h);if(e>2*d){let t=u.add(h.sub(u)._mult(d/e)._round());this.updateDistance(u,t),this.addCurrentVertex(t,f,0,0,y),u=t}}}}addCurrentVertex(e,t,r,i,n,a=!1){let s=t.x+t.y*r,o=t.y-t.x*r,l=-t.x+t.y*i,u=-t.y-t.x*i;this.addHalfVertex(e,s,o,a,!1,r,n),this.addHalfVertex(e,l,u,a,!0,-i,n),this.distance>Uf/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,t,r,i,n,a))}addHalfVertex({x:e,y:t},r,i,n,a,s,o){let l=.5*(this.lineClips?this.scaledDistance*(Uf-1):this.scaledDistance);if(this.layoutVertexArray.emplaceBack((e<<1)+(n?1:0),(t<<1)+(a?1:0),Math.round(63*r)+128,Math.round(63*i)+128,1+(0===s?0:s<0?-1:1)|(63&l)<<2,l>>6),this.lineClips){let e=(this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start);this.layoutVertexArray2.emplaceBack(e,this.lineClipsArray.length)}let u=o.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),o.primitiveLength++),a?this.e2=u:this.e1=u}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}};l(Zf,"LineBucket");var Gf=Zf;ra("LineBucket",Gf,{omit:["layers","patternFeatures"]}),p();var Xf,Yf,Jf=l((()=>Xf=Xf||new ho({"line-cap":new to(W.layout_line["line-cap"]),"line-join":new io(W.layout_line["line-join"]),"line-miter-limit":new to(W.layout_line["line-miter-limit"]),"line-round-limit":new to(W.layout_line["line-round-limit"]),"line-sort-key":new io(W.layout_line["line-sort-key"])})),"getLayout"),Hf=l((()=>Yf=Yf||new ho({"line-opacity":new io(W.paint_line["line-opacity"]),"line-color":new io(W.paint_line["line-color"]),"line-translate":new to(W.paint_line["line-translate"]),"line-translate-anchor":new to(W.paint_line["line-translate-anchor"]),"line-width":new io(W.paint_line["line-width"]),"line-gap-width":new io(W.paint_line["line-gap-width"]),"line-offset":new io(W.paint_line["line-offset"]),"line-blur":new io(W.paint_line["line-blur"]),"line-dasharray":new oo(W.paint_line["line-dasharray"]),"line-pattern":new ao(W.paint_line["line-pattern"]),"line-gradient":new uo(W.paint_line["line-gradient"])})),"getPaint"),Wf={get paint(){return Hf()},get layout(){return Jf()}},Kf=class extends io{possiblyEvaluate(e,t){return t=new Ds(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,r,i){return t=T({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,r,i)}};l(Kf,"LineFloorwidthProperty");var $f,Qf=Kf,ed=class extends yo{constructor(e){super(e,Wf),this.gradientVersion=0,$f||(($f=new Qf(Wf.paint.properties["line-width"].specification)).useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){let e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression.expression instanceof pr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=$f.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Gf(e)}queryRadius(e){let t=e,r=rd(gc("line-width",this,t),gc("line-gap-width",this,t)),i=gc("line-offset",this,t);return r/2+Math.abs(i)+xc(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,r,i,n,a,s){let o=vc(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),l=s/2*rd(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),u=this.paint.get("line-offset").evaluate(t,r);return u&&(i=bc(i,u*s)),sc(o,i,l)}isTileClipped(){return!0}};l(ed,"LineStyleLayer");var td=ed;function rd(e,t){return t>0?t+2*e:e}l(rd,"getLineWidth"),p(),p(),p();var id=wo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),nd=wo([{name:"a_projected_pos",components:3,type:"Float32"}],4),ad=(wo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),wo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),sd=(wo([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),wo([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),od=(wo([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4),wo([{name:"triangle",components:3,type:"Uint16"}]),wo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),wo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),wo([{type:"Float32",name:"offsetX"}]),wo([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),h(f(),1));function ld(e,t,r){let i=t.layout.get("text-transform").evaluate(r,{});return"uppercase"===i?e=e.toLocaleUpperCase():"lowercase"===i&&(e=e.toLocaleLowerCase()),Ls.applyArabicShaping&&(e=Ls.applyArabicShaping(e)),e}function ud(e,t,r){return e.sections.forEach((e=>{e.text=ld(e.text,t,r)})),e}function cd(e){let t={},r={},i=[],n=0;function a(t){i.push(e[t]),n++}function s(e,t,n){let a=r[e];return delete r[e],r[t]=a,i[a].geometry[0].pop(),i[a].geometry[0]=i[a].geometry[0].concat(n[0]),a}function o(e,r,n){let a=t[r];return delete t[r],t[e]=a,i[a].geometry[0].shift(),i[a].geometry[0]=n[0].concat(i[a].geometry[0]),a}function u(e,t,r){let i=r?t[0][t[0].length-1]:t[0][0];return"".concat(e,":").concat(i.x,":").concat(i.y)}l(a,"add"),l(s,"mergeFromRight"),l(o,"mergeFromLeft"),l(u,"getKey");for(let l=0;l<e.length;l++){let c=e[l],h=c.geometry,p=c.text?c.text.toString():null;if(!p){a(l);continue}let f=u(p,h),d=u(p,h,!0);if(f in r&&d in t&&r[f]!==t[d]){let e=o(f,d,h),n=s(f,d,i[e].geometry);delete t[f],delete r[d],r[u(p,i[n].geometry,!0)]=n,i[e].geometry=null}else f in r?s(f,d,h):d in t?o(f,d,h):(a(l),t[f]=n-1,r[d]=n-1)}return i.filter((e=>e.geometry))}p(),l(ld,"transformTextInternal"),l(ud,"transformText"),p(),l(cd,"mergeLines"),p(),p();var hd={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function pd(e){let t="";for(let r=0;r<e.length;r++){let i=e.charCodeAt(r+1)||null,n=e.charCodeAt(r-1)||null;i&&ks(i)&&!hd[e[r+1]]||n&&ks(n)&&!hd[e[r-1]]||!hd[e[r]]?t+=e[r]:t+=hd[e[r]]}return t}l(pd,"verticalizePunctuation"),p();var fd=24;p();h(k(),1);function dd(e){let t=0,r=0;for(let i of e)t+=i.w*i.h,r=Math.max(r,i.w);e.sort(((e,t)=>t.h-e.h));let i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],n=0,a=0;for(let t of e)for(let e=i.length-1;e>=0;e--){let r=i[e];if(!(t.w>r.w||t.h>r.h)){if(t.x=r.x,t.y=r.y,a=Math.max(a,t.y+t.h),n=Math.max(n,t.x+t.w),t.w===r.w&&t.h===r.h){let t=i.pop();e<i.length&&(i[e]=t)}else t.h===r.h?(r.x+=t.w,r.w-=t.w):t.w===r.w?(r.y+=t.h,r.h-=t.h):(i.push({x:r.x+t.w,y:r.y,w:r.w-t.w,h:t.h}),r.y+=t.h,r.h-=t.h);break}}return{w:n,h:a,fill:t/(n*a)||0}}p(),p(),l(dd,"potpack");var yd=class{constructor(e,{pixelRatio:t,version:r,stretchX:i,stretchY:n,content:a}){this.paddedRect=e,this.pixelRatio=t,this.stretchX=i,this.stretchY=n,this.content=a,this.version=r}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}};l(yd,"ImagePosition");var md=yd,gd=class{constructor(e,t){let r={},i={};this.haveRenderCallbacks=[];let n=[];this.addImages(e,r,n),this.addImages(t,i,n);let{w:a,h:s}=dd(n),o=new Bp({width:a||1,height:s||1});for(let t in e){let i=e[t],n=r[t].paddedRect;Bp.copy(i.data,o,{x:0,y:0},{x:n.x+1,y:n.y+1},i.data)}for(let e in t){let r=t[e],n=i[e].paddedRect,a=n.x+1,s=n.y+1,l=r.data.width,u=r.data.height;Bp.copy(r.data,o,{x:0,y:0},{x:a,y:s},r.data),Bp.copy(r.data,o,{x:0,y:u-1},{x:a,y:s-1},{width:l,height:1}),Bp.copy(r.data,o,{x:0,y:0},{x:a,y:s+u},{width:l,height:1}),Bp.copy(r.data,o,{x:l-1,y:0},{x:a-1,y:s},{width:1,height:u}),Bp.copy(r.data,o,{x:0,y:0},{x:a+l,y:s},{width:1,height:u})}this.image=o,this.iconPositions=r,this.patternPositions=i}addImages(e,t,r){for(let i in e){let n=e[i],a={x:0,y:0,w:n.data.width+2,h:n.data.height+2};r.push(a),t[i]=new md(a,n),n.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(e,t){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let r in e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)}patchUpdatedImage(e,t,r){if(!e||!t||e.version===t.version)return;e.version=t.version;let[i,n]=e.tl;r.update(t.data,void 0,{x:i,y:n})}};l(gd,"ImageAtlas");var xd=gd;ra("ImagePosition",md),ra("ImageAtlas",xd);var vd,bd=((vd=bd||{})[vd.none=0]="none",vd[vd.horizontal=1]="horizontal",vd[vd.vertical=2]="vertical",vd[vd.horizontalOnly=3]="horizontalOnly",vd),wd=-17;function _d(e){for(let t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}l(_d,"isEmpty");var Sd=class e{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,r){let i=new e;return i.scale=t||1,i.fontStack=r,i}static forImage(t){let r=new e;return r.imageName=t,r}};l(Sd,"SectionOptions");var kd=Sd,Ad=class e{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){let i=new e;for(let e=0;e<t.sections.length;e++){let n=t.sections[e];n.image?i.addImageSection(n):i.addTextSection(n,r)}return i}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=pd(this.text)}trim(){let e=0;for(let t=0;t<this.text.length&&Pd[this.text.charCodeAt(t)];t++)e++;let t=this.text.length;for(let r=this.text.length-1;r>=0&&r>=e&&Pd[this.text.charCodeAt(r)];r--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(t,r){let i=new e;return i.text=this.text.substring(t,r),i.sectionIndex=this.sectionIndex.slice(t,r),i.sections=this.sections,i}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,t)=>Math.max(e,this.sections[t].scale)),0)}addTextSection(e,t){this.text+=e.text,this.sections.push(kd.forText(e.scale,e.fontStack||t));let r=this.sections.length-1;for(let t=0;t<e.text.length;++t)this.sectionIndex.push(r)}addImageSection(e){let t=e.image?e.image.name:"";if(0===t.length)return void R("Can't add FormattedSection with an empty image.");let r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(kd.forImage(t)),this.sectionIndex.push(this.sections.length-1)):R("Reached maximum number of images ".concat(6401))}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}};l(Ad,"TaggedString");var Id=Ad;function Md(e,t){let r=[],i=e.text,n=0;for(let i of t)r.push(e.substring(n,i)),n=i;return n<i.length&&r.push(e.substring(n,i.length)),r}function zd(e,t,r,i,n,a,s,o,l,u,c,h,p,f,d,y){let m=Id.fromFeature(e,n);2===h&&m.verticalizePunctuation();let g,{processBidirectionalText:x,processStyledBidirectionalText:v}=Ls;if(x&&1===m.sections.length){g=[];let e=x(m.toString(),Dd(m,u,a,t,i,f,d));for(let t of e){let e=new Id;e.text=t,e.sections=m.sections;for(let r=0;r<t.length;r++)e.sectionIndex.push(0);g.push(e)}}else if(v){g=[];let e=v(m.text,m.sectionIndex,Dd(m,u,a,t,i,f,d));for(let t of e){let e=new Id;e.text=t[0],e.sectionIndex=t[1],e.sections=m.sections,g.push(e)}}else g=Md(m,Dd(m,u,a,t,i,f,d));let b=[],w={positionedLines:b,text:m.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:h,iconsInText:!1,verticalizable:!1};return qd(w,t,r,i,g,s,o,l,h,u,p,y),!_d(b)&&w}l(Md,"breakLines"),l(zd,"shapeText");var Pd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Cd={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Bd(e,t,r,i,n,a){if(t.imageName){let e=i[t.imageName];return e?e.displaySize[0]*t.scale*fd/a+n:0}{let i=r[t.fontStack],a=i&&i[e];return a?a.metrics.advance*t.scale+n:0}}function Vd(e,t,r,i,n,a){let s=0;for(let r=0;r<e.length();r++){let o=e.getSection(r);s+=Bd(e.getCharCode(r),o,i,n,t,a)}return s/Math.max(1,Math.ceil(s/r))}function Td(e,t,r,i){let n=Math.pow(e-t,2);return i?e<t?n/2:2*n:n+Math.abs(r)*r}function Ed(e,t,r){let i=0;return 10===e&&(i-=1e4),r&&(i+=150),(40===e||65288===e)&&(i+=50),(41===t||65289===t)&&(i+=50),i}function Ld(e,t,r,i,n,a){let s=null,o=Td(t,r,n,a);for(let e of i){let i=Td(t-e.x,r,n,a)+e.badness;i<=o&&(s=e,o=i)}return{index:e,x:t,priorBreak:s,badness:o}}function Fd(e){return e?Fd(e.priorBreak).concat(e.index):[]}function Dd(e,t,r,i,n,a,s){if("point"!==a)return[];if(!e)return[];let o=[],l=Vd(e,t,r,i,n,s),u=e.text.indexOf("")>=0,c=0;for(let r=0;r<e.length();r++){let a=e.getSection(r),h=e.getCharCode(r);if(Pd[h]||(c+=Bd(h,a,i,n,t,s)),r<e.length()-1){let t=ws(h);(Cd[h]||t||a.imageName)&&o.push(Ld(r+1,c,l,o,Ed(h,e.getCharCode(r+1),t&&u),!1))}}return Fd(Ld(e.length(),c,l,o,0,!0))}function Od(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function qd(e,t,r,i,n,a,s,o,l,u,c,h){let p=0,f=wd,d=0,y=0,m="right"===o?1:"left"===o?0:.5,g=0;for(let s of n){s.trim();let n=s.getMaxScale(),o=(n-1)*fd,x={positionedGlyphs:[],lineOffset:0};e.positionedLines[g]=x;let v=x.positionedGlyphs,b=0;if(!s.length()){f+=a,++g;continue}for(let a=0;a<s.length();a++){let d=s.getSection(a),y=s.getSectionIndex(a),m=s.getCharCode(a),g=0,x=null,w=null,_=null,S=fd,k=!(1===l||!c&&!_s(m)||c&&(Pd[m]||As(m)));if(d.imageName){let t=i[d.imageName];if(!t)continue;_=d.imageName,e.iconsInText=e.iconsInText||!0,w=t.paddedRect;let r=t.displaySize;d.scale=d.scale*fd/h,x={width:r[0],height:r[1],left:1,top:-3,advance:k?r[1]:r[0]},g=o+(fd-r[1]*d.scale),S=x.advance;let a=k?r[0]*d.scale-fd*n:r[1]*d.scale-fd*n;a>0&&a>b&&(b=a)}else{let e=r[d.fontStack],i=e&&e[m];if(i&&i.rect)w=i.rect,x=i.metrics;else{let e=t[d.fontStack],r=e&&e[m];if(!r)continue;x=r.metrics}g=(n-d.scale)*fd}k?(e.verticalizable=!0,v.push({glyph:m,imageName:_,x:p,y:f+g,vertical:k,scale:d.scale,fontStack:d.fontStack,sectionIndex:y,metrics:x,rect:w}),p+=S*d.scale+u):(v.push({glyph:m,imageName:_,x:p,y:f+g,vertical:k,scale:d.scale,fontStack:d.fontStack,sectionIndex:y,metrics:x,rect:w}),p+=x.advance*d.scale+u)}if(0!==v.length){let e=p-u;d=Math.max(e,d),Rd(v,0,v.length-1,m,b)}p=0;let w=a*n+b;x.lineOffset=Math.max(b,o),f+=w,y=Math.max(w,y),++g}let x=f-wd,{horizontalAlign:v,verticalAlign:b}=Od(s);jd(e.positionedLines,m,v,b,d,y,a,x,n.length),e.top+=-b*x,e.bottom=e.top+x,e.left+=-v*d,e.right=e.left+d}function Rd(e,t,r,i,n){if(!i&&!n)return;let a=e[r],s=a.metrics.advance*a.scale,o=(e[r].x+s)*i;for(let i=t;i<=r;i++)e[i].x-=o,e[i].y+=n}function jd(e,t,r,i,n,a,s,o,l){let u=(t-r)*n,c=0;c=a!==s?-o*i-wd:(-i*l+.5)*s;for(let t of e)for(let e of t.positionedGlyphs)e.x+=u,e.y+=c}function Nd(e,t,r){let{horizontalAlign:i,verticalAlign:n}=Od(r),a=t[0],s=t[1],o=a-e.displaySize[0]*i,l=o+e.displaySize[0],u=s-e.displaySize[1]*n;return{image:e,top:u,bottom:u+e.displaySize[1],left:o,right:l}}function Ud(e,t,r,i,n,a){let s,o=e.image;if(o.content){let e=o.content,t=o.pixelRatio||1;s=[e[0]/t,e[1]/t,o.displaySize[0]-e[2]/t,o.displaySize[1]-e[3]/t]}let l,u,c,h,p=t.left*a,f=t.right*a;"width"===r||"both"===r?(h=n[0]+p-i[3],u=n[0]+f+i[1]):(h=n[0]+(p+f-o.displaySize[0])/2,u=h+o.displaySize[0]);let d=t.top*a,y=t.bottom*a;return"height"===r||"both"===r?(l=n[1]+d-i[0],c=n[1]+y+i[2]):(l=n[1]+(d+y-o.displaySize[1])/2,c=l+o.displaySize[1]),{image:o,top:l,right:u,bottom:c,left:h,collisionPadding:s}}l(Bd,"getGlyphAdvance"),l(Vd,"determineAverageLineWidth"),l(Td,"calculateBadness"),l(Ed,"calculatePenalty"),l(Ld,"evaluateBreak"),l(Fd,"leastBadBreaks"),l(Dd,"determineLineBreaks"),l(Od,"getAnchorAlignment"),l(qd,"shapeLines"),l(Rd,"justifyLine"),l(jd,"align"),l(Nd,"shapeIcon"),l(Ud,"fitIconToText");var Zd=h(_(),1);p();var Gd=255,Xd=128,Yd=32640;function Jd(e,t){let{expression:r}=t;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new Ds(e+1))};if("source"===r.kind)return{kind:"source"};{let{zoomStops:t,interpolationType:i}=r,n=0;for(;n<t.length&&t[n]<=e;)n++;n=Math.max(0,n-1);let a=n;for(;a<t.length&&t[a]<e+1;)a++;a=Math.min(t.length-1,a);let s=t[n],o=t[a];return"composite"===r.kind?{kind:"composite",minZoom:s,maxZoom:o,interpolationType:i}:{kind:"camera",minZoom:s,maxZoom:o,minSize:r.evaluate(new Ds(s)),maxSize:r.evaluate(new Ds(o)),interpolationType:i}}}function Hd(e,t,r){let i="never",n=e.get(t);return n?i=n:e.get(r)&&(i="always"),i}l(Jd,"getSizeData"),p(),l(Hd,"getOverlapMode");var Wd=Zd.default.VectorTileFeature.types,Kd=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function $d(e,t,r,i,n,a,s,o,l,u,c,h,p){let f=o?Math.min(Yd,Math.round(o[0])):0,d=o?Math.min(Yd,Math.round(o[1])):0;e.emplaceBack(t,r,Math.round(32*i),Math.round(32*n),a,s,(f<<1)+(l?1:0),d,16*u,16*c,256*h,256*p)}function Qd(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function ey(e){for(let t of e.sections)if(zs(t.text))return!0;return!1}l($d,"addVertex"),l(Qd,"addDynamicAttributes"),l(ey,"containsRTLText");var ty=class{constructor(e){this.layoutVertexArray=new Wl,this.indexArray=new su,this.programConfigurations=e,this.segments=new du,this.dynamicLayoutVertexArray=new $l,this.opacityVertexArray=new eu,this.hasVisibleVertices=!1,this.placedSymbolArray=new _l}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,r,i){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,id.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,nd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Kd,!0),this.opacityVertexBuffer.itemSize=1),(r||i)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}};l(ty,"SymbolBuffers");var ry=ty;ra("SymbolBuffers",ry);var iy=class{constructor(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new du,this.collisionVertexArray=new nu}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,ad.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}};l(iy,"CollisionBuffers");var ny=iy;ra("CollisionBuffers",ny);var ay=class{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Pc.identity([]),this.placementViewportMatrix=Pc.identity([]);let t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Jd(this.zoom,t["text-size"]),this.iconSizeData=Jd(this.zoom,t["icon-size"]);let r=this.layers[0].layout,i=r.get("symbol-sort-key"),n=r.get("symbol-z-order");this.canOverlap="never"!==Hd(r,"text-overlap","text-allow-overlap")||"never"!==Hd(r,"icon-overlap","icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==n&&!i.isConstant();let a="viewport-y"===n||"auto"===n&&!this.sortFeaturesByKey;this.sortFeaturesByY=a&&this.canOverlap,"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map((e=>bd[e]))),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.sourceID=e.sourceID}createArrays(){this.text=new ry(new Gu(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new ry(new Gu(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new zl,this.lineVertexArray=new Cl,this.symbolInstances=new Il}calculateGlyphDependencies(e,t,r,i,n){for(let a=0;a<e.length;a++)if(t[e.charCodeAt(a)]=!0,(r||i)&&n){let r=hd[e.charAt(a)];r&&(t[r.charCodeAt(0)]=!0)}}populate(e,t,r){let i=this.layers[0],n=i.layout,a=n.get("text-font"),s=n.get("text-field"),o=n.get("icon-image"),l=("constant"!==s.value.kind||s.value.value instanceof et&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),u="constant"!==o.value.kind||!!o.value.value||Object.keys(o.parameters).length>0,c=n.get("symbol-sort-key");if(this.features=[],!l&&!u)return;let h=t.iconDependencies,p=t.glyphDependencies,f=t.availableImages,d=new Ds(this.zoom);for(let{feature:t,id:s,index:o,sourceLayerIndex:y}of e){let e,m,g=i._featureFilter.needGeometry,x=$u(t,g);if(!i._featureFilter.filter(d,x,r))continue;if(g||(x.geometry=Ku(t)),l){let t=i.getValueAndResolveTokens("text-field",x,r,f),n=et.factory(t);ey(n)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Es()||this.hasRTLText&&Ls.isParsed())&&(e=ud(n,i,x))}if(u){let e=i.getValueAndResolveTokens("icon-image",x,r,f);m=e instanceof ot?e:ot.fromString(e)}if(!e&&!m)continue;let v=this.sortFeaturesByKey?c.evaluate(x,{},r):void 0,b={id:s,text:e,icon:m,index:o,sourceLayerIndex:y,geometry:x.geometry,properties:t.properties,type:Wd[t.type],sortKey:v};if(this.features.push(b),m&&(h[m.name]=!0),e){let t=a.evaluate(x,{},r).join(","),i="viewport"!==n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(2)>=0;for(let r of e.sections)if(r.image)h[r.image.name]=!0;else{let n=xs(e.toString()),a=r.fontStack||t,s=p[a]=p[a]||{};this.calculateGlyphDependencies(r.text,s,i,this.allowVerticalPlacement,n)}}}"line"===n.get("symbol-placement")&&(this.features=cd(this.features)),this.sortFeaturesByKey&&this.features.sort(((e,t)=>e.sortKey-t.sortKey))}update(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){let r=this.lineVertexArray.length;if(void 0!==e.segment){let r=e.dist(t[e.segment+1]),i=e.dist(t[e.segment]),n={};for(let i=e.segment+1;i<t.length;i++)n[i]={x:t[i].x,y:t[i].y,tileUnitDistanceFromAnchor:r},i<t.length-1&&(r+=t[i+1].dist(t[i]));for(let r=e.segment||0;r>=0;r--)n[r]={x:t[r].x,y:t[r].y,tileUnitDistanceFromAnchor:i},r>0&&(i+=t[r-1].dist(t[r]));for(let e=0;e<t.length;e++){let t=n[e];this.lineVertexArray.emplaceBack(t.x,t.y,t.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(e,t,r,i,n,a,s,o,l,u,c,h){let p=e.indexArray,f=e.layoutVertexArray,d=e.segments.prepareSegment(4*t.length,f,p,this.canOverlap?a.sortKey:void 0),y=this.glyphOffsetArray.length,m=d.vertexLength,g=this.allowVerticalPlacement&&2===s?Math.PI/2:0,x=a.text&&a.text.sections;for(let i=0;i<t.length;i++){let{tl:n,tr:s,bl:l,br:u,tex:c,pixelOffsetTL:y,pixelOffsetBR:m,minFontScaleX:v,minFontScaleY:b,glyphOffset:w,isSDF:_,sectionIndex:S}=t[i],k=d.vertexLength,A=w[1];$d(f,o.x,o.y,n.x,A+n.y,c.x,c.y,r,_,y.x,y.y,v,b),$d(f,o.x,o.y,s.x,A+s.y,c.x+c.w,c.y,r,_,m.x,y.y,v,b),$d(f,o.x,o.y,l.x,A+l.y,c.x,c.y+c.h,r,_,y.x,m.y,v,b),$d(f,o.x,o.y,u.x,A+u.y,c.x+c.w,c.y+c.h,r,_,m.x,m.y,v,b),Qd(e.dynamicLayoutVertexArray,o,g),p.emplaceBack(k,k+1,k+2),p.emplaceBack(k+1,k+2,k+3),d.vertexLength+=4,d.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(w[0]),(i===t.length-1||S!==t[i+1].sectionIndex)&&e.programConfigurations.populatePaintArrays(f.length,a,a.index,{},h,x&&x[S])}e.placedSymbolArray.emplaceBack(o.x,o.y,y,this.glyphOffsetArray.length-y,m,l,u,o.segment,r?r[0]:0,r?r[1]:0,i[0],i[1],s,0,!1,0,c)}_addCollisionDebugVertex(e,t,r,i,n,a){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,i,n,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(e,t,r,i,n,a,s){let o=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),l=o.vertexLength,u=n.layoutVertexArray,c=n.collisionVertexArray,h=s.anchorX,p=s.anchorY;this._addCollisionDebugVertex(u,c,a,h,p,new od.default(e,t)),this._addCollisionDebugVertex(u,c,a,h,p,new od.default(r,t)),this._addCollisionDebugVertex(u,c,a,h,p,new od.default(r,i)),this._addCollisionDebugVertex(u,c,a,h,p,new od.default(e,i)),o.vertexLength+=4;let f=n.indexArray;f.emplaceBack(l,l+1),f.emplaceBack(l+1,l+2),f.emplaceBack(l+2,l+3),f.emplaceBack(l+3,l),o.primitiveLength+=4}addDebugCollisionBoxes(e,t,r,i){for(let n=e;n<t;n++){let e=this.collisionBoxArray.get(n),t=e.x1,a=e.y1,s=e.x2,o=e.y2;this.addCollisionDebugVertices(t,a,s,o,i?this.textCollisionBox:this.iconCollisionBox,e.anchorPoint,r)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ny(ru,sd.members,lu),this.iconCollisionBox=new ny(ru,sd.members,lu);for(let e=0;e<this.symbolInstances.length;e++){let t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}}_deserializeCollisionBoxesForSymbol(e,t,r,i,n,a,s,o,l){let u={};for(let i=t;i<r;i++){let t=e.get(i);u.textBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},u.textFeatureIndex=t.featureIndex;break}for(let t=i;t<n;t++){let r=e.get(t);u.verticalTextBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},u.verticalTextFeatureIndex=r.featureIndex;break}for(let t=a;t<s;t++){let r=e.get(t);u.iconBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},u.iconFeatureIndex=r.featureIndex;break}for(let t=o;t<l;t++){let r=e.get(t);u.verticalIconBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},u.verticalIconFeatureIndex=r.featureIndex;break}return u}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){let r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){let r=e.placedSymbolArray.get(t),i=r.vertexStartIndex+4*r.numGlyphs;for(let t=r.vertexStartIndex;t<i;t+=4)e.indexArray.emplaceBack(t,t+1,t+2),e.indexArray.emplaceBack(t+1,t+2,t+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;let t=Math.sin(e),r=Math.cos(e),i=[],n=[],a=[];for(let e=0;e<this.symbolInstances.length;++e){a.push(e);let s=this.symbolInstances.get(e);i.push(0|Math.round(t*s.anchorX+r*s.anchorY)),n.push(s.featureIndex)}return a.sort(((e,t)=>i[e]-i[t]||n[t]-n[e])),a}addToSortKeyRanges(e,t){let r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let e of this.symbolInstanceIndexes){let t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex),[t.rightJustifiedTextSymbolIndex,t.centerJustifiedTextSymbolIndex,t.leftJustifiedTextSymbolIndex].forEach(((e,t,r)=>{e>=0&&r.indexOf(e)===t&&this.addIndicesForPlacedSymbol(this.text,e)})),t.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,t.verticalPlacedTextSymbolIndex),t.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.placedIconSymbolIndex),t.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}};l(ay,"SymbolBucket");var sy=ay;function oy(e,t){return t.replace(/{([^{}]+)}/g,((t,r)=>r in e?String(e[r]):""))}ra("SymbolBucket",sy,{omit:["layers","collisionBoxArray","features","compareText"]}),sy.MAX_GLYPHS=65535,sy.addDynamicAttributes=Qd,p(),l(oy,"resolveTokens"),p();var ly,uy,cy=l((()=>ly=ly||new ho({"symbol-placement":new to(W.layout_symbol["symbol-placement"]),"symbol-spacing":new to(W.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new to(W.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new io(W.layout_symbol["symbol-sort-key"]),"symbol-z-order":new to(W.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new to(W.layout_symbol["icon-allow-overlap"]),"icon-overlap":new to(W.layout_symbol["icon-overlap"]),"icon-ignore-placement":new to(W.layout_symbol["icon-ignore-placement"]),"icon-optional":new to(W.layout_symbol["icon-optional"]),"icon-rotation-alignment":new to(W.layout_symbol["icon-rotation-alignment"]),"icon-size":new io(W.layout_symbol["icon-size"]),"icon-text-fit":new to(W.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new to(W.layout_symbol["icon-text-fit-padding"]),"icon-image":new io(W.layout_symbol["icon-image"]),"icon-rotate":new io(W.layout_symbol["icon-rotate"]),"icon-padding":new io(W.layout_symbol["icon-padding"]),"icon-keep-upright":new to(W.layout_symbol["icon-keep-upright"]),"icon-offset":new io(W.layout_symbol["icon-offset"]),"icon-anchor":new io(W.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new to(W.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new to(W.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new to(W.layout_symbol["text-rotation-alignment"]),"text-field":new io(W.layout_symbol["text-field"]),"text-font":new io(W.layout_symbol["text-font"]),"text-size":new io(W.layout_symbol["text-size"]),"text-max-width":new io(W.layout_symbol["text-max-width"]),"text-line-height":new to(W.layout_symbol["text-line-height"]),"text-letter-spacing":new io(W.layout_symbol["text-letter-spacing"]),"text-justify":new io(W.layout_symbol["text-justify"]),"text-radial-offset":new io(W.layout_symbol["text-radial-offset"]),"text-variable-anchor":new to(W.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new io(W.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new io(W.layout_symbol["text-anchor"]),"text-max-angle":new to(W.layout_symbol["text-max-angle"]),"text-writing-mode":new to(W.layout_symbol["text-writing-mode"]),"text-rotate":new io(W.layout_symbol["text-rotate"]),"text-padding":new to(W.layout_symbol["text-padding"]),"text-keep-upright":new to(W.layout_symbol["text-keep-upright"]),"text-transform":new io(W.layout_symbol["text-transform"]),"text-offset":new io(W.layout_symbol["text-offset"]),"text-allow-overlap":new to(W.layout_symbol["text-allow-overlap"]),"text-overlap":new to(W.layout_symbol["text-overlap"]),"text-ignore-placement":new to(W.layout_symbol["text-ignore-placement"]),"text-optional":new to(W.layout_symbol["text-optional"])})),"getLayout"),hy=l((()=>uy=uy||new ho({"icon-opacity":new io(W.paint_symbol["icon-opacity"]),"icon-color":new io(W.paint_symbol["icon-color"]),"icon-halo-color":new io(W.paint_symbol["icon-halo-color"]),"icon-halo-width":new io(W.paint_symbol["icon-halo-width"]),"icon-halo-blur":new io(W.paint_symbol["icon-halo-blur"]),"icon-translate":new to(W.paint_symbol["icon-translate"]),"icon-translate-anchor":new to(W.paint_symbol["icon-translate-anchor"]),"text-opacity":new io(W.paint_symbol["text-opacity"]),"text-color":new io(W.paint_symbol["text-color"],{runtimeType:ue,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new io(W.paint_symbol["text-halo-color"]),"text-halo-width":new io(W.paint_symbol["text-halo-width"]),"text-halo-blur":new io(W.paint_symbol["text-halo-blur"]),"text-translate":new to(W.paint_symbol["text-translate"]),"text-translate-anchor":new to(W.paint_symbol["text-translate-anchor"])})),"getPaint"),py={get paint(){return hy()},get layout(){return cy()}};p();var fy=class{constructor(e){if(void 0===e.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:ae,this.defaultValue=e}evaluate(e){if(e.formattedSection){let t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){if(!this.defaultValue.isConstant()){e(this.defaultValue.value._styleExpression.expression)}}outputDefined(){return!1}serialize(){return null}};l(fy,"FormatSectionOverride");var dy=fy;ra("FormatSectionOverride",dy,{omit:["defaultValue"]});var yy=class e extends yo{constructor(e){super(e,py)}recalculate(e,t){if(super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){let e=this.layout.get("text-writing-mode");if(e){let t=[];for(let r of e)t.indexOf(r)<0&&t.push(r);this.layout._values["text-writing-mode"]=t}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,t,r,i){let n=this.layout.get(e).evaluate(t,{},r,i),a=this._unevaluatedLayout._values[e];return a.isDataDriven()||Li(a.value)||!n?n:oy(t.properties,n)}createBucket(e){return new sy(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let t of py.paint.overridableProperties){if(!e.hasPaintOverride(this.layout,t))continue;let r=this.paint.get(t),i=new dy(r),n=new Ei(i,r.property.specification),a=null;a="constant"===r.value.kind||"source"===r.value.kind?new Oi("source",n):new Ri("composite",n,r.value.zoomStops),this.paint._values[t]=new Ks(r.property,a,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,i){return!(!this.layout||r.isDataDriven()||i.isDataDriven())&&e.hasPaintOverride(this.layout,t)}static hasPaintOverride(e,t){let r=e.get("text-field"),i=py.paint.properties[t],n=!1,a=l((e=>{for(let t of e)if(i.overrides&&i.overrides.hasOverride(t))return void(n=!0)}),"checkSections");if("constant"===r.value.kind&&r.value.value instanceof et)a(r.value.value.sections);else if("source"===r.value.kind){let e=l((t=>{if(!n)if(t instanceof ft&&ct(t.value)===fe){let e=t.value;a(e.sections)}else t instanceof li?a(t.sections):t.eachChild(e)}),"checkExpression"),t=r.value;t._styleExpression&&e(t._styleExpression.expression)}return n}};l(yy,"SymbolStyleLayer");var my=yy;function gy(e,t,r,i=1){let n=e.get("icon-padding").evaluate(t,{},r),a=n&&n.values;return[a[0]*i,a[1]*i,a[2]*i,a[3]*i]}l(gy,"getIconPadding"),p(),p();var xy,vy=l((()=>xy=xy||new ho({"background-color":new to(W.paint_background["background-color"]),"background-pattern":new oo(W.paint_background["background-pattern"]),"background-opacity":new to(W.paint_background["background-opacity"])})),"getPaint"),by={get paint(){return vy()}},wy=class extends yo{constructor(e){super(e,by)}};l(wy,"BackgroundStyleLayer");var _y=wy;p(),p();var Sy,ky=l((()=>Sy=Sy||new ho({"raster-opacity":new to(W.paint_raster["raster-opacity"]),"raster-hue-rotate":new to(W.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new to(W.paint_raster["raster-brightness-min"]),"raster-brightness-max":new to(W.paint_raster["raster-brightness-max"]),"raster-saturation":new to(W.paint_raster["raster-saturation"]),"raster-contrast":new to(W.paint_raster["raster-contrast"]),"raster-resampling":new to(W.paint_raster["raster-resampling"]),"raster-fade-duration":new to(W.paint_raster["raster-fade-duration"])})),"getPaint"),Ay={get paint(){return ky()}},Iy=class extends yo{constructor(e){super(e,Ay)}};l(Iy,"RasterStyleLayer");var My=Iy;p();var zy=class extends yo{constructor(e){super(e,{}),this.onAdd=l((e=>{this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}),"onAdd"),this.onRemove=l((e=>{this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}),"onRemove"),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}};l(zy,"CustomStyleLayer");var Py=zy;function Cy(e){if("custom"===e.type)return new Py(e);switch(e.type){case"background":return new _y(e);case"circle":return new gp(e);case"fill":return new lf(e);case"fill-extrusion":return new Mf(e);case"heatmap":return new Ep(e);case"hillshade":return new qp(e);case"line":return new td(e);case"raster":return new My(e);case"symbol":return new my(e)}}l(Cy,"createStyleLayer");var By=class{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(e,t){for(let t of e){this._layerConfigs[t.id]=t;let e=this._layers[t.id]=Cy(t);e._featureFilter=Wi(e.filter),this.keyCache[t.id]&&delete this.keyCache[t.id]}for(let e of t)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};let r=ln(Object.values(this._layerConfigs),this.keyCache);for(let e of r){let t=e.map((e=>this._layers[e.id])),r=t[0];if("none"===r.visibility)continue;let i=r.source||"",n=this.familiesBySource[i];n||(n=this.familiesBySource[i]={});let a=r.sourceLayer||"_geojsonTileLayer",s=n[a];s||(s=n[a]=[]),s.push(t)}}};l(By,"StyleLayerIndex");var Vy=By;p();var Ty=h(_(),1),Ey=h(k(),1);p(),p(),p();var Ly=class{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){let r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error("Out of bounds. Index requested n=".concat(e," can't be >= this._numberToString.length ").concat(this._numberToString.length));return this._numberToString[e]}};l(Ly,"DictionaryCoder");var Fy=Ly,Dy=h(_(),1),Oy=h(k(),1);p();var qy=class{constructor(e,t,r,i,n){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=i,this.properties=e.properties,this.id=n}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={geometry:this.geometry};for(let t in this)"_geometry"===t||"_vectorTileFeature"===t||(e[t]=this[t]);return e}};l(qy,"GeoJSONFeature");var Ry=qy,jy=class{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new J(8192,16,0),this.grid3D=new J(8192,16,0),this.featureIndexArray=new El,this.promoteId=t}insert(e,t,r,i,n,a){let s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,i,n);let o=a?this.grid3D:this.grid;for(let e=0;e<t.length;e++){let r=t[e],i=[1/0,1/0,-1/0,-1/0];for(let e=0;e<r.length;e++){let t=r[e];i[0]=Math.min(i[0],t.x),i[1]=Math.min(i[1],t.y),i[2]=Math.max(i[2],t.x),i[3]=Math.max(i[3],t.y)}i[0]<8192&&i[1]<8192&&i[2]>=0&&i[3]>=0&&o.insert(s,i[0],i[1],i[2],i[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Dy.default.VectorTile(new Oy.default(this.rawTileData)).layers,this.sourceLayerCoder=new Fy(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,t,r,i){this.loadVTLayers();let n=e.params||{},a=8192/e.tileSize/e.scale,s=Wi(n.filter),o=e.queryGeometry,l=e.queryPadding*a,u=Zy(o),c=this.grid.query(u.minX-l,u.minY-l,u.maxX+l,u.maxY+l),h=Zy(e.cameraQueryGeometry),p=this.grid3D.query(h.minX-l,h.minY-l,h.maxX+l,h.maxY+l,((t,r,i,n)=>dc(e.cameraQueryGeometry,t-l,r-l,i+l,n+l)));for(let e of p)c.push(e);c.sort(Gy);let f,d={};for(let l=0;l<c.length;l++){let u=c[l];if(u===f)continue;f=u;let h=this.featureIndexArray.get(u),p=null;this.loadMatchingFeature(d,h.bucketIndex,h.sourceLayerIndex,h.featureIndex,s,n.layers,n.availableImages,t,r,i,((t,r,i)=>(p||(p=Ku(t)),r.queryIntersectsFeature(o,t,i,p,this.z,e.transform,a,e.pixelPosMatrix))))}return d}loadMatchingFeature(e,t,r,i,n,a,s,o,l,u,c){let h=this.bucketLayerIDs[t];if(a&&!O(a,h))return;let p=this.sourceLayerCoder.decode(r),f=this.vtLayers[p].feature(i);if(n.needGeometry){let e=$u(f,!0);if(!n.filter(new Ds(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!n.filter(new Ds(this.tileID.overscaledZ),f))return;let d=this.getId(f,p);for(let t=0;t<h.length;t++){let r=h[t];if(a&&a.indexOf(r)<0)continue;let n=o[r];if(!n)continue;let p={};d&&u&&(p=u.getState(n.sourceLayer||"_geojsonTileLayer",d));let y=T({},l[r]);y.paint=Uy(y.paint,n.paint,f,p,s),y.layout=Uy(y.layout,n.layout,f,p,s);let m=!c||c(f,n,p);if(!m)continue;let g=new Ry(f,this.z,this.x,this.y,d);g.layer=y;let x=e[r];void 0===x&&(x=e[r]=[]),x.push({featureIndex:i,feature:g,intersectionZ:m})}}lookupSymbolFeatures(e,t,r,i,n,a,s,o){let l={};this.loadVTLayers();let u=Wi(n);for(let n of e)this.loadMatchingFeature(l,r,i,n,u,a,s,o,t);return l}hasLayer(e){for(let t of this.bucketLayerIDs)for(let r of t)if(e===r)return!0;return!1}getId(e,t){let r=e.id;if(this.promoteId){let i="string"==typeof this.promoteId?this.promoteId:this.promoteId[t];r=e.properties[i],"boolean"==typeof r&&(r=Number(r))}return r}};l(jy,"FeatureIndex");var Ny=jy;function Uy(e,t,r,i,n){return L(e,((e,a)=>{let s=t instanceof Qs?t.get(a):null;return s&&s.evaluate?s.evaluate(r,i,n):s}))}function Zy(e){let t=1/0,r=1/0,i=-1/0,n=-1/0;for(let a of e)t=Math.min(t,a.x),r=Math.min(r,a.y),i=Math.max(i,a.x),n=Math.max(n,a.y);return{minX:t,minY:r,maxX:i,maxY:n}}function Gy(e,t){return t-e}ra("FeatureIndex",Ny,{omit:["rawTileData","sourceLayerCoder"]}),l(Uy,"evaluateProperties"),l(Zy,"getBounds"),l(Gy,"topDownFeatureComparator"),p(),p();var Xy=h(f(),1),Yy=class e extends Xy.default{constructor(e,t,r,i){super(e,t),this.angle=r,void 0!==i&&(this.segment=i)}clone(){return new e(this.x,this.y,this.angle,this.segment)}};l(Yy,"Anchor");var Jy=Yy;function Hy(e,t,r,i,n){if(void 0===t.segment||0===r)return!0;let a=t,s=t.segment+1,o=0;for(;o>-r/2;){if(s--,s<0)return!1;o-=e[s].dist(a),a=e[s]}o+=e[s].dist(e[s+1]),s++;let l=[],u=0;for(;o<r/2;){let t=e[s-1],r=e[s],a=e[s+1];if(!a)return!1;let c=t.angleTo(r)-r.angleTo(a);for(c=Math.abs((c+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:o,angleDelta:c}),u+=c;o-l[0].distance>i;)u-=l.shift().angleDelta;if(u>n)return!1;s++,o+=r.dist(a)}return!0}function Wy(e){let t=0;for(let r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Ky(e,t,r){return e?.6*t*r:0}function $y(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Qy(e,t,r,i,n,a){let s=Ky(r,n,a),o=$y(r,i)*a,l=0,u=Wy(e)/2;for(let r=0;r<e.length-1;r++){let i=e[r],n=e[r+1],a=i.dist(n);if(l+a>u){let c=(u-l)/a,h=vr.number(i.x,n.x,c),p=vr.number(i.y,n.y,c),f=new Jy(h,p,n.angleTo(i),r);return f._round(),!s||Hy(e,f,o,s,t)?f:void 0}l+=a}}function em(e,t,r,i,n,a,s,o,l){let u=Ky(i,a,s),c=$y(i,n),h=c*s,p=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-h<t/4&&(t=h+t/4),tm(e,p?t/2*o%t:(c/2+2*a)*s*o%t,t,u,r,h,p,!1,l)}function tm(e,t,r,i,n,a,s,o,l){let u=a/2,c=Wy(e),h=0,p=t-r,f=[];for(let t=0;t<e.length-1;t++){let s=e[t],o=e[t+1],d=s.dist(o),y=o.angleTo(s);for(;p+r<h+d;){p+=r;let m=(p-h)/d,g=vr.number(s.x,o.x,m),x=vr.number(s.y,o.y,m);if(g>=0&&g<l&&x>=0&&x<l&&p-u>=0&&p+u<=c){let r=new Jy(g,x,y,t);r._round(),(!i||Hy(e,r,a,i,n))&&f.push(r)}}h+=d}return!o&&!f.length&&!s&&(f=tm(e,h/2,r,i,n,a,s,!0,l)),f}ra("Anchor",Jy),p(),p(),l(Hy,"checkMaxAngle"),l(Wy,"getLineLength"),l(Ky,"getAngleWindowSize"),l($y,"getShapedLabelLength"),l(Qy,"getCenterAnchor"),l(em,"getAnchors"),l(tm,"resample"),p();var rm=h(f(),1);function im(e,t,r,i,n){let a=[];for(let s=0;s<e.length;s++){let o,l=e[s];for(let e=0;e<l.length-1;e++){let s=l[e],u=l[e+1];s.x<t&&u.x<t||(s.x<t?s=new rm.default(t,s.y+(u.y-s.y)*((t-s.x)/(u.x-s.x)))._round():u.x<t&&(u=new rm.default(t,s.y+(u.y-s.y)*((t-s.x)/(u.x-s.x)))._round()),!(s.y<r&&u.y<r)&&(s.y<r?s=new rm.default(s.x+(u.x-s.x)*((r-s.y)/(u.y-s.y)),r)._round():u.y<r&&(u=new rm.default(s.x+(u.x-s.x)*((r-s.y)/(u.y-s.y)),r)._round()),!(s.x>=i&&u.x>=i)&&(s.x>=i?s=new rm.default(i,s.y+(u.y-s.y)*((i-s.x)/(u.x-s.x)))._round():u.x>=i&&(u=new rm.default(i,s.y+(u.y-s.y)*((i-s.x)/(u.x-s.x)))._round()),!(s.y>=n&&u.y>=n)&&(s.y>=n?s=new rm.default(s.x+(u.x-s.x)*((n-s.y)/(u.y-s.y)),n)._round():u.y>=n&&(u=new rm.default(s.x+(u.x-s.x)*((n-s.y)/(u.y-s.y)),n)._round()),(!o||!s.equals(o[o.length-1]))&&(o=[s],a.push(o)),o.push(u)))))}}return a}l(im,"clipLine"),p();var nm=h(f(),1);function am(e,t,r,i){let n=[],a=e.image,s=a.pixelRatio,o=a.paddedRect.w-2,u=a.paddedRect.h-2,c=e.right-e.left,h=e.bottom-e.top,p=a.stretchX||[[0,o]],f=a.stretchY||[[0,u]],d=l(((e,t)=>e+t[1]-t[0]),"reduceRanges"),y=p.reduce(d,0),m=f.reduce(d,0),g=o-y,x=u-m,v=0,b=y,w=0,_=m,S=0,k=g,A=0,I=x;if(a.content&&i){let e=a.content;v=sm(p,0,e[0]),w=sm(f,0,e[1]),b=sm(p,e[0],e[2]),_=sm(f,e[1],e[3]),S=e[0]-v,A=e[1]-w,k=e[2]-e[0]-b,I=e[3]-e[1]-_}let M=l(((i,n,o,l)=>{let u=lm(i.stretch-v,b,c,e.left),p=um(i.fixed-S,k,i.stretch,y),f=lm(n.stretch-w,_,h,e.top),d=um(n.fixed-A,I,n.stretch,m),g=lm(o.stretch-v,b,c,e.left),x=um(o.fixed-S,k,o.stretch,y),M=lm(l.stretch-w,_,h,e.top),z=um(l.fixed-A,I,l.stretch,m),P=new nm.default(u,f),C=new nm.default(g,f),B=new nm.default(g,M),V=new nm.default(u,M),T=new nm.default(p/s,d/s),E=new nm.default(x/s,z/s),L=t*Math.PI/180;if(L){let e=Math.sin(L),t=Math.cos(L),r=[t,-e,e,t];P._matMult(r),C._matMult(r),V._matMult(r),B._matMult(r)}let F=i.stretch+i.fixed,D=o.stretch+o.fixed,O=n.stretch+n.fixed,q=l.stretch+l.fixed;return{tl:P,tr:C,bl:V,br:B,tex:{x:a.paddedRect.x+1+F,y:a.paddedRect.y+1+O,w:D-F,h:q-O},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:T,pixelOffsetBR:E,minFontScaleX:k/s/c,minFontScaleY:I/s/h,isSDF:r}}),"makeBox");if(i&&(a.stretchX||a.stretchY)){let e=om(p,g,y),t=om(f,x,m);for(let r=0;r<e.length-1;r++){let i=e[r],a=e[r+1];for(let e=0;e<t.length-1;e++){let r=t[e],s=t[e+1];n.push(M(i,r,a,s))}}}else n.push(M({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:o+1},{fixed:0,stretch:u+1}));return n}function sm(e,t,r){let i=0;for(let n of e)i+=Math.max(t,Math.min(r,n[1]))-Math.max(t,Math.min(r,n[0]));return i}function om(e,t,r){let i=[{fixed:-1,stretch:0}];for(let[t,r]of e){let e=i[i.length-1];i.push({fixed:t-e.stretch,stretch:e.stretch}),i.push({fixed:t-e.stretch,stretch:e.stretch+(r-t)})}return i.push({fixed:t+1,stretch:r}),i}function lm(e,t,r,i){return e/t*r+i}function um(e,t,r,i){return e-t*r/i}function cm(e,t,r,i,n,a,s,o){let l=i.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,u=[];for(let e of t.positionedLines)for(let i of e.positionedGlyphs){if(!i.rect)continue;let a=i.rect||{},c=4,h=!0,p=1,f=0,d=(n||o)&&i.vertical,y=i.metrics.advance*i.scale/2;if(o&&t.verticalizable){let t=(i.scale-1)*fd,r=(fd-i.metrics.width*i.scale)/2;f=e.lineOffset/2-(i.imageName?-r:t)}if(i.imageName){let e=s[i.imageName];h=e.sdf,p=e.pixelRatio,c=1/p}let m=n?[i.x+y,i.y]:[0,0],g=n?[0,0]:[i.x+y+r[0],i.y+r[1]-f],x=[0,0];d&&(x=g,g=[0,0]);let v=(i.metrics.left-c)*i.scale-y+g[0],b=(-i.metrics.top-c)*i.scale+g[1],w=v+a.w*i.scale/p,_=b+a.h*i.scale/p,S=new nm.default(v,b),k=new nm.default(w,b),A=new nm.default(v,_),I=new nm.default(w,_);if(d){let e=new nm.default(-y,y-wd),t=-Math.PI/2,r=12-y,n=i.imageName?r:0,a=new nm.default(22-r,-n),s=new nm.default(...x);S._rotateAround(t,e)._add(a)._add(s),k._rotateAround(t,e)._add(a)._add(s),A._rotateAround(t,e)._add(a)._add(s),I._rotateAround(t,e)._add(a)._add(s)}if(l){let e=Math.sin(l),t=Math.cos(l),r=[t,-e,e,t];S._matMult(r),k._matMult(r),A._matMult(r),I._matMult(r)}let M=new nm.default(0,0),z=new nm.default(0,0),P=0,C=0;u.push({tl:S,tr:k,bl:A,br:I,tex:a,writingMode:t.writingMode,glyphOffset:m,sectionIndex:i.sectionIndex,isSDF:h,pixelOffsetTL:M,pixelOffsetBR:z,minFontScaleX:P,minFontScaleY:C})}return u}l(am,"getIconQuads"),l(sm,"sumWithinRange"),l(om,"stretchZonesToCuts"),l(lm,"getEmOffset"),l(um,"getPxOffset"),l(cm,"getGlyphQuads"),p();var hm=h(f(),1),pm=class{constructor(e,t,r,i,n,a,s,o,l,u){if(this.boxStartIndex=e.length,l){let e=a.top,t=a.bottom,r=a.collisionPadding;r&&(e-=r[1],t+=r[3]);let i=t-e;i>0&&(i=Math.max(10,i),this.circleDiameter=i)}else{let l=a.top*s-o[0],c=a.bottom*s+o[2],h=a.left*s-o[3],p=a.right*s+o[1],f=a.collisionPadding;if(f&&(h-=f[0]*s,l-=f[1]*s,p+=f[2]*s,c+=f[3]*s),u){let e=new hm.default(h,l),t=new hm.default(p,l),r=new hm.default(h,c),i=new hm.default(p,c),n=u*Math.PI/180;e._rotate(n),t._rotate(n),r._rotate(n),i._rotate(n),h=Math.min(e.x,t.x,r.x,i.x),p=Math.max(e.x,t.x,r.x,i.x),l=Math.min(e.y,t.y,r.y,i.y),c=Math.max(e.y,t.y,r.y,i.y)}e.emplaceBack(t.x,t.y,h,l,p,c,r,i,n)}this.boxEndIndex=e.length}};l(pm,"CollisionFeature");var fm=pm;p(),p();var dm=class{constructor(e=[],t=mm){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;let e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:t,compare:r}=this,i=t[e];for(;e>0;){let n=e-1>>1,a=t[n];if(r(i,a)>=0)break;t[e]=a,e=n}t[e]=i}_down(e){let{data:t,compare:r}=this,i=this.length>>1,n=t[e];for(;e<i;){let i=1+(e<<1),a=t[i],s=i+1;if(s<this.length&&r(t[s],a)<0&&(i=s,a=t[s]),r(a,n)>=0)break;t[e]=a,e=i}t[e]=n}};l(dm,"TinyQueue");var ym=dm;function mm(e,t){return e<t?-1:e>t?1:0}l(mm,"defaultCompare");var gm=h(f(),1);function xm(e,t=1,r=!1){let i=1/0,n=1/0,a=-1/0,s=-1/0,o=e[0];for(let e=0;e<o.length;e++){let t=o[e];(!e||t.x<i)&&(i=t.x),(!e||t.y<n)&&(n=t.y),(!e||t.x>a)&&(a=t.x),(!e||t.y>s)&&(s=t.y)}let l=a-i,u=s-n,c=Math.min(l,u),h=c/2,p=new ym([],vm);if(0===c)return new gm.default(i,n);for(let t=i;t<a;t+=c)for(let r=n;r<s;r+=c)p.push(new bm(t+h,r+h,h,e));let f=_m(e),d=p.length;for(;p.length;){let i=p.pop();(i.d>f.d||!f.d)&&(f=i,r&&console.log("found best %d after %d probes",Math.round(1e4*i.d)/1e4,d)),!(i.max-f.d<=t)&&(h=i.h/2,p.push(new bm(i.p.x-h,i.p.y-h,h,e)),p.push(new bm(i.p.x+h,i.p.y-h,h,e)),p.push(new bm(i.p.x-h,i.p.y+h,h,e)),p.push(new bm(i.p.x+h,i.p.y+h,h,e)),d+=4)}return r&&(console.log("num probes: ".concat(d)),console.log("best distance: ".concat(f.d))),f.p}function vm(e,t){return t.max-e.max}function bm(e,t,r,i){this.p=new gm.default(e,t),this.h=r,this.d=wm(this.p,i),this.max=this.d+this.h*Math.SQRT2}function wm(e,t){let r=!1,i=1/0;for(let n=0;n<t.length;n++){let a=t[n];for(let t=0,n=a.length,s=n-1;t<n;s=t++){let n=a[t],o=a[s];n.y>e.y!=o.y>e.y&&e.x<(o.x-n.x)*(e.y-n.y)/(o.y-n.y)+n.x&&(r=!r),i=Math.min(i,hc(e,n,o))}}return(r?1:-1)*Math.sqrt(i)}function _m(e){let t=0,r=0,i=0,n=e[0];for(let e=0,a=n.length,s=a-1;e<a;s=e++){let a=n[e],o=n[s],l=a.x*o.y-o.x*a.y;r+=(a.x+o.x)*l,i+=(a.y+o.y)*l,t+=3*l}return new bm(r/t,i/t,0,e)}l(xm,"findPoleOfInaccessibility"),l(vm,"compareMax"),l(bm,"Cell"),l(wm,"pointToPolygonDist"),l(_m,"getCentroidCell");var Sm=h(g(),1),km=Number.POSITIVE_INFINITY;function Am(e,t){function r(e,t){let r=0,i=0;t<0&&(t=0);let n=t/Math.sqrt(2);switch(e){case"top-right":case"top-left":i=n-7;break;case"bottom-right":case"bottom-left":i=7-n;break;case"bottom":i=7-t;break;case"top":i=t-7}switch(e){case"top-right":case"bottom-right":r=-n;break;case"top-left":case"bottom-left":r=n;break;case"left":r=t;break;case"right":r=-t}return[r,i]}function i(e,t,r){let i=0,n=0;switch(t=Math.abs(t),r=Math.abs(r),e){case"top-right":case"top-left":case"top":n=r-7;break;case"bottom-right":case"bottom-left":case"bottom":n=7-r}switch(e){case"top-right":case"bottom-right":case"right":i=-t;break;case"top-left":case"bottom-left":case"left":i=t}return[i,n]}return l(r,"fromRadialOffset"),l(i,"fromTextOffset"),t[1]!==km?i(e,t[0],t[1]):r(e,t[0])}function Im(e){e.bucket.createArrays();let t=512*e.bucket.overscaling;e.bucket.tilePixelRatio=8192/t,e.bucket.compareText={},e.bucket.iconsNeedLinear=!1;let r=e.bucket.layers[0].layout,i=e.bucket.layers[0]._unevaluatedLayout._values,n={layoutIconSize:i["icon-size"].possiblyEvaluate(new Ds(e.bucket.zoom+1),e.canonical),layoutTextSize:i["text-size"].possiblyEvaluate(new Ds(e.bucket.zoom+1),e.canonical),textMaxSize:i["text-size"].possiblyEvaluate(new Ds(18))};if("composite"===e.bucket.textSizeData.kind){let{minZoom:t,maxZoom:r}=e.bucket.textSizeData;n.compositeTextSizes=[i["text-size"].possiblyEvaluate(new Ds(t),e.canonical),i["text-size"].possiblyEvaluate(new Ds(r),e.canonical)]}if("composite"===e.bucket.iconSizeData.kind){let{minZoom:t,maxZoom:r}=e.bucket.iconSizeData;n.compositeIconSizes=[i["icon-size"].possiblyEvaluate(new Ds(t),e.canonical),i["icon-size"].possiblyEvaluate(new Ds(r),e.canonical)]}let a=r.get("text-line-height")*fd,s="viewport"!==r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement"),o=r.get("text-keep-upright"),u=r.get("text-size");for(let t of e.bucket.features){let i=r.get("text-font").evaluate(t,{},e.canonical).join(","),c=u.evaluate(t,{},e.canonical),h=n.layoutTextSize.evaluate(t,{},e.canonical),p=n.layoutIconSize.evaluate(t,{},e.canonical),f={horizontal:{},vertical:void 0},d=t.text,y=[0,0];if(d){let n=d.toString(),u=r.get("text-letter-spacing").evaluate(t,{},e.canonical)*fd,p=vs(n)?u:0,m=r.get("text-anchor").evaluate(t,{},e.canonical),g=r.get("text-variable-anchor");if(!g){let i=r.get("text-radial-offset").evaluate(t,{},e.canonical);y=i?Am(m,[i*fd,km]):r.get("text-offset").evaluate(t,{},e.canonical).map((e=>e*fd))}let x=s?"center":r.get("text-justify").evaluate(t,{},e.canonical),v=r.get("symbol-placement"),b="point"===v?r.get("text-max-width").evaluate(t,{},e.canonical)*fd:0,w=l((()=>{e.bucket.allowVerticalPlacement&&xs(n)&&(f.vertical=zd(d,e.glyphMap,e.glyphPositions,e.imagePositions,i,b,a,m,"left",p,y,2,!0,v,h,c))}),"addVerticalShapingForPointLabelIfNeeded");if(!s&&g){let t="auto"===x?g.map((e=>Mm(e))):[x],r=!1;for(let n=0;n<t.length;n++){let s=t[n];if(!f.horizontal[s])if(r)f.horizontal[s]=f.horizontal[0];else{let t=zd(d,e.glyphMap,e.glyphPositions,e.imagePositions,i,b,a,"center",s,p,y,1,!1,v,h,c);t&&(f.horizontal[s]=t,r=1===t.positionedLines.length)}}w()}else{"auto"===x&&(x=Mm(m));let t=zd(d,e.glyphMap,e.glyphPositions,e.imagePositions,i,b,a,m,x,p,y,1,!1,v,h,c);t&&(f.horizontal[x]=t),w(),xs(n)&&s&&o&&(f.vertical=zd(d,e.glyphMap,e.glyphPositions,e.imagePositions,i,b,a,m,x,p,y,2,!1,v,h,c))}}let m,g=!1;if(t.icon&&t.icon.name){let i=e.imageMap[t.icon.name];i&&(m=Nd(e.imagePositions[t.icon.name],r.get("icon-offset").evaluate(t,{},e.canonical),r.get("icon-anchor").evaluate(t,{},e.canonical)),g=!!i.sdf,void 0===e.bucket.sdfIcons?e.bucket.sdfIcons=g:e.bucket.sdfIcons!==g&&R("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(i.pixelRatio!==e.bucket.pixelRatio||0!==r.get("icon-rotate").constantOr(1))&&(e.bucket.iconsNeedLinear=!0))}let x=Cm(f.horizontal)||f.vertical;e.bucket.iconsInText=!!x&&x.iconsInText,(x||m)&&zm(e.bucket,t,f,m,e.imageMap,n,h,p,y,g,e.canonical)}e.showCollisionBoxes&&e.bucket.generateCollisionDebugBuffers()}function Mm(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function zm(e,t,r,i,n,a,s,o,u,c,h){let p=a.textMaxSize.evaluate(t,{});void 0===p&&(p=s);let f,d=e.layers[0].layout,y=d.get("icon-offset").evaluate(t,{},h),m=Cm(r.horizontal),g=s/24,x=e.tilePixelRatio*g,v=e.tilePixelRatio*p/24,b=e.tilePixelRatio*o,w=e.tilePixelRatio*d.get("symbol-spacing"),_=d.get("text-padding")*e.tilePixelRatio,S=gy(d,t,h,e.tilePixelRatio),k=d.get("text-max-angle")/180*Math.PI,A="viewport"!==d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement"),I="map"===d.get("icon-rotation-alignment")&&"point"!==d.get("symbol-placement"),M=d.get("symbol-placement"),z=w/2,P=d.get("icon-text-fit");i&&"none"!==P&&(e.allowVerticalPlacement&&r.vertical&&(f=Ud(i,r.vertical,P,d.get("icon-text-fit-padding"),y,g)),m&&(i=Ud(i,m,P,d.get("icon-text-fit-padding"),y,g)));let C=l(((o,l)=>{l.x<0||l.x>=8192||l.y<0||l.y>=8192||Bm(e,l,o,r,i,n,f,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,x,[_,_,_,_],A,u,b,S,I,y,t,a,c,h,s)}),"addSymbolAtAnchor");if("line"===M)for(let n of im(t.geometry,0,0,8192,8192)){let t=em(n,w,k,r.vertical||m,i,24,v,e.overscaling,8192);for(let r of t){let t=m;(!t||!Vm(e,t.text,z,r))&&C(n,r)}}else if("line-center"===M){for(let e of t.geometry)if(e.length>1){let t=Qy(e,k,r.vertical||m,i,24,v);t&&C(e,t)}}else if("Polygon"===t.type)for(let e of Hp(t.geometry,0)){let t=xm(e,16);C(e[0],new Jy(t.x,t.y,0))}else if("LineString"===t.type)for(let e of t.geometry)C(e,new Jy(e[0].x,e[0].y,0));else if("Point"===t.type)for(let e of t.geometry)for(let t of e)C([t],new Jy(t.x,t.y,0))}function Pm(e,t,r,i,n,a,s,o,l,u,c,h,p,f,d){let y=cm(0,r,o,n,a,s,i,e.allowVerticalPlacement),m=e.textSizeData,g=null;"source"===m.kind?(g=[Xd*n.layout.get("text-size").evaluate(s,{})],g[0]>Yd&&R("".concat(e.layerIds[0],': Value for "text-size" is >= ').concat(Gd,'. Reduce your "text-size".'))):"composite"===m.kind&&(g=[Xd*f.compositeTextSizes[0].evaluate(s,{},d),Xd*f.compositeTextSizes[1].evaluate(s,{},d)],(g[0]>Yd||g[1]>Yd)&&R("".concat(e.layerIds[0],': Value for "text-size" is >= ').concat(Gd,'. Reduce your "text-size".'))),e.addSymbols(e.text,y,g,o,a,s,u,t,l.lineStartIndex,l.lineLength,p,d);for(let t of c)h[t]=e.text.placedSymbolArray.length-1;return 4*y.length}function Cm(e){for(let t in e)return e[t];return null}function Bm(e,t,r,i,n,a,s,o,u,c,h,p,f,d,y,m,g,x,v,b,w,_,S,k,A){let I,M,z,P,C=e.addToLineVertexArray(t,r),B=0,V=0,T=0,E=0,L=-1,F=-1,D={},O=(0,Sm.default)(""),q=0,j=0;if(void 0===o._unevaluatedLayout.getValue("text-radial-offset")?[q,j]=o.layout.get("text-offset").evaluate(w,{},k).map((e=>e*fd)):(q=o.layout.get("text-radial-offset").evaluate(w,{},k)*fd,j=km),e.allowVerticalPlacement&&i.vertical){let e=o.layout.get("text-rotate").evaluate(w,{},k)+90,r=i.vertical;z=new fm(u,t,c,h,p,r,f,d,y,e),s&&(P=new fm(u,t,c,h,p,s,g,x,y,e))}if(n){let r=o.layout.get("icon-rotate").evaluate(w,{}),i="none"!==o.layout.get("icon-text-fit"),a=am(n,r,S,i),l=s?am(s,r,S,i):void 0;M=new fm(u,t,c,h,p,n,g,x,!1,r),B=4*a.length;let f=e.iconSizeData,d=null;"source"===f.kind?(d=[Xd*o.layout.get("icon-size").evaluate(w,{})],d[0]>Yd&&R("".concat(e.layerIds[0],': Value for "icon-size" is >= ').concat(Gd,'. Reduce your "icon-size".'))):"composite"===f.kind&&(d=[Xd*_.compositeIconSizes[0].evaluate(w,{},k),Xd*_.compositeIconSizes[1].evaluate(w,{},k)],(d[0]>Yd||d[1]>Yd)&&R("".concat(e.layerIds[0],': Value for "icon-size" is >= ').concat(Gd,'. Reduce your "icon-size".'))),e.addSymbols(e.icon,a,d,b,v,w,0,t,C.lineStartIndex,C.lineLength,-1,k),L=e.icon.placedSymbolArray.length-1,l&&(V=4*l.length,e.addSymbols(e.icon,l,d,b,v,w,2,t,C.lineStartIndex,C.lineLength,-1,k),F=e.icon.placedSymbolArray.length-1)}let N=Object.keys(i.horizontal);for(let r of N){let n=i.horizontal[r];if(!I){O=(0,Sm.default)(n.text);let e=o.layout.get("text-rotate").evaluate(w,{},k);I=new fm(u,t,c,h,p,n,f,d,y,e)}let s=1===n.positionedLines.length;if(T+=Pm(e,t,n,a,o,y,w,m,C,i.vertical?1:3,s?N:[r],D,L,_,k),s)break}i.vertical&&(E+=Pm(e,t,i.vertical,a,o,y,w,m,C,2,["vertical"],D,F,_,k));let U=I?I.boxStartIndex:e.collisionBoxArray.length,Z=I?I.boxEndIndex:e.collisionBoxArray.length,G=z?z.boxStartIndex:e.collisionBoxArray.length,X=z?z.boxEndIndex:e.collisionBoxArray.length,Y=M?M.boxStartIndex:e.collisionBoxArray.length,J=M?M.boxEndIndex:e.collisionBoxArray.length,H=P?P.boxStartIndex:e.collisionBoxArray.length,W=P?P.boxEndIndex:e.collisionBoxArray.length,K=-1,$=l(((e,t)=>e&&e.circleDiameter?Math.max(e.circleDiameter,t):t),"getCollisionCircleHeight");K=$(I,K),K=$(z,K),K=$(M,K),K=$(P,K);let Q=K>-1?1:0;Q&&(K*=A/fd),e.glyphOffsetArray.length>=sy.MAX_GLYPHS&&R("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==w.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,w.sortKey),e.symbolInstances.emplaceBack(t.x,t.y,D.right>=0?D.right:-1,D.center>=0?D.center:-1,D.left>=0?D.left:-1,D.vertical||-1,L,F,O,U,Z,G,X,Y,J,H,W,c,T,E,B,V,Q,0,f,q,j,K)}function Vm(e,t,r,i){let n=e.compareText;if(t in n){let e=n[t];for(let t=e.length-1;t>=0;t--)if(i.dist(e[t])<r)return!0}else n[t]=[];return n[t].push(i),!1}l(Am,"evaluateVariableOffset"),l(Im,"performSymbolLayout"),l(Mm,"getAnchorJustification"),l(zm,"addFeature"),l(Pm,"addTextVertices"),l(Cm,"getDefaultHorizontalShaping"),l(Bm,"addSymbol"),l(Vm,"anchorIsTooClose"),p();var Tm=class{constructor(e){let t={},r=[];for(let i in e){let n=e[i],a=t[i]={};for(let e in n){let t=n[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;let i={x:0,y:0,w:t.bitmap.width+2,h:t.bitmap.height+2};r.push(i),a[e]={rect:i,metrics:t.metrics}}}let{w:i,h:n}=dd(r),a=new Pp({width:i||1,height:n||1});for(let r in e){let i=e[r];for(let e in i){let n=i[+e];if(!n||0===n.bitmap.width||0===n.bitmap.height)continue;let s=t[r][e].rect;Pp.copy(n.bitmap,a,{x:0,y:0},{x:s.x+1,y:s.y+1},n.bitmap)}}this.image=a,this.positions=t}};l(Tm,"GlyphAtlas");var Em=Tm;function Lm(e,t,r){var i=Fm(256*e,256*(t=Math.pow(2,r)-t-1),r),n=Fm(256*(e+1),256*(t+1),r);return i[0]+","+i[1]+","+n[0]+","+n[1]}function Fm(e,t,r){var i=2*Math.PI*6378137/256/Math.pow(2,r);return[e*i-2*Math.PI*6378137/2,t*i-2*Math.PI*6378137/2]}ra("GlyphAtlas",Em),p(),p(),l(Lm,"getTileBBox"),l(Fm,"getMercCoords");var Dm=h(f(),1);p(),p();var Om=6371008.8,qm=class e{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: (".concat(e,", ").concat(t,")"));if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new e(V(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(e){let t=Math.PI/180,r=this.lat*t,i=e.lat*t,n=Math.sin(r)*Math.sin(i)+Math.cos(r)*Math.cos(i)*Math.cos((e.lng-this.lng)*t);return Om*Math.acos(Math.min(n,1))}static convert(t){if(t instanceof e)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new e(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new e(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}};l(qm,"LngLat");var Rm=qm,jm=2*Math.PI*Om;function Nm(e){return jm*Math.cos(e*Math.PI/180)}function Um(e){return(180+e)/360}function Zm(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Gm(e,t){return e/Nm(t)}function Xm(e){return 360*e-180}function Ym(e){let t=180-360*e;return 360/Math.PI*Math.atan(Math.exp(t*Math.PI/180))-90}function Jm(e,t){return e*Nm(Ym(t))}function Hm(e){return 1/Math.cos(e*Math.PI/180)}l(Nm,"circumferenceAtLatitude"),l(Um,"mercatorXfromLng"),l(Zm,"mercatorYfromLat"),l(Gm,"mercatorZfromAltitude"),l(Xm,"lngFromMercatorX"),l(Ym,"latFromMercatorY"),l(Jm,"altitudeFromMercatorZ"),l(Hm,"mercatorScale");var Wm=class e{constructor(e,t,r=0){this.x=+e,this.y=+t,this.z=+r}static fromLngLat(t,r=0){let i=Rm.convert(t);return new e(Um(i.lng),Zm(i.lat),Gm(r,i.lat))}toLngLat(){return new Rm(Xm(this.x),Ym(this.y))}toAltitude(){return Jm(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/jm*Hm(Ym(this.y))}};l(Wm,"MercatorCoordinate");var Km=Wm,$m=class{constructor(e,t,r){if(e<0||e>25||r<0||r>=Math.pow(2,e)||t<0||t>=Math.pow(2,e))throw new Error("x=".concat(t,", y=").concat(r,", z=").concat(e," outside of bounds. 0<=x<").concat(Math.pow(2,e),", 0<=y<").concat(Math.pow(2,e)," 0<=z<=25 "));this.z=e,this.x=t,this.y=r,this.key=ng(0,e,e,t,r)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t,r){let i=Lm(this.x,this.y,this.z),n=ag(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===r?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,t>1?"@2x":"").replace(/{quadkey}/g,n).replace(/{bbox-epsg-3857}/g,i)}isChildOf(e){let t=this.z-e.z;return t>0&&e.x===this.x>>t&&e.y===this.y>>t}getTilePoint(e){let t=Math.pow(2,this.z);return new Dm.default(8192*(e.x*t-this.x),8192*(e.y*t-this.y))}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}};l($m,"CanonicalTileID");var Qm=$m,eg=class{constructor(e,t){this.wrap=e,this.canonical=t,this.key=ng(e,t.z,t.z,t.x,t.y)}};l(eg,"UnwrappedTileID");var tg=eg,rg=class e{constructor(e,t,r,i,n){if(e<r)throw new Error("overscaledZ should be >= z; overscaledZ = ".concat(e,"; z = ").concat(r));this.overscaledZ=e,this.wrap=t,this.canonical=new Qm(r,+i,+n),this.key=ng(t,e,r,i,n)}clone(){return new e(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(t,"; overscaledZ = ").concat(this.overscaledZ));let r=this.canonical.z-t;return t>this.canonical.z?new e(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new e(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,t){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));let r=this.canonical.z-e;return e>this.canonical.z?ng(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):ng(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)}isChildOf(e){if(e.wrap!==this.wrap)return!1;let t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(t){if(this.overscaledZ>=t)return[new e(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let r=this.canonical.z+1,i=2*this.canonical.x,n=2*this.canonical.y;return[new e(r,this.wrap,r,i,n),new e(r,this.wrap,r,i+1,n),new e(r,this.wrap,r,i,n+1),new e(r,this.wrap,r,i+1,n+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new e(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new e(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new tg(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}getTilePoint(e){return this.canonical.getTilePoint(new Km(e.x-this.wrap,e.y))}};l(rg,"OverscaledTileID");var ig=rg;function ng(e,t,r,i,n){(e*=2)<0&&(e=-1*e-1);let a=1<<r;return(a*a*e+a*n+i).toString(36)+r.toString(36)+t.toString(36)}function ag(e,t,r){let i,n="";for(let a=e;a>0;a--)i=1<<a-1,n+=(t&i?1:0)+(r&i?2:0);return n}l(ng,"calculateKey"),l(ag,"getQuadkey"),ra("CanonicalTileID",Qm),ra("OverscaledTileID",ig,{omit:["posMatrix"]});var sg=class{constructor(e){this.tileID=new ig(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(e,t,r,i,n){this.status="parsing",this.data=e,this.collisionBoxArray=new xl;let a=new Fy(Object.keys(e.layers).sort()),s=new Ny(this.tileID,this.promoteId);s.bucketLayerIDs=[];let o={},u={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:r},c=t.familiesBySource[this.source];for(let t in c){let i=e.layers[t];if(!i)continue;1===i.version&&R('Vector tile source "'.concat(this.source,'" layer "').concat(t,'" ')+"does not use vector tile spec v2 and therefore may have some rendering errors.");let n=a.encode(t),l=[];for(let e=0;e<i.length;e++){let r=i.feature(e),a=s.getId(r,t);l.push({feature:r,id:a,index:e,sourceLayerIndex:n})}for(let e of c[t]){let t=e[0];(t.source!==this.source&&R("layer.source = ".concat(t.source," does not equal this.source = ").concat(this.source)),t.minzoom&&this.zoom<Math.floor(t.minzoom)||t.maxzoom&&this.zoom>=t.maxzoom||"none"===t.visibility)||(lg(e,this.zoom,r),(o[t.id]=t.createBucket({index:s.bucketLayerIDs.length,layers:e,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:n,sourceID:this.source})).populate(l,u,this.tileID.canonical),s.bucketLayerIDs.push(e.map((e=>e.id))))}}let h,p,f,d,y=L(u.glyphDependencies,(e=>Object.keys(e).map(Number)));this.inFlightDependencies.forEach((e=>null==e?void 0:e.cancel())),this.inFlightDependencies=[];let m=++this.dependencySentinel;Object.keys(y).length?this.inFlightDependencies.push(i.send("getGlyphs",{uid:this.uid,stacks:y,source:this.source,tileID:this.tileID,type:"glyphs"},((e,t)=>{m===this.dependencySentinel&&(h||(h=e,p=t,v.call(this)))}))):p={};let g=Object.keys(u.iconDependencies);g.length?this.inFlightDependencies.push(i.send("getImages",{icons:g,source:this.source,tileID:this.tileID,type:"icons"},((e,t)=>{m===this.dependencySentinel&&(h||(h=e,f=t,v.call(this)))}))):f={};let x=Object.keys(u.patternDependencies);function v(){if(h)return n(h);if(p&&f&&d){let e=new Em(p),t=new xd(f,d);for(let i in o){let n=o[i];n instanceof sy?(lg(n.layers,this.zoom,r),Im({bucket:n,glyphMap:p,glyphPositions:e.positions,imageMap:f,imagePositions:t.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):n.hasPattern&&(n instanceof Gf||n instanceof ef||n instanceof vf)&&(lg(n.layers,this.zoom,r),n.addFeatures(u,this.tileID.canonical,t.patternPositions))}this.status="done",n(null,{buckets:Object.values(o).filter((e=>!e.isEmpty())),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,imageAtlas:t,glyphMap:this.returnDependencies?p:null,iconMap:this.returnDependencies?f:null,glyphPositions:this.returnDependencies?e.positions:null})}}x.length?this.inFlightDependencies.push(i.send("getImages",{icons:x,source:this.source,tileID:this.tileID,type:"patterns"},((e,t)=>{m===this.dependencySentinel&&(h||(h=e,d=t,v.call(this)))}))):d={},v.call(this),l(v,"maybePrepare")}};l(sg,"WorkerTile");var og=sg;function lg(e,t,r){let i=new Ds(t);for(let t of e)t.recalculate(i,r)}l(lg,"recalculateLayers"),p();var ug=class{constructor(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let e=performance.getEntriesByName(this._marks.measure);return 0===e.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),e=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),e}};l(ug,"RequestPerformance");var cg=ug;function hg(e,t){let r=ea(e.request,((e,r,i,n)=>{e?t(e):r&&t(null,{vectorTile:new Ty.default.VectorTile(new Ey.default(r)),rawData:r,cacheControl:i,expires:n})}));return()=>{r.cancel(),t()}}l(hg,"loadVectorTile");var pg=class{constructor(e,t,r,i){this.actor=e,this.layerIndex=t,this.availableImages=r,this.loadVectorData=i||hg,this.loading={},this.loaded={}}loadTile(e,t){let r=e.uid;this.loading||(this.loading={});let i=!!(e&&e.request&&e.request.collectResourceTiming)&&new cg(e.request),n=this.loading[r]=new og(e);n.abort=this.loadVectorData(e,((e,a)=>{if(delete this.loading[r],e||!a)return n.status="done",this.loaded[r]=n,t(e);let s=a.rawData,o={};a.expires&&(o.expires=a.expires),a.cacheControl&&(o.cacheControl=a.cacheControl);let l={};if(i){let e=i.finish();e&&(l.resourceTiming=JSON.parse(JSON.stringify(e)))}n.vectorTile=a.vectorTile,n.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,((e,r)=>{if(e||!r)return t(e);t(null,T({rawTileData:s.slice(0)},r,o,l))})),this.loaded=this.loaded||{},this.loaded[r]=n}))}reloadTile(e,t){let r=this.loaded,i=e.uid;if(r&&r[i]){let n=r[i];n.showCollisionBoxes=e.showCollisionBoxes,"parsing"===n.status?n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,t):"done"===n.status&&(n.vectorTile?n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,t):t())}}abortTile(e,t){let r=this.loading,i=e.uid;r&&r[i]&&r[i].abort&&(r[i].abort(),delete r[i]),t()}removeTile(e,t){let r=this.loaded,i=e.uid;r&&r[i]&&delete r[i],t()}};l(pg,"VectorTileWorkerSource");var fg=pg;p(),p();var dg=class{constructor(e,t,r){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return void R('"'.concat(r,'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".'));this.stride=t.height;let i=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=r||"mapbox";for(let e=0;e<i;e++)this.data[this._idx(-1,e)]=this.data[this._idx(0,e)],this.data[this._idx(i,e)]=this.data[this._idx(i-1,e)],this.data[this._idx(e,-1)]=this.data[this._idx(e,0)],this.data[this._idx(e,i)]=this.data[this._idx(e,i-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(i,-1)]=this.data[this._idx(i-1,0)],this.data[this._idx(-1,i)]=this.data[this._idx(0,i-1)],this.data[this._idx(i,i)]=this.data[this._idx(i-1,i-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let e=0;e<i;e++)for(let t=0;t<i;t++){let r=this.get(e,t);r>this.max&&(this.max=r),r<this.min&&(this.min=r)}}get(e,t){let r=new Uint8Array(this.data.buffer),i=4*this._idx(e,t);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(r[i],r[i+1],r[i+2])}getUnpackVector(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}_unpackMapbox(e,t,r){return(256*e*256+256*t+r)/10-1e4}_unpackTerrarium(e,t,r){return 256*e+t+r/256-32768}getPixels(){return new Bp({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let i=t*this.dim,n=t*this.dim+this.dim,a=r*this.dim,s=r*this.dim+this.dim;switch(t){case-1:i=n-1;break;case 1:n=i+1}switch(r){case-1:a=s-1;break;case 1:s=a+1}let o=-t*this.dim,l=-r*this.dim;for(let t=a;t<s;t++)for(let r=i;r<n;r++)this.data[this._idx(r,t)]=e.data[this._idx(r+o,t+l)]}};l(dg,"DEMData");var yg=dg;ra("DEMData",yg);var mg=class{constructor(){this.loaded={}}loadTile(e,t){let{uid:r,encoding:i,rawImageData:n}=e,a=X(n)?this.getImageData(n):n,s=new yg(r,a,i);this.loaded=this.loaded||{},this.loaded[r]=s,t(null,s)}getImageData(e){(!this.offscreenCanvas||!this.offscreenCanvasContext)&&(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);let t=this.offscreenCanvasContext.getImageData(-1,-1,e.width+2,e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new Bp({width:t.width,height:t.height},t.data)}removeTile(e){let t=this.loaded,r=e.uid;t&&t[r]&&delete t[r]}};l(mg,"RasterDEMTileWorkerSource");var gg=mg;p();var xg=h(A(),1);p();var vg=h(f(),1),bg=h(_(),1).default.VectorTileFeature.prototype.toGeoJSON,wg=class{constructor(e){this._feature=e,this.extent=8192,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(1===this._feature.type){let e=[];for(let t of this._feature.geometry)e.push([new vg.default(t[0],t[1])]);return e}{let e=[];for(let t of this._feature.geometry){let r=[];for(let e of t)r.push(new vg.default(e[0],e[1]));e.push(r)}return e}}toGeoJSON(e,t,r){return bg.call(this,e,t,r)}};l(wg,"FeatureWrapper");var _g=wg,Sg=class{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=8192,this.length=e.length,this._features=e}feature(e){return new _g(this._features[e])}};l(Sg,"GeoJSONWrapper");var kg=Sg,Ag=h(M(),1);p(),p();var Ig=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Mg=class e{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[r,i]=new Uint8Array(t,0,2);if(219!==r)throw new Error("Data does not appear to be in a KDBush format.");let n=i>>4;if(1!==n)throw new Error("Got v".concat(n," data when expected v").concat(1,"."));let a=Ig[15&i];if(!a)throw new Error("Unrecognized array type.");let[s]=new Uint16Array(t,2,1),[o]=new Uint32Array(t,4,1);return new e(o,s,a,t)}constructor(e,t=64,r=Float64Array,i){if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let n=Ig.indexOf(this.ArrayType),a=2*e*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,o=(8-s%8)%8;if(n<0)throw new Error("Unexpected typed array class: ".concat(r,"."));i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+s+o,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+a+s+o),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+s+o,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+n]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){let r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=t,r}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return Pg(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,r,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:n,coords:a,nodeSize:s}=this,o=[0,n.length-1,0],l=[];for(;o.length;){let u=o.pop()||0,c=o.pop()||0,h=o.pop()||0;if(c-h<=s){for(let s=h;s<=c;s++){let o=a[2*s],u=a[2*s+1];o>=e&&o<=r&&u>=t&&u<=i&&l.push(n[s])}continue}let p=h+c>>1,f=a[2*p],d=a[2*p+1];f>=e&&f<=r&&d>=t&&d<=i&&l.push(n[p]),(0===u?e<=f:t<=d)&&(o.push(h),o.push(p-1),o.push(1-u)),(0===u?r>=f:i>=d)&&(o.push(p+1),o.push(c),o.push(1-u))}return l}within(e,t,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:i,coords:n,nodeSize:a}=this,s=[0,i.length-1,0],o=[],l=r*r;for(;s.length;){let u=s.pop()||0,c=s.pop()||0,h=s.pop()||0;if(c-h<=a){for(let r=h;r<=c;r++)Tg(n[2*r],n[2*r+1],e,t)<=l&&o.push(i[r]);continue}let p=h+c>>1,f=n[2*p],d=n[2*p+1];Tg(f,d,e,t)<=l&&o.push(i[p]),(0===u?e-r<=f:t-r<=d)&&(s.push(h),s.push(p-1),s.push(1-u)),(0===u?e+r>=f:t+r>=d)&&(s.push(p+1),s.push(c),s.push(1-u))}return o}};l(Mg,"KDBush");var zg=Mg;function Pg(e,t,r,i,n,a){if(n-i<=r)return;let s=i+n>>1;Cg(e,t,s,i,n,a),Pg(e,t,r,i,s-1,1-a),Pg(e,t,r,s+1,n,1-a)}function Cg(e,t,r,i,n,a){for(;n>i;){if(n-i>600){let s=n-i+1,o=r-i+1,l=Math.log(s),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(s-u)/s)*(o-s/2<0?-1:1);Cg(e,t,r,Math.max(i,Math.floor(r-o*u/s+c)),Math.min(n,Math.floor(r+(s-o)*u/s+c)),a)}let s=t[2*r+a],o=i,l=n;for(Bg(e,t,i,r),t[2*n+a]>s&&Bg(e,t,i,n);o<l;){for(Bg(e,t,o,l),o++,l--;t[2*o+a]<s;)o++;for(;t[2*l+a]>s;)l--}t[2*i+a]===s?Bg(e,t,i,l):(l++,Bg(e,t,l,n)),l<=r&&(i=l+1),r<=l&&(n=l-1)}}function Bg(e,t,r,i){Vg(e,r,i),Vg(t,2*r,2*i),Vg(t,2*r+1,2*i+1)}function Vg(e,t,r){let i=e[t];e[t]=e[r],e[r]=i}function Tg(e,t,r,i){let n=e-r,a=t-i;return n*n+a*a}l(Pg,"sort"),l(Cg,"select"),l(Bg,"swapItem"),l(Vg,"swap"),l(Tg,"sqDist");var Eg={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},Lg=Math.fround||(e=>t=>(e[0]=+t,e[0]))(new Float32Array(1)),Fg=class{constructor(e){this.options=Object.assign(Object.create(Eg),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){let{log:t,minZoom:r,maxZoom:i}=this.options;t&&console.time("total time");let n="prepare ".concat(e.length," points");t&&console.time(n),this.points=e;let a=[];for(let t=0;t<e.length;t++){let r=e[t];if(!r.geometry)continue;let[i,n]=r.geometry.coordinates,s=Lg(Rg(i)),o=Lg(jg(n));a.push(s,o,1/0,t,-1,1),this.options.reduce&&a.push(0)}let s=this.trees[i+1]=this._createTree(a);t&&console.timeEnd(n);for(let e=i;e>=r;e--){let r=+Date.now();s=this.trees[e]=this._createTree(this._cluster(s,e)),t&&console.log("z%d: %d clusters in %dms",e,s.numItems,+Date.now()-r)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let r=((e[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,e[1])),n=180===e[2]?180:((e[2]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,n=180;else if(r>n){let e=this.getClusters([r,i,180,a],t),s=this.getClusters([-180,i,n,a],t);return e.concat(s)}let s=this.trees[this._limitZoom(t)],o=s.range(Rg(r),jg(a),Rg(n),jg(i)),l=s.data,u=[];for(let e of o){let t=this.stride*e;u.push(l[t+5]>1?Og(l,t,this.clusterProps):this.points[l[t+3]])}return u}getChildren(e){let t=this._getOriginId(e),r=this._getOriginZoom(e),i="No cluster with the specified id.",n=this.trees[r];if(!n)throw new Error(i);let a=n.data;if(t*this.stride>=a.length)throw new Error(i);let s=this.options.radius/(this.options.extent*Math.pow(2,r-1)),o=a[t*this.stride],l=a[t*this.stride+1],u=n.within(o,l,s),c=[];for(let t of u){let r=t*this.stride;a[r+4]===e&&c.push(a[r+5]>1?Og(a,r,this.clusterProps):this.points[a[r+3]])}if(0===c.length)throw new Error(i);return c}getLeaves(e,t,r){t=t||10,r=r||0;let i=[];return this._appendLeaves(i,e,t,r,0),i}getTile(e,t,r){let i=this.trees[this._limitZoom(e)],n=Math.pow(2,e),{extent:a,radius:s}=this.options,o=s/a,l=(r-o)/n,u=(r+1+o)/n,c={features:[]};return this._addTileFeatures(i.range((t-o)/n,l,(t+1+o)/n,u),i.data,t,r,n,c),0===t&&this._addTileFeatures(i.range(1-o/n,l,1,u),i.data,n,r,n,c),t===n-1&&this._addTileFeatures(i.range(0,l,o/n,u),i.data,-1,r,n,c),c.features.length?c:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){let r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t}_appendLeaves(e,t,r,i,n){let a=this.getChildren(t);for(let t of a){let a=t.properties;if(a&&a.cluster?n+a.point_count<=i?n+=a.point_count:n=this._appendLeaves(e,a.cluster_id,r,i,n):n<i?n++:e.push(t),e.length===r)break}return n}_createTree(e){let t=new zg(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let r=0;r<e.length;r+=this.stride)t.add(e[r],e[r+1]);return t.finish(),t.data=e,t}_addTileFeatures(e,t,r,i,n,a){for(let s of e){let e,o,l,u=s*this.stride,c=t[u+5]>1;if(c)e=qg(t,u,this.clusterProps),o=t[u],l=t[u+1];else{let r=this.points[t[u+3]];e=r.properties;let[i,n]=r.geometry.coordinates;o=Rg(i),l=jg(n)}let h,p={type:1,geometry:[[Math.round(this.options.extent*(o*n-r)),Math.round(this.options.extent*(l*n-i))]],tags:e};h=c||this.options.generateId?t[u+3]:this.points[t[u+3]].id,void 0!==h&&(p.id=h),a.features.push(p)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){let{radius:r,extent:i,reduce:n,minPoints:a}=this.options,s=r/(i*Math.pow(2,t)),o=e.data,l=[],u=this.stride;for(let r=0;r<o.length;r+=u){if(o[r+2]<=t)continue;o[r+2]=t;let i=o[r],c=o[r+1],h=e.within(o[r],o[r+1],s),p=o[r+5],f=p;for(let e of h){let r=e*u;o[r+2]>t&&(f+=o[r+5])}if(f>p&&f>=a){let e,a=i*p,s=c*p,d=-1,y=((r/u|0)<<5)+(t+1)+this.points.length;for(let i of h){let l=i*u;if(o[l+2]<=t)continue;o[l+2]=t;let c=o[l+5];a+=o[l]*c,s+=o[l+1]*c,o[l+4]=y,n&&(e||(e=this._map(o,r,!0),d=this.clusterProps.length,this.clusterProps.push(e)),n(e,this._map(o,l)))}o[r+4]=y,l.push(a/f,s/f,1/0,y,-1,f),n&&l.push(d)}else{for(let e=0;e<u;e++)l.push(o[r+e]);if(f>1)for(let e of h){let r=e*u;if(!(o[r+2]<=t)){o[r+2]=t;for(let e=0;e<u;e++)l.push(o[r+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,r){if(e[t+5]>1){let i=this.clusterProps[e[t+6]];return r?Object.assign({},i):i}let i=this.points[e[t+3]].properties,n=this.options.map(i);return r&&n===i?Object.assign({},n):n}};l(Fg,"Supercluster");var Dg=Fg;function Og(e,t,r){return{type:"Feature",id:e[t+3],properties:qg(e,t,r),geometry:{type:"Point",coordinates:[Ng(e[t]),Ug(e[t+1])]}}}function qg(e,t,r){let i=e[t+5],n=i>=1e4?"".concat(Math.round(i/1e3),"k"):i>=1e3?"".concat(Math.round(i/100)/10,"k"):i,a=e[t+6],s=-1===a?{}:Object.assign({},r[a]);return Object.assign(s,{cluster:!0,cluster_id:e[t+3],point_count:i,point_count_abbreviated:n})}function Rg(e){return e/360+.5}function jg(e){let t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function Ng(e){return 360*(e-.5)}function Ug(e){let t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function Zg(e,t,r,i){for(var n,a=i,s=r-t>>1,o=r-t,l=e[t],u=e[t+1],c=e[r],h=e[r+1],p=t+3;p<r;p+=3){var f=Gg(e[p],e[p+1],l,u,c,h);if(f>a)n=p,a=f;else if(f===a){var d=Math.abs(p-s);d<o&&(n=p,o=d)}}a>i&&(n-t>3&&Zg(e,t,n,i),e[n+2]=a,r-n>3&&Zg(e,n,r,i))}function Gg(e,t,r,i,n,a){var s=n-r,o=a-i;if(0!==s||0!==o){var l=((e-r)*s+(t-i)*o)/(s*s+o*o);l>1?(r=n,i=a):l>0&&(r+=s*l,i+=o*l)}return(s=e-r)*s+(o=t-i)*o}function Xg(e,t,r,i){var n={id:typeof e>"u"?null:e,type:t,geometry:r,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return Yg(n),n}function Yg(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)Jg(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var i=0;i<t.length;i++)Jg(e,t[i]);else if("MultiPolygon"===r)for(i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++)Jg(e,t[i][n])}function Jg(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function Hg(e,t){var r=[];if("FeatureCollection"===e.type)for(var i=0;i<e.features.length;i++)Wg(r,e.features[i],t,i);else"Feature"===e.type?Wg(r,e,t):Wg(r,{geometry:e},t);return r}function Wg(e,t,r,i){if(t.geometry){var n=t.geometry.coordinates,a=t.geometry.type,s=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),o=[],l=t.id;if(r.promoteId?l=t.properties[r.promoteId]:r.generateId&&(l=i||0),"Point"===a)Kg(n,o);else if("MultiPoint"===a)for(var u=0;u<n.length;u++)Kg(n[u],o);else if("LineString"===a)$g(n,o,s,!1);else if("MultiLineString"===a){if(r.lineMetrics){for(u=0;u<n.length;u++)o=[],$g(n[u],o,s,!1),e.push(Xg(l,"LineString",o,t.properties));return}Qg(n,o,s,!1)}else if("Polygon"===a)Qg(n,o,s,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(u=0;u<t.geometry.geometries.length;u++)Wg(e,{id:l,geometry:t.geometry.geometries[u],properties:t.properties},r,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<n.length;u++){var c=[];Qg(n[u],c,s,!0),o.push(c)}}e.push(Xg(l,a,o,t.properties))}}function Kg(e,t){t.push(ex(e[0])),t.push(tx(e[1])),t.push(0)}function $g(e,t,r,i){for(var n,a,s=0,o=0;o<e.length;o++){var l=ex(e[o][0]),u=tx(e[o][1]);t.push(l),t.push(u),t.push(0),o>0&&(s+=i?(n*u-l*a)/2:Math.sqrt(Math.pow(l-n,2)+Math.pow(u-a,2))),n=l,a=u}var c=t.length-3;t[2]=1,Zg(t,0,c,r),t[c+2]=1,t.size=Math.abs(s),t.start=0,t.end=t.size}function Qg(e,t,r,i){for(var n=0;n<e.length;n++){var a=[];$g(e[n],a,r,i),t.push(a)}}function ex(e){return e/360+.5}function tx(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function rx(e,t,r,i,n,a,s,o){if(i/=t,a>=(r/=t)&&s<i)return e;if(s<r||a>=i)return null;for(var l=[],u=0;u<e.length;u++){var c=e[u],h=c.geometry,p=c.type,f=0===n?c.minX:c.minY,d=0===n?c.maxX:c.maxY;if(f>=r&&d<i)l.push(c);else if(!(d<r||f>=i)){var y=[];if("Point"===p||"MultiPoint"===p)ix(h,y,r,i,n);else if("LineString"===p)nx(h,y,r,i,n,!1,o.lineMetrics);else if("MultiLineString"===p)sx(h,y,r,i,n,!1);else if("Polygon"===p)sx(h,y,r,i,n,!0);else if("MultiPolygon"===p)for(var m=0;m<h.length;m++){var g=[];sx(h[m],g,r,i,n,!0),g.length&&y.push(g)}if(y.length){if(o.lineMetrics&&"LineString"===p){for(m=0;m<y.length;m++)l.push(Xg(c.id,p,y[m],c.tags));continue}("LineString"===p||"MultiLineString"===p)&&(1===y.length?(p="LineString",y=y[0]):p="MultiLineString"),("Point"===p||"MultiPoint"===p)&&(p=3===y.length?"Point":"MultiPoint"),l.push(Xg(c.id,p,y,c.tags))}}}return l.length?l:null}function ix(e,t,r,i,n){for(var a=0;a<e.length;a+=3){var s=e[a+n];s>=r&&s<=i&&(t.push(e[a]),t.push(e[a+1]),t.push(e[a+2]))}}function nx(e,t,r,i,n,a,s){for(var o,l,u=ax(e),c=0===n?lx:ux,h=e.start,p=0;p<e.length-3;p+=3){var f=e[p],d=e[p+1],y=e[p+2],m=e[p+3],g=e[p+4],x=0===n?f:d,v=0===n?m:g,b=!1;s&&(o=Math.sqrt(Math.pow(f-m,2)+Math.pow(d-g,2))),x<r?v>r&&(l=c(u,f,d,m,g,r),s&&(u.start=h+o*l)):x>i?v<i&&(l=c(u,f,d,m,g,i),s&&(u.start=h+o*l)):ox(u,f,d,y),v<r&&x>=r&&(l=c(u,f,d,m,g,r),b=!0),v>i&&x<=i&&(l=c(u,f,d,m,g,i),b=!0),!a&&b&&(s&&(u.end=h+o*l),t.push(u),u=ax(e)),s&&(h+=o)}var w=e.length-3;f=e[w],d=e[w+1],y=e[w+2],(x=0===n?f:d)>=r&&x<=i&&ox(u,f,d,y),w=u.length-3,a&&w>=3&&(u[w]!==u[0]||u[w+1]!==u[1])&&ox(u,u[0],u[1],u[2]),u.length&&t.push(u)}function ax(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function sx(e,t,r,i,n,a){for(var s=0;s<e.length;s++)nx(e[s],t,r,i,n,a,!1)}function ox(e,t,r,i){e.push(t),e.push(r),e.push(i)}function lx(e,t,r,i,n,a){var s=(a-t)/(i-t);return e.push(a),e.push(r+(n-r)*s),e.push(1),s}function ux(e,t,r,i,n,a){var s=(a-r)/(n-r);return e.push(t+(i-t)*s),e.push(a),e.push(1),s}function cx(e,t){var r=t.buffer/t.extent,i=e,n=rx(e,1,-1-r,r,0,-1,2,t),a=rx(e,1,1-r,2+r,0,-1,2,t);return(n||a)&&(i=rx(e,1,-r,1+r,0,-1,2,t)||[],n&&(i=hx(n,1).concat(i)),a&&(i=i.concat(hx(a,-1)))),i}function hx(e,t){for(var r=[],i=0;i<e.length;i++){var n,a=e[i],s=a.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)n=px(a.geometry,t);else if("MultiLineString"===s||"Polygon"===s){n=[];for(var o=0;o<a.geometry.length;o++)n.push(px(a.geometry[o],t))}else if("MultiPolygon"===s)for(n=[],o=0;o<a.geometry.length;o++){for(var l=[],u=0;u<a.geometry[o].length;u++)l.push(px(a.geometry[o][u],t));n.push(l)}r.push(Xg(a.id,s,n,a.tags))}return r}function px(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var i=0;i<e.length;i+=3)r.push(e[i]+t,e[i+1],e[i+2]);return r}function fx(e,t){if(e.transformed)return e;var r,i,n,a=1<<e.z,s=e.x,o=e.y;for(r=0;r<e.features.length;r++){var l=e.features[r],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(i=0;i<u.length;i+=2)l.geometry.push(dx(u[i],u[i+1],t,a,s,o));else for(i=0;i<u.length;i++){var h=[];for(n=0;n<u[i].length;n+=2)h.push(dx(u[i][n],u[i][n+1],t,a,s,o));l.geometry.push(h)}}return e.transformed=!0,e}function dx(e,t,r,i,n,a){return[Math.round(r*(e*i-n)),Math.round(r*(t*i-a))]}function yx(e,t,r,i,n){for(var a=t===n.maxZoom?0:n.tolerance/((1<<t)*n.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:i,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},o=0;o<e.length;o++){s.numFeatures++,mx(s,e[o],a,n);var l=e[o].minX,u=e[o].minY,c=e[o].maxX,h=e[o].maxY;l<s.minX&&(s.minX=l),u<s.minY&&(s.minY=u),c>s.maxX&&(s.maxX=c),h>s.maxY&&(s.maxY=h)}return s}function mx(e,t,r,i){var n=t.geometry,a=t.type,s=[];if("Point"===a||"MultiPoint"===a)for(var o=0;o<n.length;o+=3)s.push(n[o]),s.push(n[o+1]),e.numPoints++,e.numSimplified++;else if("LineString"===a)gx(s,n,e,r,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(o=0;o<n.length;o++)gx(s,n[o],e,r,"Polygon"===a,0===o);else if("MultiPolygon"===a)for(var l=0;l<n.length;l++){var u=n[l];for(o=0;o<u.length;o++)gx(s,u[o],e,r,!0,0===o)}if(s.length){var c=t.tags||null;if("LineString"===a&&i.lineMetrics){for(var h in c={},t.tags)c[h]=t.tags[h];c.mapbox_clip_start=n.start/n.size,c.mapbox_clip_end=n.end/n.size}var p={geometry:s,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:c};null!==t.id&&(p.id=t.id),e.features.push(p)}}function gx(e,t,r,i,n,a){var s=i*i;if(i>0&&t.size<(n?s:i))r.numPoints+=t.length/3;else{for(var o=[],l=0;l<t.length;l+=3)(0===i||t[l+2]>s)&&(r.numSimplified++,o.push(t[l]),o.push(t[l+1])),r.numPoints++;n&&xx(o,a),e.push(o)}}function xx(e,t){for(var r=0,i=0,n=e.length,a=n-2;i<n;a=i,i+=2)r+=(e[i]-e[a])*(e[i+1]+e[a+1]);if(r>0===t)for(i=0,n=e.length;i<n/2;i+=2){var s=e[i],o=e[i+1];e[i]=e[n-2-i],e[i+1]=e[n-1-i],e[n-2-i]=s,e[n-1-i]=o}}function vx(e,t){return new bx(e,t)}function bx(e,t){var r=(t=this.options=_x(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=Hg(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=cx(i,t)).length&&this.splitTile(i,0,0,0),r&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function wx(e,t,r){return 32*((1<<e)*r+t)+e}function _x(e,t){for(var r in t)e[r]=t[r];return e}function Sx(e,t){return t?e.properties[t]:e.id}function kx(e,t){if(null==e)return!0;if("Feature"===e.type)return null!=Sx(e,t);if("FeatureCollection"===e.type){let r=new Set;for(let i of e.features){let e=Sx(i,t);if(null==e||r.has(e))return!1;r.add(e)}return!0}return!1}function Ax(e,t){let r=new Map;if(null!=e)if("Feature"===e.type)r.set(Sx(e,t),e);else for(let i of e.features)r.set(Sx(i,t),i);return r}function Ix(e,t,r){var i,n,a,s;if(t.removeAll&&e.clear(),t.remove)for(let r of t.remove)e.delete(r);if(t.add)for(let i of t.add){let t=Sx(i,r);null!=t&&e.set(t,i)}if(t.update)for(let r of t.update){let t=e.get(r.id);if(null==t)continue;let o=r.newGeometry||r.removeAllProperties,l=!r.removeAllProperties&&((null==(i=r.removeProperties)?void 0:i.length)>0||(null==(n=r.addOrUpdateProperties)?void 0:n.length)>0);if((o||l)&&(t={...t},e.set(r.id,t),l&&(t.properties={...t.properties})),r.newGeometry&&(t.geometry=r.newGeometry),r.removeAllProperties)t.properties={};else if((null==(a=r.removeProperties)?void 0:a.length)>0)for(let e of r.removeProperties)Object.prototype.hasOwnProperty.call(t.properties,e)&&delete t.properties[e];if((null==(s=r.addOrUpdateProperties)?void 0:s.length)>0)for(let{key:e,value:i}of r.addOrUpdateProperties)t.properties[e]=i}}function Mx(e,t){let r=e.tileID.canonical;if(!this._geoJSONIndex)return t(null,null);let i=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!i)return t(null,null);let n=new kg(i.features),a=(0,Ag.default)(n);(0!==a.byteOffset||a.byteLength!==a.buffer.byteLength)&&(a=new Uint8Array(a)),t(null,{vectorTile:n,rawData:a.buffer})}l(Og,"getClusterJSON"),l(qg,"getClusterProperties"),l(Rg,"lngX"),l(jg,"latY"),l(Ng,"xLng"),l(Ug,"yLat"),p(),p(),p(),l(Zg,"simplify"),l(Gg,"getSqSegDist"),p(),l(Xg,"createFeature"),l(Yg,"calcBBox"),l(Jg,"calcLineBBox"),l(Hg,"convert"),l(Wg,"convertFeature"),l(Kg,"convertPoint"),l($g,"convertLine"),l(Qg,"convertLines"),l(ex,"projectX"),l(tx,"projectY"),p(),l(rx,"clip"),l(ix,"clipPoints"),l(nx,"clipLine"),l(ax,"newSlice"),l(sx,"clipLines"),l(ox,"addPoint"),l(lx,"intersectX"),l(ux,"intersectY"),p(),l(cx,"wrap"),l(hx,"shiftFeatureCoords"),l(px,"shiftCoords"),p(),l(fx,"transformTile"),l(dx,"transformPoint"),p(),l(yx,"createTile"),l(mx,"addFeature"),l(gx,"addLine"),l(xx,"rewind"),l(vx,"geojsonvt"),l(bx,"GeoJSONVT"),bx.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},bx.prototype.splitTile=function(e,t,r,i,n,a,s){for(var o=[e,t,r,i],l=this.options,u=l.debug;o.length;){i=o.pop(),r=o.pop(),t=o.pop(),e=o.pop();var c=1<<t,h=wx(t,r,i),p=this.tiles[h];if(!p&&(u>1&&console.time("creation"),p=this.tiles[h]=yx(e,t,r,i,l),this.tileCoords.push({z:t,x:r,y:i}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,i,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var f="z"+t;this.stats[f]=(this.stats[f]||0)+1,this.total++}if(p.source=e,n){if(t===l.maxZoom||t===n)continue;var d=1<<n-t;if(r!==Math.floor(a/d)||i!==Math.floor(s/d))continue}else if(t===l.indexMaxZoom||p.numPoints<=l.indexMaxPoints)continue;if(p.source=null,0!==e.length){u>1&&console.time("clipping");var y,m,g,x,v,b,w=.5*l.buffer/l.extent,_=.5-w,S=.5+w,k=1+w;y=m=g=x=null,v=rx(e,c,r-w,r+S,0,p.minX,p.maxX,l),b=rx(e,c,r+_,r+k,0,p.minX,p.maxX,l),e=null,v&&(y=rx(v,c,i-w,i+S,1,p.minY,p.maxY,l),m=rx(v,c,i+_,i+k,1,p.minY,p.maxY,l),v=null),b&&(g=rx(b,c,i-w,i+S,1,p.minY,p.maxY,l),x=rx(b,c,i+_,i+k,1,p.minY,p.maxY,l),b=null),u>1&&console.timeEnd("clipping"),o.push(y||[],t+1,2*r,2*i),o.push(m||[],t+1,2*r,2*i+1),o.push(g||[],t+1,2*r+1,2*i),o.push(x||[],t+1,2*r+1,2*i+1)}}},bx.prototype.getTile=function(e,t,r){var i=this.options,n=i.extent,a=i.debug;if(e<0||e>24)return null;var s=1<<e,o=wx(e,t=(t%s+s)%s,r);if(this.tiles[o])return fx(this.tiles[o],n);a>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var l,u=e,c=t,h=r;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[wx(u,c,h)];return l&&l.source?(a>1&&console.log("found parent tile z%d-%d-%d",u,c,h),a>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,e,t,r),a>1&&console.timeEnd("drilling down"),this.tiles[o]?fx(this.tiles[o],n):null):null},l(wx,"toID"),l(_x,"extend"),p(),l(Sx,"getFeatureId"),l(kx,"isUpdateableGeoJSON"),l(Ax,"toUpdateable"),l(Ix,"applySourceDiff"),l(Mx,"loadGeoJSONTile");var zx=class extends fg{constructor(e,t,r,i){super(e,t,r,Mx),this._dataUpdateable=new Map,this.loadGeoJSON=l(((e,t)=>{let{promoteId:r}=e;if(e.request)return Qn(e.request,((e,i,n,a)=>{this._dataUpdateable=kx(i,r)?Ax(i,r):void 0,t(e,i,n,a)}));if("string"==typeof e.data)try{let i=JSON.parse(e.data);this._dataUpdateable=kx(i,r)?Ax(i,r):void 0,t(null,i)}catch{t(new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object.")))}else e.dataDiff?this._dataUpdateable?(Ix(this._dataUpdateable,e.dataDiff,r),t(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):t(new Error("Cannot update existing geojson data in ".concat(e.source))):t(new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object.")));return{cancel:()=>{}}}),"loadGeoJSON"),i&&(this.loadGeoJSON=i)}loadData(e,t){var r;null==(r=this._pendingRequest)||r.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});let i=!!(e&&e.request&&e.request.collectResourceTiming)&&new cg(e.request);this._pendingCallback=t,this._pendingRequest=this.loadGeoJSON(e,((r,n)=>{if(delete this._pendingCallback,delete this._pendingRequest,r||!n)return t(r);if("object"!=typeof n)return t(new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object.")));{(0,xg.default)(n,!0);try{if(e.filter){let t=Fi(e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===t.result)throw new Error(t.value.map((e=>"".concat(e.key,": ").concat(e.message))).join(", "));n={type:"FeatureCollection",features:n.features.filter((e=>t.value.evaluate({zoom:0},e)))}}this._geoJSONIndex=e.cluster?new Dg(Cx(e)).load(n.features):vx(n,e.geojsonVtOptions)}catch(e){return t(e)}this.loaded={};let r={};if(i){let t=i.finish();t&&(r.resourceTiming={},r.resourceTiming[e.source]=JSON.parse(JSON.stringify(t)))}t(null,r)}}))}reloadTile(e,t){let r=this.loaded,i=e.uid;return r&&r[i]?super.reloadTile(e,t):this.loadTile(e,t)}removeSource(e,t){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),t()}getClusterExpansionZoom(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}}getClusterChildren(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}}getClusterLeaves(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}}};l(zx,"GeoJSONWorkerSource");var Px=zx;function Cx({superclusterOptions:e,clusterProperties:t}){if(!t||!e)return e;let r={},i={},n={accumulated:null,zoom:0},a={properties:null},s=Object.keys(t);for(let e of s){let[n,a]=t[e],s=Fi(a),o=Fi("string"==typeof n?[n,["accumulated"],["get",e]]:n);r[e]=s.value,i[e]=o.value}return e.map=e=>{a.properties=e;let t={};for(let e of s)t[e]=r[e].evaluate(n,a);return t},e.reduce=(e,t)=>{a.properties=t;for(let t of s)n.accumulated=e[t],e[t]=i[t].evaluate(n,a)},e}l(Cx,"getSuperclusterOptions");var Bx=class{constructor(e){this.self=e,this.actor=new ua(e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:fg,geojson:Px},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(e,t)=>{if(this.workerSourceTypes[e])throw new Error('Worker source with name "'.concat(e,'" already registered.'));this.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=e=>{if(Ls.isParsed())throw new Error("RTL text plugin already registered.");Ls.applyArabicShaping=e.applyArabicShaping,Ls.processBidirectionalText=e.processBidirectionalText,Ls.processStyledBidirectionalText=e.processStyledBidirectionalText}}setReferrer(e,t){this.referrer=t}setImages(e,t,r){this.availableImages[e]=t;for(let r in this.workerSources[e]){let i=this.workerSources[e][r];for(let e in i)i[e].availableImages=t}r()}setLayers(e,t,r){this.getLayerIndex(e).replace(t),r()}updateLayers(e,t,r){this.getLayerIndex(e).update(t.layers,t.removedIds),r()}loadTile(e,t,r){this.getWorkerSource(e,t.type,t.source).loadTile(t,r)}loadDEMTile(e,t,r){this.getDEMWorkerSource(e,t.source).loadTile(t,r)}reloadTile(e,t,r){this.getWorkerSource(e,t.type,t.source).reloadTile(t,r)}abortTile(e,t,r){this.getWorkerSource(e,t.type,t.source).abortTile(t,r)}removeTile(e,t,r){this.getWorkerSource(e,t.type,t.source).removeTile(t,r)}removeDEMTile(e,t){this.getDEMWorkerSource(e,t.source).removeTile(t)}removeSource(e,t,r){if(!this.workerSources[e]||!this.workerSources[e][t.type]||!this.workerSources[e][t.type][t.source])return;let i=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==i.removeSource?i.removeSource(t,r):r()}loadWorkerSource(e,t,r){try{this.self.importScripts(t.url),r()}catch(e){r(e.toString())}}syncRTLPluginState(e,t,r){try{Ls.setState(t);let e=Ls.getPluginURL();if(Ls.isLoaded()&&!Ls.isParsed()&&null!=e){this.self.importScripts(e);let t=Ls.isParsed();r(t?void 0:new Error("RTL Text Plugin failed to import scripts from ".concat(e)),t)}}catch(e){r(e.toString())}}getAvailableImages(e){let t=this.availableImages[e];return t||(t=[]),t}getLayerIndex(e){let t=this.layerIndexes[e];return t||(t=this.layerIndexes[e]=new Vy),t}getWorkerSource(e,t,r){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),!this.workerSources[e][t][r]){let i={send:(t,r,i)=>{this.actor.send(t,r,i,e)}};this.workerSources[e][t][r]=new this.workerSourceTypes[t](i,this.getLayerIndex(e),this.getAvailableImages(e))}return this.workerSources[e][t][r]}getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new gg),this.demWorkerSources[e][t]}};l(Bx,"Worker");var Vx=Bx;U()&&(self.worker=new Vx(self))})();